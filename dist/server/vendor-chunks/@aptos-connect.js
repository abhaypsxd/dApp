"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/@aptos-connect";
exports.ids = ["vendor-chunks/@aptos-connect"];
exports.modules = {

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/native.js":
/*!*****************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/native.js ***!
  \*****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({\n  randomUUID: (crypto__WEBPACK_IMPORTED_MODULE_0___default().randomUUID)\n});//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvbmF0aXZlLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE0QjtBQUM1QixpRUFBZTtBQUNmLGNBQWMsMERBQWlCO0FBQy9CLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtYm9pbGVycGxhdGUtdGVtcGxhdGUvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvbmF0aXZlLmpzPzZjNjgiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuZXhwb3J0IGRlZmF1bHQge1xuICByYW5kb21VVUlEOiBjcnlwdG8ucmFuZG9tVVVJRFxufTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/native.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/regex.js":
/*!****************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/regex.js ***!
  \****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvcmVnZXguanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGlFQUFlLGNBQWMsRUFBRSxVQUFVLEVBQUUsZUFBZSxFQUFFLGdCQUFnQixFQUFFLFVBQVUsR0FBRyx5Q0FBeUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtYm9pbGVycGxhdGUtdGVtcGxhdGUvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvcmVnZXguanM/NGQ2MiJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCAvXig/OlswLTlhLWZdezh9LVswLTlhLWZdezR9LVsxLTVdWzAtOWEtZl17M30tWzg5YWJdWzAtOWEtZl17M30tWzAtOWEtZl17MTJ9fDAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCkkL2k7Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/regex.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/rng.js":
/*!**************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/rng.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ rng)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n\nconst rnds8Pool = new Uint8Array(256); // # of random values to pre-allocate\n\nlet poolPtr = rnds8Pool.length;\nfunction rng() {\n  if (poolPtr > rnds8Pool.length - 16) {\n    crypto__WEBPACK_IMPORTED_MODULE_0___default().randomFillSync(rnds8Pool);\n    poolPtr = 0;\n  }\n\n  return rnds8Pool.slice(poolPtr, poolPtr += 16);\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvcm5nLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE0QjtBQUM1Qix1Q0FBdUM7O0FBRXZDO0FBQ2U7QUFDZjtBQUNBLElBQUksNERBQXFCO0FBQ3pCO0FBQ0E7O0FBRUE7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL25leHRqcy1ib2lsZXJwbGF0ZS10ZW1wbGF0ZS8uL25vZGVfbW9kdWxlcy9AYXB0b3MtY29ubmVjdC93YWxsZXQtYWRhcHRlci1wbHVnaW4vbm9kZV9tb2R1bGVzL3V1aWQvZGlzdC9lc20tbm9kZS9ybmcuanM/MjRjNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY3J5cHRvIGZyb20gJ2NyeXB0byc7XG5jb25zdCBybmRzOFBvb2wgPSBuZXcgVWludDhBcnJheSgyNTYpOyAvLyAjIG9mIHJhbmRvbSB2YWx1ZXMgdG8gcHJlLWFsbG9jYXRlXG5cbmxldCBwb29sUHRyID0gcm5kczhQb29sLmxlbmd0aDtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJuZygpIHtcbiAgaWYgKHBvb2xQdHIgPiBybmRzOFBvb2wubGVuZ3RoIC0gMTYpIHtcbiAgICBjcnlwdG8ucmFuZG9tRmlsbFN5bmMocm5kczhQb29sKTtcbiAgICBwb29sUHRyID0gMDtcbiAgfVxuXG4gIHJldHVybiBybmRzOFBvb2wuc2xpY2UocG9vbFB0ciwgcG9vbFB0ciArPSAxNik7XG59Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/rng.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/stringify.js":
/*!********************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/stringify.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   unsafeStringify: () => (/* binding */ unsafeStringify)\n/* harmony export */ });\n/* harmony import */ var _validate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./validate.js */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/validate.js\");\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\n\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nfunction unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!(0,_validate_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (stringify);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvc3RyaW5naWZ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFxQztBQUNyQztBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQSxnQkFBZ0IsU0FBUztBQUN6QjtBQUNBOztBQUVPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQSw2Q0FBNkM7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsT0FBTyx3REFBUTtBQUNmO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxpRUFBZSxTQUFTIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGpzLWJvaWxlcnBsYXRlLXRlbXBsYXRlLy4vbm9kZV9tb2R1bGVzL0BhcHRvcy1jb25uZWN0L3dhbGxldC1hZGFwdGVyLXBsdWdpbi9ub2RlX21vZHVsZXMvdXVpZC9kaXN0L2VzbS1ub2RlL3N0cmluZ2lmeS5qcz9mNTdiIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB2YWxpZGF0ZSBmcm9tICcuL3ZhbGlkYXRlLmpzJztcbi8qKlxuICogQ29udmVydCBhcnJheSBvZiAxNiBieXRlIHZhbHVlcyB0byBVVUlEIHN0cmluZyBmb3JtYXQgb2YgdGhlIGZvcm06XG4gKiBYWFhYWFhYWC1YWFhYLVhYWFgtWFhYWC1YWFhYWFhYWFhYWFhcbiAqL1xuXG5jb25zdCBieXRlVG9IZXggPSBbXTtcblxuZm9yIChsZXQgaSA9IDA7IGkgPCAyNTY7ICsraSkge1xuICBieXRlVG9IZXgucHVzaCgoaSArIDB4MTAwKS50b1N0cmluZygxNikuc2xpY2UoMSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5zYWZlU3RyaW5naWZ5KGFyciwgb2Zmc2V0ID0gMCkge1xuICAvLyBOb3RlOiBCZSBjYXJlZnVsIGVkaXRpbmcgdGhpcyBjb2RlISAgSXQncyBiZWVuIHR1bmVkIGZvciBwZXJmb3JtYW5jZVxuICAvLyBhbmQgd29ya3MgaW4gd2F5cyB5b3UgbWF5IG5vdCBleHBlY3QuIFNlZSBodHRwczovL2dpdGh1Yi5jb20vdXVpZGpzL3V1aWQvcHVsbC80MzRcbiAgcmV0dXJuIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxXV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDJdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgM11dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA0XV0gKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDVdXSArICctJyArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgNl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyA3XV0gKyAnLScgKyBieXRlVG9IZXhbYXJyW29mZnNldCArIDhdXSArIGJ5dGVUb0hleFthcnJbb2Zmc2V0ICsgOV1dICsgJy0nICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMV1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxMl1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxM11dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNF1dICsgYnl0ZVRvSGV4W2FycltvZmZzZXQgKyAxNV1dO1xufVxuXG5mdW5jdGlvbiBzdHJpbmdpZnkoYXJyLCBvZmZzZXQgPSAwKSB7XG4gIGNvbnN0IHV1aWQgPSB1bnNhZmVTdHJpbmdpZnkoYXJyLCBvZmZzZXQpOyAvLyBDb25zaXN0ZW5jeSBjaGVjayBmb3IgdmFsaWQgVVVJRC4gIElmIHRoaXMgdGhyb3dzLCBpdCdzIGxpa2VseSBkdWUgdG8gb25lXG4gIC8vIG9mIHRoZSBmb2xsb3dpbmc6XG4gIC8vIC0gT25lIG9yIG1vcmUgaW5wdXQgYXJyYXkgdmFsdWVzIGRvbid0IG1hcCB0byBhIGhleCBvY3RldCAobGVhZGluZyB0b1xuICAvLyBcInVuZGVmaW5lZFwiIGluIHRoZSB1dWlkKVxuICAvLyAtIEludmFsaWQgaW5wdXQgdmFsdWVzIGZvciB0aGUgUkZDIGB2ZXJzaW9uYCBvciBgdmFyaWFudGAgZmllbGRzXG5cbiAgaWYgKCF2YWxpZGF0ZSh1dWlkKSkge1xuICAgIHRocm93IFR5cGVFcnJvcignU3RyaW5naWZpZWQgVVVJRCBpcyBpbnZhbGlkJyk7XG4gIH1cblxuICByZXR1cm4gdXVpZDtcbn1cblxuZXhwb3J0IGRlZmF1bHQgc3RyaW5naWZ5OyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/stringify.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/v4.js":
/*!*************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/v4.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _native_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./native.js */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/native.js\");\n/* harmony import */ var _rng_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./rng.js */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/rng.js\");\n/* harmony import */ var _stringify_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./stringify.js */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/stringify.js\");\n\n\n\n\nfunction v4(options, buf, offset) {\n  if (_native_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].randomUUID && !buf && !options) {\n    return _native_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].randomUUID();\n  }\n\n  options = options || {};\n  const rnds = options.random || (options.rng || _rng_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return (0,_stringify_js__WEBPACK_IMPORTED_MODULE_2__.unsafeStringify)(rnds);\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (v4);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvdjQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFpQztBQUNOO0FBQ3NCOztBQUVqRDtBQUNBLE1BQU0sa0RBQU07QUFDWixXQUFXLGtEQUFNO0FBQ2pCOztBQUVBO0FBQ0EsaURBQWlELCtDQUFHLEtBQUs7O0FBRXpEO0FBQ0EsbUNBQW1DOztBQUVuQztBQUNBOztBQUVBLG9CQUFvQixRQUFRO0FBQzVCO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQSxTQUFTLDhEQUFlO0FBQ3hCOztBQUVBLGlFQUFlLEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtYm9pbGVycGxhdGUtdGVtcGxhdGUvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvdjQuanM/NzVlOCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbmF0aXZlIGZyb20gJy4vbmF0aXZlLmpzJztcbmltcG9ydCBybmcgZnJvbSAnLi9ybmcuanMnO1xuaW1wb3J0IHsgdW5zYWZlU3RyaW5naWZ5IH0gZnJvbSAnLi9zdHJpbmdpZnkuanMnO1xuXG5mdW5jdGlvbiB2NChvcHRpb25zLCBidWYsIG9mZnNldCkge1xuICBpZiAobmF0aXZlLnJhbmRvbVVVSUQgJiYgIWJ1ZiAmJiAhb3B0aW9ucykge1xuICAgIHJldHVybiBuYXRpdmUucmFuZG9tVVVJRCgpO1xuICB9XG5cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGNvbnN0IHJuZHMgPSBvcHRpb25zLnJhbmRvbSB8fCAob3B0aW9ucy5ybmcgfHwgcm5nKSgpOyAvLyBQZXIgNC40LCBzZXQgYml0cyBmb3IgdmVyc2lvbiBhbmQgYGNsb2NrX3NlcV9oaV9hbmRfcmVzZXJ2ZWRgXG5cbiAgcm5kc1s2XSA9IHJuZHNbNl0gJiAweDBmIHwgMHg0MDtcbiAgcm5kc1s4XSA9IHJuZHNbOF0gJiAweDNmIHwgMHg4MDsgLy8gQ29weSBieXRlcyB0byBidWZmZXIsIGlmIHByb3ZpZGVkXG5cbiAgaWYgKGJ1Zikge1xuICAgIG9mZnNldCA9IG9mZnNldCB8fCAwO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxNjsgKytpKSB7XG4gICAgICBidWZbb2Zmc2V0ICsgaV0gPSBybmRzW2ldO1xuICAgIH1cblxuICAgIHJldHVybiBidWY7XG4gIH1cblxuICByZXR1cm4gdW5zYWZlU3RyaW5naWZ5KHJuZHMpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2NDsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/v4.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/validate.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/validate.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _regex_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./regex.js */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/regex.js\");\n\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && _regex_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"].test(uuid);\n}\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (validate);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvdmFsaWRhdGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBK0I7O0FBRS9CO0FBQ0EscUNBQXFDLGlEQUFLO0FBQzFDOztBQUVBLGlFQUFlLFFBQVEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtYm9pbGVycGxhdGUtdGVtcGxhdGUvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy91dWlkL2Rpc3QvZXNtLW5vZGUvdmFsaWRhdGUuanM/OTg1NyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUkVHRVggZnJvbSAnLi9yZWdleC5qcyc7XG5cbmZ1bmN0aW9uIHZhbGlkYXRlKHV1aWQpIHtcbiAgcmV0dXJuIHR5cGVvZiB1dWlkID09PSAnc3RyaW5nJyAmJiBSRUdFWC50ZXN0KHV1aWQpO1xufVxuXG5leHBvcnQgZGVmYXVsdCB2YWxpZGF0ZTsiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/validate.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/dist/index.mjs":
/*!**************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/dist/index.mjs ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AptosConnectAccount: () => (/* binding */ AptosConnectAccount),\n/* harmony export */   AptosConnectWallet: () => (/* binding */ AptosConnectWallet),\n/* harmony export */   registerAptosConnect: () => (/* binding */ registerAptosConnect)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/wallet-standard */ \"(ssr)/./node_modules/@aptos-labs/wallet-standard/dist/esm/index.mjs\");\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @identity-connect/crypto */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/crypto/dist/index.mjs\");\n/* harmony import */ var _identity_connect_dapp_sdk__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @identity-connect/dapp-sdk */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/dist/index.mjs\");\nvar __accessCheck = (obj, member, msg) => {\n  if (!member.has(obj))\n    throw TypeError(\"Cannot \" + msg);\n};\nvar __privateGet = (obj, member, getter) => {\n  __accessCheck(obj, member, \"read from private field\");\n  return getter ? getter.call(obj) : member.get(obj);\n};\nvar __privateAdd = (obj, member, value) => {\n  if (member.has(obj))\n    throw TypeError(\"Cannot add the same private member more than once\");\n  member instanceof WeakSet ? member.add(obj) : member.set(obj, value);\n};\nvar __privateSet = (obj, member, value, setter) => {\n  __accessCheck(obj, member, \"write to private field\");\n  setter ? setter.call(obj, value) : member.set(obj, value);\n  return value;\n};\n\n// src/index.ts\n\n\n// src/AptosConnectWallet.ts\n\n\n\n\n\n// src/AptosConnectAccount.ts\n\n\nvar _address, _publicKey;\nvar AptosConnectAccount = class {\n  constructor({ address, ansName, publicKey }) {\n    // region AptosWalletAccount\n    this.chains = _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.APTOS_CHAINS;\n    this.features = [];\n    // endregion\n    // region PetraAccount\n    __privateAdd(this, _address, void 0);\n    __privateAdd(this, _publicKey, void 0);\n    __privateSet(this, _publicKey, publicKey);\n    __privateSet(this, _address, address);\n    this.label = ansName;\n  }\n  get address() {\n    return __privateGet(this, _address).toString();\n  }\n  get publicKey() {\n    return __privateGet(this, _publicKey).toUint8Array();\n  }\n  get signingScheme() {\n    if (__privateGet(this, _publicKey) instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Ed25519PublicKey) {\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.SigningScheme.Ed25519;\n    }\n    if (__privateGet(this, _publicKey) instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.MultiEd25519PublicKey) {\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.SigningScheme.MultiEd25519;\n    }\n    if (__privateGet(this, _publicKey) instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.AnyPublicKey) {\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.SigningScheme.SingleKey;\n    }\n    if (__privateGet(this, _publicKey) instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.MultiKey) {\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.SigningScheme.MultiKey;\n    }\n    throw new Error(\"Unsupported public key type\");\n  }\n  // endregion\n};\n_address = new WeakMap();\n_publicKey = new WeakMap();\n\n// src/config.ts\nvar walletName = \"Continue with Google\";\nvar walletUrl = \"https://aptosconnect.app\";\nvar walletIcon = (\n  // eslint-disable-next-line max-len\n  \"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiBjbGFzcz0iaF8yMCB3XzIwIj48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTIzLjU0IDEyLjc2MTNDMjMuNTQgMTEuOTQ1OSAyMy40NjY4IDExLjE2MTggMjMuMzMwOSAxMC40MDkxSDEyLjVWMTQuODU3NUgxOC42ODkxQzE4LjQyMjUgMTYuMjk1IDE3LjYxMjMgMTcuNTEyOSAxNi4zOTQzIDE4LjMyODRWMjEuMjEzOEgyMC4xMTA5QzIyLjI4NTUgMTkuMjExOCAyMy41NCAxNi4yNjM2IDIzLjU0IDEyLjc2MTNaIiBmaWxsPSIjNDI4NUY0Ij48L3BhdGg+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik0xMi40OTk1IDIzLjk5OThDMTUuNjA0NSAyMy45OTk4IDE4LjIwNzcgMjIuOTcgMjAuMTEwNCAyMS4yMTM3TDE2LjM5MzggMTguMzI4MkMxNS4zNjQgMTkuMDE4MiAxNC4wNDY3IDE5LjQyNTkgMTIuNDk5NSAxOS40MjU5QzkuNTA0MjUgMTkuNDI1OSA2Ljk2OTAyIDE3LjQwMyA2LjA2NDcgMTQuNjg0OEgyLjIyMjY2VjE3LjY2NDRDNC4xMTQ5MyAyMS40MjI4IDguMDA0MDIgMjMuOTk5OCAxMi40OTk1IDIzLjk5OThaIiBmaWxsPSIjMzRBODUzIj48L3BhdGg+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik02LjA2NTIzIDE0LjY4NTFDNS44MzUyMyAxMy45OTUxIDUuNzA0NTUgMTMuMjU4MSA1LjcwNDU1IDEyLjUwMDFDNS43MDQ1NSAxMS43NDIyIDUuODM1MjMgMTEuMDA1MSA2LjA2NTIzIDEwLjMxNTFWNy4zMzU1N0gyLjIyMzE4QzEuNDQ0MzIgOC44ODgwNyAxIDEwLjY0NDQgMSAxMi41MDAxQzEgMTQuMzU1OCAxLjQ0NDMyIDE2LjExMjIgMi4yMjMxOCAxNy42NjQ3TDYuMDY1MjMgMTQuNjg1MVoiIGZpbGw9IiNGQkJDMDUiPjwvcGF0aD48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTEyLjQ5OTUgNS41NzM4NkMxNC4xODc5IDUuNTczODYgMTUuNzAzOCA2LjE1NDA5IDE2Ljg5NTYgNy4yOTM2NEwyMC4xOTQgMy45OTUyM0MxOC4yMDI0IDIuMTM5NTUgMTUuNTk5MiAxIDEyLjQ5OTUgMUM4LjAwNDAyIDEgNC4xMTQ5MyAzLjU3NzA1IDIuMjIyNjYgNy4zMzU0NUw2LjA2NDcgMTAuMzE1QzYuOTY5MDIgNy41OTY4MiA5LjUwNDI1IDUuNTczODYgMTIuNDk5NSA1LjU3Mzg2WiIgZmlsbD0iI0VBNDMzNSI+PC9wYXRoPjwvc3ZnPg==\"\n);\n\n// src/helpers.ts\n\n\nfunction customAccountToStandardAccount({ address, name, publicKey }) {\n  return new _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AccountInfo({\n    address,\n    ansName: name,\n    publicKey\n  });\n}\nfunction unwrapUserResponse(response, callback) {\n  if (response.status === \"dismissed\") {\n    return { status: _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.UserResponseStatus.REJECTED };\n  }\n  return { args: callback(response.args), status: _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.UserResponseStatus.APPROVED };\n}\nfunction networkToChainId(network) {\n  switch (network) {\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Network.MAINNET:\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.NetworkToChainId.mainnet;\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Network.TESTNET:\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.NetworkToChainId.testnet;\n    default:\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.NetworkToChainId.devnet;\n  }\n}\n\n// src/AptosConnectWallet.ts\nvar _AptosConnectWallet = class _AptosConnectWallet {\n  constructor({ network = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Network.MAINNET, preferredWalletName, ...clientConfig }) {\n    // endregion\n    // region AptosWallet\n    this.name = walletName;\n    this.version = \"1.0.0\";\n    this.icon = walletIcon;\n    this.url = walletUrl;\n    this.chains = _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.APTOS_CHAINS;\n    this.client = new _identity_connect_dapp_sdk__WEBPACK_IMPORTED_MODULE_3__.ACDappClient(clientConfig);\n    if (!_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.NetworkToNodeAPI[network]) {\n      throw new Error(\"Network not supported\");\n    }\n    const aptosConfig = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.AptosConfig({ network });\n    this.aptosClient = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Aptos(aptosConfig);\n    this.preferredWalletName = preferredWalletName;\n  }\n  static get connectedAccount() {\n    const serialized = localStorage.getItem(_AptosConnectWallet.connectedAccountStorageKey);\n    if (!serialized) {\n      return void 0;\n    }\n    try {\n      const { address, publicKey } = JSON.parse(serialized);\n      return new _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AccountInfo({\n        address: _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.AccountAddress.from(address),\n        publicKey: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_2__.deserializePublicKeyB64)(publicKey)\n      });\n    } catch (err) {\n      console.warn(\"Inconsistent state, resetting it\");\n      this.connectedAccount = void 0;\n      return void 0;\n    }\n  }\n  static set connectedAccount(value) {\n    if (value !== void 0) {\n      const serialized = {\n        address: value.address.toString(),\n        publicKey: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_2__.serializePublicKeyB64)(value.publicKey)\n      };\n      localStorage.setItem(_AptosConnectWallet.connectedAccountStorageKey, JSON.stringify(serialized));\n    } else {\n      localStorage.removeItem(_AptosConnectWallet.connectedAccountStorageKey);\n    }\n  }\n  // eslint-disable-next-line class-methods-use-this\n  get accounts() {\n    const { connectedAccount } = _AptosConnectWallet;\n    return connectedAccount ? [new AptosConnectAccount(connectedAccount)] : [];\n  }\n  get features() {\n    return {\n      [_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosConnectNamespace]: {\n        connect: this.connect.bind(this),\n        version: \"1.0.0\"\n      },\n      [_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosDisconnectNamespace]: {\n        disconnect: this.disconnect.bind(this),\n        version: \"1.0.0\"\n      },\n      [_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosGetAccountNamespace]: {\n        account: this.getAccount.bind(this),\n        version: \"1.0.0\"\n      },\n      [_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosGetNetworkNamespace]: {\n        network: this.getNetwork.bind(this),\n        version: \"1.0.0\"\n      },\n      [_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosOnAccountChangeNamespace]: {\n        onAccountChange: this.onAccountChange.bind(this),\n        version: \"1.0.0\"\n      },\n      [_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosOnNetworkChangeNamespace]: {\n        onNetworkChange: this.onNetworkChange.bind(this),\n        version: \"1.0.0\"\n      },\n      [_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosSignAndSubmitTransactionNamespace]: {\n        signAndSubmitTransaction: this.signAndSubmitTransaction.bind(this),\n        version: \"1.1.0\"\n      },\n      [_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosSignMessageNamespace]: {\n        signMessage: this.signMessage.bind(this),\n        version: \"1.0.0\"\n      },\n      [_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosSignTransactionNamespace]: {\n        signTransaction: this.signTransaction.bind(this),\n        version: \"1.1\"\n      }\n    };\n  }\n  async connect() {\n    const { connectedAccount } = _AptosConnectWallet;\n    if (connectedAccount !== void 0) {\n      return { args: connectedAccount, status: _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.UserResponseStatus.APPROVED };\n    }\n    const response = await this.client.connect({ preferredWalletName: this.preferredWalletName });\n    if (response.status === \"dismissed\") {\n      return { status: _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.UserResponseStatus.REJECTED };\n    }\n    const newConnectedAccount = customAccountToStandardAccount(response.args.account);\n    _AptosConnectWallet.connectedAccount = newConnectedAccount;\n    return {\n      args: newConnectedAccount,\n      status: _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.UserResponseStatus.APPROVED\n    };\n  }\n  async disconnect() {\n    const { connectedAccount } = _AptosConnectWallet;\n    if (connectedAccount) {\n      await this.client.disconnect(connectedAccount.address);\n      _AptosConnectWallet.connectedAccount = void 0;\n    }\n  }\n  // eslint-disable-next-line class-methods-use-this\n  async getAccount() {\n    const { connectedAccount } = _AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosWalletError(_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosWalletErrorCode.Unauthorized);\n    }\n    return customAccountToStandardAccount(connectedAccount);\n  }\n  async getNetwork() {\n    const { network } = this.aptosClient.config;\n    const chainId = await this.aptosClient.getChainId();\n    const url = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.NetworkToNodeAPI[network];\n    return {\n      chainId,\n      name: network,\n      url\n    };\n  }\n  async signMessage(input) {\n    const { connectedAccount } = _AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosWalletError(_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosWalletErrorCode.Unauthorized);\n    }\n    const chainId = networkToChainId(this.aptosClient.config.network);\n    const { message, nonce } = input;\n    const encoder = new TextEncoder();\n    const messageBytes = encoder.encode(message);\n    const nonceBytes = encoder.encode(nonce);\n    const response = await this.client.signMessage({\n      chainId,\n      message: messageBytes,\n      nonce: nonceBytes,\n      signerAddress: connectedAccount.address\n    });\n    if (response.status === \"dismissed\") {\n      return { status: _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.UserResponseStatus.REJECTED };\n    }\n    const { fullMessage, signature } = response.args;\n    const extraResponseArgs = {\n      address: connectedAccount.address.toString(),\n      application: this.client.dappInfo.domain,\n      chainId,\n      message,\n      nonce,\n      prefix: \"APTOS\"\n    };\n    return {\n      args: {\n        fullMessage,\n        signature,\n        ...extraResponseArgs\n      },\n      status: _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.UserResponseStatus.APPROVED\n    };\n  }\n  async signTransaction(txnOrArgs, _asFeePayer) {\n    const { connectedAccount } = _AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosWalletError(_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosWalletErrorCode.Unauthorized);\n    }\n    if (\"bcsToBytes\" in txnOrArgs) {\n      const transaction = txnOrArgs;\n      const feePayer = transaction.feePayerAddress ? { address: transaction.feePayerAddress } : void 0;\n      const secondarySigners = transaction.secondarySignerAddresses?.map((address) => ({ address }));\n      const response2 = await this.client.signTransaction({\n        feePayer,\n        secondarySigners,\n        signerAddress: connectedAccount.address,\n        transaction: transaction.rawTransaction\n      });\n      return unwrapUserResponse(response2, (args) => args.authenticator);\n    }\n    const requestArgs = txnOrArgs;\n    const response = await this.client.signTransaction({\n      ...requestArgs,\n      signerAddress: connectedAccount.address\n    });\n    return unwrapUserResponse(response, (responseArgs) => {\n      const { authenticator, rawTransaction } = responseArgs;\n      if (!rawTransaction) {\n        throw new Error(\"Expected raw transaction in response args\");\n      }\n      const secondarySigners = requestArgs.secondarySigners ?? [];\n      let transaction;\n      if (secondarySigners.length > 0) {\n        transaction = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.MultiAgentTransaction(\n          rawTransaction,\n          secondarySigners.map((s) => s.address),\n          requestArgs.feePayer?.address\n        );\n      } else {\n        transaction = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.SimpleTransaction(rawTransaction, requestArgs.feePayer?.address);\n      }\n      return {\n        authenticator,\n        rawTransaction: transaction\n      };\n    });\n  }\n  async signAndSubmitTransaction(args) {\n    const { gasUnitPrice, maxGasAmount, payload } = args;\n    const { connectedAccount } = _AptosConnectWallet;\n    if (!connectedAccount) {\n      throw new _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosWalletError(_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.AptosWalletErrorCode.Unauthorized);\n    }\n    const response = await this.client.signAndSubmitTransaction({\n      gasUnitPrice,\n      maxGasAmount,\n      network: this.aptosClient.config.network,\n      payload,\n      signerAddress: connectedAccount.address\n    });\n    if (response.status === \"dismissed\") {\n      return { status: _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.UserResponseStatus.REJECTED };\n    }\n    return {\n      args: { hash: response.args.txnHash },\n      status: _aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.UserResponseStatus.APPROVED\n    };\n  }\n  // eslint-disable-next-line class-methods-use-this\n  async onAccountChange(_callback) {\n  }\n  // eslint-disable-next-line class-methods-use-this\n  async onNetworkChange(_callback) {\n  }\n  // endregion\n};\n// region connectedAccount\n_AptosConnectWallet.connectedAccountStorageKey = \"@aptos-connect/connectedAccount\";\nvar AptosConnectWallet = _AptosConnectWallet;\n\n// src/index.ts\nfunction registerAptosConnect(config = {}) {\n  const walletPlugin = new AptosConnectWallet(config);\n  (0,_aptos_labs_wallet_standard__WEBPACK_IMPORTED_MODULE_0__.registerWallet)(walletPlugin);\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDNkQ7O0FBRTdEO0FBUzRCO0FBZ0JTO0FBQ3FEO0FBQ2hDOztBQUUxRDtBQU80QjtBQUMrQjtBQUMzRDtBQUNBO0FBQ0EsZ0JBQWdCLDZCQUE2QjtBQUM3QztBQUNBLGtCQUFrQixxRUFBWTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCxnRUFBZ0I7QUFDbEUsYUFBYSw2REFBYTtBQUMxQjtBQUNBLGtEQUFrRCxxRUFBcUI7QUFDdkUsYUFBYSw2REFBYTtBQUMxQjtBQUNBLGtEQUFrRCw0REFBWTtBQUM5RCxhQUFhLDZEQUFhO0FBQzFCO0FBQ0Esa0RBQWtELHdEQUFRO0FBQzFELGFBQWEsNkRBQWE7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0Qjs7QUFFQTtBQUMrRDtBQUMrQjtBQUM5RiwwQ0FBMEMsMEJBQTBCO0FBQ3BFLGFBQWEsb0VBQVk7QUFDekI7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGFBQWEsUUFBUSwyRUFBa0I7QUFDdkM7QUFDQSxXQUFXLHVDQUF1QywyRUFBa0I7QUFDcEU7QUFDQTtBQUNBO0FBQ0EsU0FBUyx1REFBTztBQUNoQixhQUFhLGdFQUFnQjtBQUM3QixTQUFTLHVEQUFPO0FBQ2hCLGFBQWEsZ0VBQWdCO0FBQzdCO0FBQ0EsYUFBYSxnRUFBZ0I7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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZLHNDQUFzQztBQUNsRCxZQUFZLG1CQUFtQjtBQUMvQjtBQUNBLGdCQUFnQix5RUFBZ0IsQ0FBQyw2RUFBb0I7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxlQUFlLFFBQVEsMkVBQW1CO0FBQzFDO0FBQ0E7QUFDQSxjQUFjLDZCQUE2QjtBQUMzQyxjQUFjLDJFQUFtQjtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLHlDQUF5QztBQUN6QztBQUNBLEVBQUUsMkVBQWM7QUFDaEI7QUFLRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGpzLWJvaWxlcnBsYXRlLXRlbXBsYXRlLy4vbm9kZV9tb2R1bGVzL0BhcHRvcy1jb25uZWN0L3dhbGxldC1hZGFwdGVyLXBsdWdpbi9kaXN0L2luZGV4Lm1qcz80NDEwIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBfX2FjY2Vzc0NoZWNrID0gKG9iaiwgbWVtYmVyLCBtc2cpID0+IHtcbiAgaWYgKCFtZW1iZXIuaGFzKG9iaikpXG4gICAgdGhyb3cgVHlwZUVycm9yKFwiQ2Fubm90IFwiICsgbXNnKTtcbn07XG52YXIgX19wcml2YXRlR2V0ID0gKG9iaiwgbWVtYmVyLCBnZXR0ZXIpID0+IHtcbiAgX19hY2Nlc3NDaGVjayhvYmosIG1lbWJlciwgXCJyZWFkIGZyb20gcHJpdmF0ZSBmaWVsZFwiKTtcbiAgcmV0dXJuIGdldHRlciA/IGdldHRlci5jYWxsKG9iaikgOiBtZW1iZXIuZ2V0KG9iaik7XG59O1xudmFyIF9fcHJpdmF0ZUFkZCA9IChvYmosIG1lbWJlciwgdmFsdWUpID0+IHtcbiAgaWYgKG1lbWJlci5oYXMob2JqKSlcbiAgICB0aHJvdyBUeXBlRXJyb3IoXCJDYW5ub3QgYWRkIHRoZSBzYW1lIHByaXZhdGUgbWVtYmVyIG1vcmUgdGhhbiBvbmNlXCIpO1xuICBtZW1iZXIgaW5zdGFuY2VvZiBXZWFrU2V0ID8gbWVtYmVyLmFkZChvYmopIDogbWVtYmVyLnNldChvYmosIHZhbHVlKTtcbn07XG52YXIgX19wcml2YXRlU2V0ID0gKG9iaiwgbWVtYmVyLCB2YWx1ZSwgc2V0dGVyKSA9PiB7XG4gIF9fYWNjZXNzQ2hlY2sob2JqLCBtZW1iZXIsIFwid3JpdGUgdG8gcHJpdmF0ZSBmaWVsZFwiKTtcbiAgc2V0dGVyID8gc2V0dGVyLmNhbGwob2JqLCB2YWx1ZSkgOiBtZW1iZXIuc2V0KG9iaiwgdmFsdWUpO1xuICByZXR1cm4gdmFsdWU7XG59O1xuXG4vLyBzcmMvaW5kZXgudHNcbmltcG9ydCB7IHJlZ2lzdGVyV2FsbGV0IH0gZnJvbSBcIkBhcHRvcy1sYWJzL3dhbGxldC1zdGFuZGFyZFwiO1xuXG4vLyBzcmMvQXB0b3NDb25uZWN0V2FsbGV0LnRzXG5pbXBvcnQge1xuICBBY2NvdW50QWRkcmVzcyBhcyBBY2NvdW50QWRkcmVzczIsXG4gIEFwdG9zLFxuICBBcHRvc0NvbmZpZyxcbiAgTXVsdGlBZ2VudFRyYW5zYWN0aW9uLFxuICBOZXR3b3JrIGFzIE5ldHdvcmsyLFxuICBOZXR3b3JrVG9Ob2RlQVBJLFxuICBTaW1wbGVUcmFuc2FjdGlvblxufSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQge1xuICBBY2NvdW50SW5mbyBhcyBBY2NvdW50SW5mbzMsXG4gIEFQVE9TX0NIQUlOUyBhcyBBUFRPU19DSEFJTlMyLFxuICBBcHRvc0Nvbm5lY3ROYW1lc3BhY2UsXG4gIEFwdG9zRGlzY29ubmVjdE5hbWVzcGFjZSxcbiAgQXB0b3NHZXRBY2NvdW50TmFtZXNwYWNlLFxuICBBcHRvc0dldE5ldHdvcmtOYW1lc3BhY2UsXG4gIEFwdG9zT25BY2NvdW50Q2hhbmdlTmFtZXNwYWNlLFxuICBBcHRvc09uTmV0d29ya0NoYW5nZU5hbWVzcGFjZSxcbiAgQXB0b3NTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25OYW1lc3BhY2UsXG4gIEFwdG9zU2lnbk1lc3NhZ2VOYW1lc3BhY2UsXG4gIEFwdG9zU2lnblRyYW5zYWN0aW9uTmFtZXNwYWNlLFxuICBBcHRvc1dhbGxldEVycm9yLFxuICBBcHRvc1dhbGxldEVycm9yQ29kZSxcbiAgVXNlclJlc3BvbnNlU3RhdHVzIGFzIFVzZXJSZXNwb25zZVN0YXR1czJcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3dhbGxldC1zdGFuZGFyZFwiO1xuaW1wb3J0IHsgZGVzZXJpYWxpemVQdWJsaWNLZXlCNjQsIHNlcmlhbGl6ZVB1YmxpY0tleUI2NCB9IGZyb20gXCJAaWRlbnRpdHktY29ubmVjdC9jcnlwdG9cIjtcbmltcG9ydCB7IEFDRGFwcENsaWVudCB9IGZyb20gXCJAaWRlbnRpdHktY29ubmVjdC9kYXBwLXNka1wiO1xuXG4vLyBzcmMvQXB0b3NDb25uZWN0QWNjb3VudC50c1xuaW1wb3J0IHtcbiAgQW55UHVibGljS2V5LFxuICBFZDI1NTE5UHVibGljS2V5LFxuICBNdWx0aUVkMjU1MTlQdWJsaWNLZXksXG4gIE11bHRpS2V5LFxuICBTaWduaW5nU2NoZW1lXG59IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmltcG9ydCB7IEFQVE9TX0NIQUlOUyB9IGZyb20gXCJAYXB0b3MtbGFicy93YWxsZXQtc3RhbmRhcmRcIjtcbnZhciBfYWRkcmVzcywgX3B1YmxpY0tleTtcbnZhciBBcHRvc0Nvbm5lY3RBY2NvdW50ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcih7IGFkZHJlc3MsIGFuc05hbWUsIHB1YmxpY0tleSB9KSB7XG4gICAgLy8gcmVnaW9uIEFwdG9zV2FsbGV0QWNjb3VudFxuICAgIHRoaXMuY2hhaW5zID0gQVBUT1NfQ0hBSU5TO1xuICAgIHRoaXMuZmVhdHVyZXMgPSBbXTtcbiAgICAvLyBlbmRyZWdpb25cbiAgICAvLyByZWdpb24gUGV0cmFBY2NvdW50XG4gICAgX19wcml2YXRlQWRkKHRoaXMsIF9hZGRyZXNzLCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZUFkZCh0aGlzLCBfcHVibGljS2V5LCB2b2lkIDApO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfcHVibGljS2V5LCBwdWJsaWNLZXkpO1xuICAgIF9fcHJpdmF0ZVNldCh0aGlzLCBfYWRkcmVzcywgYWRkcmVzcyk7XG4gICAgdGhpcy5sYWJlbCA9IGFuc05hbWU7XG4gIH1cbiAgZ2V0IGFkZHJlc3MoKSB7XG4gICAgcmV0dXJuIF9fcHJpdmF0ZUdldCh0aGlzLCBfYWRkcmVzcykudG9TdHJpbmcoKTtcbiAgfVxuICBnZXQgcHVibGljS2V5KCkge1xuICAgIHJldHVybiBfX3ByaXZhdGVHZXQodGhpcywgX3B1YmxpY0tleSkudG9VaW50OEFycmF5KCk7XG4gIH1cbiAgZ2V0IHNpZ25pbmdTY2hlbWUoKSB7XG4gICAgaWYgKF9fcHJpdmF0ZUdldCh0aGlzLCBfcHVibGljS2V5KSBpbnN0YW5jZW9mIEVkMjU1MTlQdWJsaWNLZXkpIHtcbiAgICAgIHJldHVybiBTaWduaW5nU2NoZW1lLkVkMjU1MTk7XG4gICAgfVxuICAgIGlmIChfX3ByaXZhdGVHZXQodGhpcywgX3B1YmxpY0tleSkgaW5zdGFuY2VvZiBNdWx0aUVkMjU1MTlQdWJsaWNLZXkpIHtcbiAgICAgIHJldHVybiBTaWduaW5nU2NoZW1lLk11bHRpRWQyNTUxOTtcbiAgICB9XG4gICAgaWYgKF9fcHJpdmF0ZUdldCh0aGlzLCBfcHVibGljS2V5KSBpbnN0YW5jZW9mIEFueVB1YmxpY0tleSkge1xuICAgICAgcmV0dXJuIFNpZ25pbmdTY2hlbWUuU2luZ2xlS2V5O1xuICAgIH1cbiAgICBpZiAoX19wcml2YXRlR2V0KHRoaXMsIF9wdWJsaWNLZXkpIGluc3RhbmNlb2YgTXVsdGlLZXkpIHtcbiAgICAgIHJldHVybiBTaWduaW5nU2NoZW1lLk11bHRpS2V5O1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbnN1cHBvcnRlZCBwdWJsaWMga2V5IHR5cGVcIik7XG4gIH1cbiAgLy8gZW5kcmVnaW9uXG59O1xuX2FkZHJlc3MgPSBuZXcgV2Vha01hcCgpO1xuX3B1YmxpY0tleSA9IG5ldyBXZWFrTWFwKCk7XG5cbi8vIHNyYy9jb25maWcudHNcbnZhciB3YWxsZXROYW1lID0gXCJDb250aW51ZSB3aXRoIEdvb2dsZVwiO1xudmFyIHdhbGxldFVybCA9IFwiaHR0cHM6Ly9hcHRvc2Nvbm5lY3QuYXBwXCI7XG52YXIgd2FsbGV0SWNvbiA9IChcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG1heC1sZW5cbiAgXCJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlNalFpSUdobGFXZG9kRDBpTWpRaUlIWnBaWGRDYjNnOUlqQWdNQ0F5TkNBeU5DSWdabWxzYkQwaWJtOXVaU0lnZUcxc2JuTTlJbWgwZEhBNkx5OTNkM2N1ZHpNdWIzSm5Mekl3TURBdmMzWm5JaUJqYkdGemN6MGlhRjh5TUNCM1h6SXdJajQ4Y0dGMGFDQm1hV3hzTFhKMWJHVTlJbVYyWlc1dlpHUWlJR05zYVhBdGNuVnNaVDBpWlhabGJtOWtaQ0lnWkQwaVRUSXpMalUwSURFeUxqYzJNVE5ETWpNdU5UUWdNVEV1T1RRMU9TQXlNeTQwTmpZNElERXhMakUyTVRnZ01qTXVNek13T1NBeE1DNDBNRGt4U0RFeUxqVldNVFF1T0RVM05VZ3hPQzQyT0RreFF6RTRMalF5TWpVZ01UWXVNamsxSURFM0xqWXhNak1nTVRjdU5URXlPU0F4Tmk0ek9UUXpJREU0TGpNeU9EUldNakV1TWpFek9FZ3lNQzR4TVRBNVF6SXlMakk0TlRVZ01Ua3VNakV4T0NBeU15NDFOQ0F4Tmk0eU5qTTJJREl6TGpVMElERXlMamMyTVROYUlpQm1hV3hzUFNJak5ESTROVVkwSWo0OEwzQmhkR2crUEhCaGRHZ2dabWxzYkMxeWRXeGxQU0psZG1WdWIyUmtJaUJqYkdsd0xYSjFiR1U5SW1WMlpXNXZaR1FpSUdROUlrMHhNaTQwT1RrMUlESXpMams1T1RoRE1UVXVOakEwTlNBeU15NDVPVGs0SURFNExqSXdOemNnTWpJdU9UY2dNakF1TVRFd05DQXlNUzR5TVRNM1RERTJMak01TXpnZ01UZ3VNekk0TWtNeE5TNHpOalFnTVRrdU1ERTRNaUF4TkM0d05EWTNJREU1TGpReU5Ua2dNVEl1TkRrNU5TQXhPUzQwTWpVNVF6a3VOVEEwTWpVZ01Ua3VOREkxT1NBMkxqazJPVEF5SURFM0xqUXdNeUEyTGpBMk5EY2dNVFF1TmpnME9FZ3lMakl5TWpZMlZqRTNMalkyTkRSRE5DNHhNVFE1TXlBeU1TNDBNakk0SURndU1EQTBNRElnTWpNdU9UazVPQ0F4TWk0ME9UazFJREl6TGprNU9UaGFJaUJtYVd4c1BTSWpNelJCT0RVeklqNDhMM0JoZEdnK1BIQmhkR2dnWm1sc2JDMXlkV3hsUFNKbGRtVnViMlJrSWlCamJHbHdMWEoxYkdVOUltVjJaVzV2WkdRaUlHUTlJazAyTGpBMk5USXpJREUwTGpZNE5URkROUzQ0TXpVeU15QXhNeTQ1T1RVeElEVXVOekEwTlRVZ01UTXVNalU0TVNBMUxqY3dORFUxSURFeUxqVXdNREZETlM0M01EUTFOU0F4TVM0M05ESXlJRFV1T0RNMU1qTWdNVEV1TURBMU1TQTJMakEyTlRJeklERXdMak14TlRGV055NHpNelUxTjBneUxqSXlNekU0UXpFdU5EUTBNeklnT0M0NE9EZ3dOeUF4SURFd0xqWTBORFFnTVNBeE1pNDFNREF4UXpFZ01UUXVNelUxT0NBeExqUTBORE15SURFMkxqRXhNaklnTWk0eU1qTXhPQ0F4Tnk0Mk5qUTNURFl1TURZMU1qTWdNVFF1TmpnMU1Wb2lJR1pwYkd3OUlpTkdRa0pETURVaVBqd3ZjR0YwYUQ0OGNHRjBhQ0JtYVd4c0xYSjFiR1U5SW1WMlpXNXZaR1FpSUdOc2FYQXRjblZzWlQwaVpYWmxibTlrWkNJZ1pEMGlUVEV5TGpRNU9UVWdOUzQxTnpNNE5rTXhOQzR4T0RjNUlEVXVOVGN6T0RZZ01UVXVOekF6T0NBMkxqRTFOREE1SURFMkxqZzVOVFlnTnk0eU9UTTJORXd5TUM0eE9UUWdNeTQ1T1RVeU0wTXhPQzR5TURJMElESXVNVE01TlRVZ01UVXVOVGs1TWlBeElERXlMalE1T1RVZ01VTTRMakF3TkRBeUlERWdOQzR4TVRRNU15QXpMalUzTnpBMUlESXVNakl5TmpZZ055NHpNelUwTlV3MkxqQTJORGNnTVRBdU16RTFRell1T1RZNU1ESWdOeTQxT1RZNE1pQTVMalV3TkRJMUlEVXVOVGN6T0RZZ01USXVORGs1TlNBMUxqVTNNemcyV2lJZ1ptbHNiRDBpSTBWQk5ETXpOU0krUEM5d1lYUm9Qand2YzNablBnPT1cIlxuKTtcblxuLy8gc3JjL2hlbHBlcnMudHNcbmltcG9ydCB7IE5ldHdvcmssIE5ldHdvcmtUb0NoYWluSWQgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQgeyBBY2NvdW50SW5mbyBhcyBBY2NvdW50SW5mbzIsIFVzZXJSZXNwb25zZVN0YXR1cyB9IGZyb20gXCJAYXB0b3MtbGFicy93YWxsZXQtc3RhbmRhcmRcIjtcbmZ1bmN0aW9uIGN1c3RvbUFjY291bnRUb1N0YW5kYXJkQWNjb3VudCh7IGFkZHJlc3MsIG5hbWUsIHB1YmxpY0tleSB9KSB7XG4gIHJldHVybiBuZXcgQWNjb3VudEluZm8yKHtcbiAgICBhZGRyZXNzLFxuICAgIGFuc05hbWU6IG5hbWUsXG4gICAgcHVibGljS2V5XG4gIH0pO1xufVxuZnVuY3Rpb24gdW53cmFwVXNlclJlc3BvbnNlKHJlc3BvbnNlLCBjYWxsYmFjaykge1xuICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSBcImRpc21pc3NlZFwiKSB7XG4gICAgcmV0dXJuIHsgc3RhdHVzOiBVc2VyUmVzcG9uc2VTdGF0dXMuUkVKRUNURUQgfTtcbiAgfVxuICByZXR1cm4geyBhcmdzOiBjYWxsYmFjayhyZXNwb25zZS5hcmdzKSwgc3RhdHVzOiBVc2VyUmVzcG9uc2VTdGF0dXMuQVBQUk9WRUQgfTtcbn1cbmZ1bmN0aW9uIG5ldHdvcmtUb0NoYWluSWQobmV0d29yaykge1xuICBzd2l0Y2ggKG5ldHdvcmspIHtcbiAgICBjYXNlIE5ldHdvcmsuTUFJTk5FVDpcbiAgICAgIHJldHVybiBOZXR3b3JrVG9DaGFpbklkLm1haW5uZXQ7XG4gICAgY2FzZSBOZXR3b3JrLlRFU1RORVQ6XG4gICAgICByZXR1cm4gTmV0d29ya1RvQ2hhaW5JZC50ZXN0bmV0O1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gTmV0d29ya1RvQ2hhaW5JZC5kZXZuZXQ7XG4gIH1cbn1cblxuLy8gc3JjL0FwdG9zQ29ubmVjdFdhbGxldC50c1xudmFyIF9BcHRvc0Nvbm5lY3RXYWxsZXQgPSBjbGFzcyBfQXB0b3NDb25uZWN0V2FsbGV0IHtcbiAgY29uc3RydWN0b3IoeyBuZXR3b3JrID0gTmV0d29yazIuTUFJTk5FVCwgcHJlZmVycmVkV2FsbGV0TmFtZSwgLi4uY2xpZW50Q29uZmlnIH0pIHtcbiAgICAvLyBlbmRyZWdpb25cbiAgICAvLyByZWdpb24gQXB0b3NXYWxsZXRcbiAgICB0aGlzLm5hbWUgPSB3YWxsZXROYW1lO1xuICAgIHRoaXMudmVyc2lvbiA9IFwiMS4wLjBcIjtcbiAgICB0aGlzLmljb24gPSB3YWxsZXRJY29uO1xuICAgIHRoaXMudXJsID0gd2FsbGV0VXJsO1xuICAgIHRoaXMuY2hhaW5zID0gQVBUT1NfQ0hBSU5TMjtcbiAgICB0aGlzLmNsaWVudCA9IG5ldyBBQ0RhcHBDbGllbnQoY2xpZW50Q29uZmlnKTtcbiAgICBpZiAoIU5ldHdvcmtUb05vZGVBUElbbmV0d29ya10pIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIk5ldHdvcmsgbm90IHN1cHBvcnRlZFwiKTtcbiAgICB9XG4gICAgY29uc3QgYXB0b3NDb25maWcgPSBuZXcgQXB0b3NDb25maWcoeyBuZXR3b3JrIH0pO1xuICAgIHRoaXMuYXB0b3NDbGllbnQgPSBuZXcgQXB0b3MoYXB0b3NDb25maWcpO1xuICAgIHRoaXMucHJlZmVycmVkV2FsbGV0TmFtZSA9IHByZWZlcnJlZFdhbGxldE5hbWU7XG4gIH1cbiAgc3RhdGljIGdldCBjb25uZWN0ZWRBY2NvdW50KCkge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWQgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShfQXB0b3NDb25uZWN0V2FsbGV0LmNvbm5lY3RlZEFjY291bnRTdG9yYWdlS2V5KTtcbiAgICBpZiAoIXNlcmlhbGl6ZWQpIHtcbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGFkZHJlc3MsIHB1YmxpY0tleSB9ID0gSlNPTi5wYXJzZShzZXJpYWxpemVkKTtcbiAgICAgIHJldHVybiBuZXcgQWNjb3VudEluZm8zKHtcbiAgICAgICAgYWRkcmVzczogQWNjb3VudEFkZHJlc3MyLmZyb20oYWRkcmVzcyksXG4gICAgICAgIHB1YmxpY0tleTogZGVzZXJpYWxpemVQdWJsaWNLZXlCNjQocHVibGljS2V5KVxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLndhcm4oXCJJbmNvbnNpc3RlbnQgc3RhdGUsIHJlc2V0dGluZyBpdFwiKTtcbiAgICAgIHRoaXMuY29ubmVjdGVkQWNjb3VudCA9IHZvaWQgMDtcbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICB9XG4gIHN0YXRpYyBzZXQgY29ubmVjdGVkQWNjb3VudCh2YWx1ZSkge1xuICAgIGlmICh2YWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICBjb25zdCBzZXJpYWxpemVkID0ge1xuICAgICAgICBhZGRyZXNzOiB2YWx1ZS5hZGRyZXNzLnRvU3RyaW5nKCksXG4gICAgICAgIHB1YmxpY0tleTogc2VyaWFsaXplUHVibGljS2V5QjY0KHZhbHVlLnB1YmxpY0tleSlcbiAgICAgIH07XG4gICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShfQXB0b3NDb25uZWN0V2FsbGV0LmNvbm5lY3RlZEFjY291bnRTdG9yYWdlS2V5LCBKU09OLnN0cmluZ2lmeShzZXJpYWxpemVkKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKF9BcHRvc0Nvbm5lY3RXYWxsZXQuY29ubmVjdGVkQWNjb3VudFN0b3JhZ2VLZXkpO1xuICAgIH1cbiAgfVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2xhc3MtbWV0aG9kcy11c2UtdGhpc1xuICBnZXQgYWNjb3VudHMoKSB7XG4gICAgY29uc3QgeyBjb25uZWN0ZWRBY2NvdW50IH0gPSBfQXB0b3NDb25uZWN0V2FsbGV0O1xuICAgIHJldHVybiBjb25uZWN0ZWRBY2NvdW50ID8gW25ldyBBcHRvc0Nvbm5lY3RBY2NvdW50KGNvbm5lY3RlZEFjY291bnQpXSA6IFtdO1xuICB9XG4gIGdldCBmZWF0dXJlcygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgW0FwdG9zQ29ubmVjdE5hbWVzcGFjZV06IHtcbiAgICAgICAgY29ubmVjdDogdGhpcy5jb25uZWN0LmJpbmQodGhpcyksXG4gICAgICAgIHZlcnNpb246IFwiMS4wLjBcIlxuICAgICAgfSxcbiAgICAgIFtBcHRvc0Rpc2Nvbm5lY3ROYW1lc3BhY2VdOiB7XG4gICAgICAgIGRpc2Nvbm5lY3Q6IHRoaXMuZGlzY29ubmVjdC5iaW5kKHRoaXMpLFxuICAgICAgICB2ZXJzaW9uOiBcIjEuMC4wXCJcbiAgICAgIH0sXG4gICAgICBbQXB0b3NHZXRBY2NvdW50TmFtZXNwYWNlXToge1xuICAgICAgICBhY2NvdW50OiB0aGlzLmdldEFjY291bnQuYmluZCh0aGlzKSxcbiAgICAgICAgdmVyc2lvbjogXCIxLjAuMFwiXG4gICAgICB9LFxuICAgICAgW0FwdG9zR2V0TmV0d29ya05hbWVzcGFjZV06IHtcbiAgICAgICAgbmV0d29yazogdGhpcy5nZXROZXR3b3JrLmJpbmQodGhpcyksXG4gICAgICAgIHZlcnNpb246IFwiMS4wLjBcIlxuICAgICAgfSxcbiAgICAgIFtBcHRvc09uQWNjb3VudENoYW5nZU5hbWVzcGFjZV06IHtcbiAgICAgICAgb25BY2NvdW50Q2hhbmdlOiB0aGlzLm9uQWNjb3VudENoYW5nZS5iaW5kKHRoaXMpLFxuICAgICAgICB2ZXJzaW9uOiBcIjEuMC4wXCJcbiAgICAgIH0sXG4gICAgICBbQXB0b3NPbk5ldHdvcmtDaGFuZ2VOYW1lc3BhY2VdOiB7XG4gICAgICAgIG9uTmV0d29ya0NoYW5nZTogdGhpcy5vbk5ldHdvcmtDaGFuZ2UuYmluZCh0aGlzKSxcbiAgICAgICAgdmVyc2lvbjogXCIxLjAuMFwiXG4gICAgICB9LFxuICAgICAgW0FwdG9zU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uTmFtZXNwYWNlXToge1xuICAgICAgICBzaWduQW5kU3VibWl0VHJhbnNhY3Rpb246IHRoaXMuc2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uLmJpbmQodGhpcyksXG4gICAgICAgIHZlcnNpb246IFwiMS4xLjBcIlxuICAgICAgfSxcbiAgICAgIFtBcHRvc1NpZ25NZXNzYWdlTmFtZXNwYWNlXToge1xuICAgICAgICBzaWduTWVzc2FnZTogdGhpcy5zaWduTWVzc2FnZS5iaW5kKHRoaXMpLFxuICAgICAgICB2ZXJzaW9uOiBcIjEuMC4wXCJcbiAgICAgIH0sXG4gICAgICBbQXB0b3NTaWduVHJhbnNhY3Rpb25OYW1lc3BhY2VdOiB7XG4gICAgICAgIHNpZ25UcmFuc2FjdGlvbjogdGhpcy5zaWduVHJhbnNhY3Rpb24uYmluZCh0aGlzKSxcbiAgICAgICAgdmVyc2lvbjogXCIxLjFcIlxuICAgICAgfVxuICAgIH07XG4gIH1cbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBjb25zdCB7IGNvbm5lY3RlZEFjY291bnQgfSA9IF9BcHRvc0Nvbm5lY3RXYWxsZXQ7XG4gICAgaWYgKGNvbm5lY3RlZEFjY291bnQgIT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuIHsgYXJnczogY29ubmVjdGVkQWNjb3VudCwgc3RhdHVzOiBVc2VyUmVzcG9uc2VTdGF0dXMyLkFQUFJPVkVEIH07XG4gICAgfVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jbGllbnQuY29ubmVjdCh7IHByZWZlcnJlZFdhbGxldE5hbWU6IHRoaXMucHJlZmVycmVkV2FsbGV0TmFtZSB9KTtcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSBcImRpc21pc3NlZFwiKSB7XG4gICAgICByZXR1cm4geyBzdGF0dXM6IFVzZXJSZXNwb25zZVN0YXR1czIuUkVKRUNURUQgfTtcbiAgICB9XG4gICAgY29uc3QgbmV3Q29ubmVjdGVkQWNjb3VudCA9IGN1c3RvbUFjY291bnRUb1N0YW5kYXJkQWNjb3VudChyZXNwb25zZS5hcmdzLmFjY291bnQpO1xuICAgIF9BcHRvc0Nvbm5lY3RXYWxsZXQuY29ubmVjdGVkQWNjb3VudCA9IG5ld0Nvbm5lY3RlZEFjY291bnQ7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFyZ3M6IG5ld0Nvbm5lY3RlZEFjY291bnQsXG4gICAgICBzdGF0dXM6IFVzZXJSZXNwb25zZVN0YXR1czIuQVBQUk9WRURcbiAgICB9O1xuICB9XG4gIGFzeW5jIGRpc2Nvbm5lY3QoKSB7XG4gICAgY29uc3QgeyBjb25uZWN0ZWRBY2NvdW50IH0gPSBfQXB0b3NDb25uZWN0V2FsbGV0O1xuICAgIGlmIChjb25uZWN0ZWRBY2NvdW50KSB7XG4gICAgICBhd2FpdCB0aGlzLmNsaWVudC5kaXNjb25uZWN0KGNvbm5lY3RlZEFjY291bnQuYWRkcmVzcyk7XG4gICAgICBfQXB0b3NDb25uZWN0V2FsbGV0LmNvbm5lY3RlZEFjY291bnQgPSB2b2lkIDA7XG4gICAgfVxuICB9XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjbGFzcy1tZXRob2RzLXVzZS10aGlzXG4gIGFzeW5jIGdldEFjY291bnQoKSB7XG4gICAgY29uc3QgeyBjb25uZWN0ZWRBY2NvdW50IH0gPSBfQXB0b3NDb25uZWN0V2FsbGV0O1xuICAgIGlmICghY29ubmVjdGVkQWNjb3VudCkge1xuICAgICAgdGhyb3cgbmV3IEFwdG9zV2FsbGV0RXJyb3IoQXB0b3NXYWxsZXRFcnJvckNvZGUuVW5hdXRob3JpemVkKTtcbiAgICB9XG4gICAgcmV0dXJuIGN1c3RvbUFjY291bnRUb1N0YW5kYXJkQWNjb3VudChjb25uZWN0ZWRBY2NvdW50KTtcbiAgfVxuICBhc3luYyBnZXROZXR3b3JrKCkge1xuICAgIGNvbnN0IHsgbmV0d29yayB9ID0gdGhpcy5hcHRvc0NsaWVudC5jb25maWc7XG4gICAgY29uc3QgY2hhaW5JZCA9IGF3YWl0IHRoaXMuYXB0b3NDbGllbnQuZ2V0Q2hhaW5JZCgpO1xuICAgIGNvbnN0IHVybCA9IE5ldHdvcmtUb05vZGVBUElbbmV0d29ya107XG4gICAgcmV0dXJuIHtcbiAgICAgIGNoYWluSWQsXG4gICAgICBuYW1lOiBuZXR3b3JrLFxuICAgICAgdXJsXG4gICAgfTtcbiAgfVxuICBhc3luYyBzaWduTWVzc2FnZShpbnB1dCkge1xuICAgIGNvbnN0IHsgY29ubmVjdGVkQWNjb3VudCB9ID0gX0FwdG9zQ29ubmVjdFdhbGxldDtcbiAgICBpZiAoIWNvbm5lY3RlZEFjY291bnQpIHtcbiAgICAgIHRocm93IG5ldyBBcHRvc1dhbGxldEVycm9yKEFwdG9zV2FsbGV0RXJyb3JDb2RlLlVuYXV0aG9yaXplZCk7XG4gICAgfVxuICAgIGNvbnN0IGNoYWluSWQgPSBuZXR3b3JrVG9DaGFpbklkKHRoaXMuYXB0b3NDbGllbnQuY29uZmlnLm5ldHdvcmspO1xuICAgIGNvbnN0IHsgbWVzc2FnZSwgbm9uY2UgfSA9IGlucHV0O1xuICAgIGNvbnN0IGVuY29kZXIgPSBuZXcgVGV4dEVuY29kZXIoKTtcbiAgICBjb25zdCBtZXNzYWdlQnl0ZXMgPSBlbmNvZGVyLmVuY29kZShtZXNzYWdlKTtcbiAgICBjb25zdCBub25jZUJ5dGVzID0gZW5jb2Rlci5lbmNvZGUobm9uY2UpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5jbGllbnQuc2lnbk1lc3NhZ2Uoe1xuICAgICAgY2hhaW5JZCxcbiAgICAgIG1lc3NhZ2U6IG1lc3NhZ2VCeXRlcyxcbiAgICAgIG5vbmNlOiBub25jZUJ5dGVzLFxuICAgICAgc2lnbmVyQWRkcmVzczogY29ubmVjdGVkQWNjb3VudC5hZGRyZXNzXG4gICAgfSk7XG4gICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gXCJkaXNtaXNzZWRcIikge1xuICAgICAgcmV0dXJuIHsgc3RhdHVzOiBVc2VyUmVzcG9uc2VTdGF0dXMyLlJFSkVDVEVEIH07XG4gICAgfVxuICAgIGNvbnN0IHsgZnVsbE1lc3NhZ2UsIHNpZ25hdHVyZSB9ID0gcmVzcG9uc2UuYXJncztcbiAgICBjb25zdCBleHRyYVJlc3BvbnNlQXJncyA9IHtcbiAgICAgIGFkZHJlc3M6IGNvbm5lY3RlZEFjY291bnQuYWRkcmVzcy50b1N0cmluZygpLFxuICAgICAgYXBwbGljYXRpb246IHRoaXMuY2xpZW50LmRhcHBJbmZvLmRvbWFpbixcbiAgICAgIGNoYWluSWQsXG4gICAgICBtZXNzYWdlLFxuICAgICAgbm9uY2UsXG4gICAgICBwcmVmaXg6IFwiQVBUT1NcIlxuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgIGFyZ3M6IHtcbiAgICAgICAgZnVsbE1lc3NhZ2UsXG4gICAgICAgIHNpZ25hdHVyZSxcbiAgICAgICAgLi4uZXh0cmFSZXNwb25zZUFyZ3NcbiAgICAgIH0sXG4gICAgICBzdGF0dXM6IFVzZXJSZXNwb25zZVN0YXR1czIuQVBQUk9WRURcbiAgICB9O1xuICB9XG4gIGFzeW5jIHNpZ25UcmFuc2FjdGlvbih0eG5PckFyZ3MsIF9hc0ZlZVBheWVyKSB7XG4gICAgY29uc3QgeyBjb25uZWN0ZWRBY2NvdW50IH0gPSBfQXB0b3NDb25uZWN0V2FsbGV0O1xuICAgIGlmICghY29ubmVjdGVkQWNjb3VudCkge1xuICAgICAgdGhyb3cgbmV3IEFwdG9zV2FsbGV0RXJyb3IoQXB0b3NXYWxsZXRFcnJvckNvZGUuVW5hdXRob3JpemVkKTtcbiAgICB9XG4gICAgaWYgKFwiYmNzVG9CeXRlc1wiIGluIHR4bk9yQXJncykge1xuICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSB0eG5PckFyZ3M7XG4gICAgICBjb25zdCBmZWVQYXllciA9IHRyYW5zYWN0aW9uLmZlZVBheWVyQWRkcmVzcyA/IHsgYWRkcmVzczogdHJhbnNhY3Rpb24uZmVlUGF5ZXJBZGRyZXNzIH0gOiB2b2lkIDA7XG4gICAgICBjb25zdCBzZWNvbmRhcnlTaWduZXJzID0gdHJhbnNhY3Rpb24uc2Vjb25kYXJ5U2lnbmVyQWRkcmVzc2VzPy5tYXAoKGFkZHJlc3MpID0+ICh7IGFkZHJlc3MgfSkpO1xuICAgICAgY29uc3QgcmVzcG9uc2UyID0gYXdhaXQgdGhpcy5jbGllbnQuc2lnblRyYW5zYWN0aW9uKHtcbiAgICAgICAgZmVlUGF5ZXIsXG4gICAgICAgIHNlY29uZGFyeVNpZ25lcnMsXG4gICAgICAgIHNpZ25lckFkZHJlc3M6IGNvbm5lY3RlZEFjY291bnQuYWRkcmVzcyxcbiAgICAgICAgdHJhbnNhY3Rpb246IHRyYW5zYWN0aW9uLnJhd1RyYW5zYWN0aW9uXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1bndyYXBVc2VyUmVzcG9uc2UocmVzcG9uc2UyLCAoYXJncykgPT4gYXJncy5hdXRoZW50aWNhdG9yKTtcbiAgICB9XG4gICAgY29uc3QgcmVxdWVzdEFyZ3MgPSB0eG5PckFyZ3M7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNsaWVudC5zaWduVHJhbnNhY3Rpb24oe1xuICAgICAgLi4ucmVxdWVzdEFyZ3MsXG4gICAgICBzaWduZXJBZGRyZXNzOiBjb25uZWN0ZWRBY2NvdW50LmFkZHJlc3NcbiAgICB9KTtcbiAgICByZXR1cm4gdW53cmFwVXNlclJlc3BvbnNlKHJlc3BvbnNlLCAocmVzcG9uc2VBcmdzKSA9PiB7XG4gICAgICBjb25zdCB7IGF1dGhlbnRpY2F0b3IsIHJhd1RyYW5zYWN0aW9uIH0gPSByZXNwb25zZUFyZ3M7XG4gICAgICBpZiAoIXJhd1RyYW5zYWN0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIkV4cGVjdGVkIHJhdyB0cmFuc2FjdGlvbiBpbiByZXNwb25zZSBhcmdzXCIpO1xuICAgICAgfVxuICAgICAgY29uc3Qgc2Vjb25kYXJ5U2lnbmVycyA9IHJlcXVlc3RBcmdzLnNlY29uZGFyeVNpZ25lcnMgPz8gW107XG4gICAgICBsZXQgdHJhbnNhY3Rpb247XG4gICAgICBpZiAoc2Vjb25kYXJ5U2lnbmVycy5sZW5ndGggPiAwKSB7XG4gICAgICAgIHRyYW5zYWN0aW9uID0gbmV3IE11bHRpQWdlbnRUcmFuc2FjdGlvbihcbiAgICAgICAgICByYXdUcmFuc2FjdGlvbixcbiAgICAgICAgICBzZWNvbmRhcnlTaWduZXJzLm1hcCgocykgPT4gcy5hZGRyZXNzKSxcbiAgICAgICAgICByZXF1ZXN0QXJncy5mZWVQYXllcj8uYWRkcmVzc1xuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdHJhbnNhY3Rpb24gPSBuZXcgU2ltcGxlVHJhbnNhY3Rpb24ocmF3VHJhbnNhY3Rpb24sIHJlcXVlc3RBcmdzLmZlZVBheWVyPy5hZGRyZXNzKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGF1dGhlbnRpY2F0b3IsXG4gICAgICAgIHJhd1RyYW5zYWN0aW9uOiB0cmFuc2FjdGlvblxuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuICBhc3luYyBzaWduQW5kU3VibWl0VHJhbnNhY3Rpb24oYXJncykge1xuICAgIGNvbnN0IHsgZ2FzVW5pdFByaWNlLCBtYXhHYXNBbW91bnQsIHBheWxvYWQgfSA9IGFyZ3M7XG4gICAgY29uc3QgeyBjb25uZWN0ZWRBY2NvdW50IH0gPSBfQXB0b3NDb25uZWN0V2FsbGV0O1xuICAgIGlmICghY29ubmVjdGVkQWNjb3VudCkge1xuICAgICAgdGhyb3cgbmV3IEFwdG9zV2FsbGV0RXJyb3IoQXB0b3NXYWxsZXRFcnJvckNvZGUuVW5hdXRob3JpemVkKTtcbiAgICB9XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNsaWVudC5zaWduQW5kU3VibWl0VHJhbnNhY3Rpb24oe1xuICAgICAgZ2FzVW5pdFByaWNlLFxuICAgICAgbWF4R2FzQW1vdW50LFxuICAgICAgbmV0d29yazogdGhpcy5hcHRvc0NsaWVudC5jb25maWcubmV0d29yayxcbiAgICAgIHBheWxvYWQsXG4gICAgICBzaWduZXJBZGRyZXNzOiBjb25uZWN0ZWRBY2NvdW50LmFkZHJlc3NcbiAgICB9KTtcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSBcImRpc21pc3NlZFwiKSB7XG4gICAgICByZXR1cm4geyBzdGF0dXM6IFVzZXJSZXNwb25zZVN0YXR1czIuUkVKRUNURUQgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGFyZ3M6IHsgaGFzaDogcmVzcG9uc2UuYXJncy50eG5IYXNoIH0sXG4gICAgICBzdGF0dXM6IFVzZXJSZXNwb25zZVN0YXR1czIuQVBQUk9WRURcbiAgICB9O1xuICB9XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjbGFzcy1tZXRob2RzLXVzZS10aGlzXG4gIGFzeW5jIG9uQWNjb3VudENoYW5nZShfY2FsbGJhY2spIHtcbiAgfVxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2xhc3MtbWV0aG9kcy11c2UtdGhpc1xuICBhc3luYyBvbk5ldHdvcmtDaGFuZ2UoX2NhbGxiYWNrKSB7XG4gIH1cbiAgLy8gZW5kcmVnaW9uXG59O1xuLy8gcmVnaW9uIGNvbm5lY3RlZEFjY291bnRcbl9BcHRvc0Nvbm5lY3RXYWxsZXQuY29ubmVjdGVkQWNjb3VudFN0b3JhZ2VLZXkgPSBcIkBhcHRvcy1jb25uZWN0L2Nvbm5lY3RlZEFjY291bnRcIjtcbnZhciBBcHRvc0Nvbm5lY3RXYWxsZXQgPSBfQXB0b3NDb25uZWN0V2FsbGV0O1xuXG4vLyBzcmMvaW5kZXgudHNcbmZ1bmN0aW9uIHJlZ2lzdGVyQXB0b3NDb25uZWN0KGNvbmZpZyA9IHt9KSB7XG4gIGNvbnN0IHdhbGxldFBsdWdpbiA9IG5ldyBBcHRvc0Nvbm5lY3RXYWxsZXQoY29uZmlnKTtcbiAgcmVnaXN0ZXJXYWxsZXQod2FsbGV0UGx1Z2luKTtcbn1cbmV4cG9ydCB7XG4gIEFwdG9zQ29ubmVjdEFjY291bnQsXG4gIEFwdG9zQ29ubmVjdFdhbGxldCxcbiAgcmVnaXN0ZXJBcHRvc0Nvbm5lY3Rcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5tanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@aptos-connect/wallet-api/dist/index.mjs":
/*!*****************************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@aptos-connect/wallet-api/dist/index.mjs ***!
  \*****************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AptosWalletErrorResponseMessage: () => (/* binding */ AptosWalletErrorResponseMessage),\n/* harmony export */   AptosWalletRequestMessage: () => (/* binding */ AptosWalletRequestMessage),\n/* harmony export */   AptosWalletSuccessResponseMessage: () => (/* binding */ AptosWalletSuccessResponseMessage),\n/* harmony export */   ConnectRequest: () => (/* binding */ ConnectRequest),\n/* harmony export */   ConnectResponse: () => (/* binding */ ConnectResponse),\n/* harmony export */   DisconnectRequest: () => (/* binding */ DisconnectRequest),\n/* harmony export */   DisconnectResponse: () => (/* binding */ DisconnectResponse),\n/* harmony export */   EntryFunctionArgumentVariant: () => (/* binding */ EntryFunctionArgumentVariant),\n/* harmony export */   GetConnectedAccountsRequest: () => (/* binding */ GetConnectedAccountsRequest),\n/* harmony export */   GetConnectedAccountsResponse: () => (/* binding */ GetConnectedAccountsResponse),\n/* harmony export */   IsConnectedRequest: () => (/* binding */ IsConnectedRequest),\n/* harmony export */   IsConnectedResponse: () => (/* binding */ IsConnectedResponse),\n/* harmony export */   PromptApprovalResponseMessage: () => (/* binding */ PromptApprovalResponseMessage),\n/* harmony export */   PromptOpenerPingRequestMessage: () => (/* binding */ PromptOpenerPingRequestMessage),\n/* harmony export */   PromptOpenerPingResponseMessage: () => (/* binding */ PromptOpenerPingResponseMessage),\n/* harmony export */   PromptUnauthorizedErrorMessage: () => (/* binding */ PromptUnauthorizedErrorMessage),\n/* harmony export */   SignAndSubmitTransactionRequest: () => (/* binding */ SignAndSubmitTransactionRequest),\n/* harmony export */   SignAndSubmitTransactionResponse: () => (/* binding */ SignAndSubmitTransactionResponse),\n/* harmony export */   SignMessageRequest: () => (/* binding */ SignMessageRequest),\n/* harmony export */   SignMessageResponse: () => (/* binding */ SignMessageResponse),\n/* harmony export */   SignTransactionRequest: () => (/* binding */ SignTransactionRequest),\n/* harmony export */   SignTransactionResponse: () => (/* binding */ SignTransactionResponse),\n/* harmony export */   TransactionPayloadInputVariant: () => (/* binding */ TransactionPayloadInputVariant),\n/* harmony export */   base64ToBytes: () => (/* binding */ base64ToBytes),\n/* harmony export */   base64urlToBytes: () => (/* binding */ base64urlToBytes),\n/* harmony export */   bytesToBase64: () => (/* binding */ bytesToBase64),\n/* harmony export */   bytesToBase64url: () => (/* binding */ bytesToBase64url),\n/* harmony export */   chainIdToNetwork: () => (/* binding */ chainIdToNetwork),\n/* harmony export */   decodePopupWalletRequest: () => (/* binding */ decodePopupWalletRequest),\n/* harmony export */   decodeWalletRequestBody: () => (/* binding */ decodeWalletRequestBody),\n/* harmony export */   deserializeAccountAuthenticatorInput: () => (/* binding */ deserializeAccountAuthenticatorInput),\n/* harmony export */   deserializeAccountInfo: () => (/* binding */ deserializeAccountInfo),\n/* harmony export */   deserializeAccountInput: () => (/* binding */ deserializeAccountInput),\n/* harmony export */   deserializeDappInfo: () => (/* binding */ deserializeDappInfo),\n/* harmony export */   deserializeEntryFunctionArgument: () => (/* binding */ deserializeEntryFunctionArgument),\n/* harmony export */   deserializePublicKey: () => (/* binding */ deserializePublicKey),\n/* harmony export */   deserializeSignature: () => (/* binding */ deserializeSignature),\n/* harmony export */   deserializeTransactionPayloadInput: () => (/* binding */ deserializeTransactionPayloadInput),\n/* harmony export */   deserializeWalletRequest: () => (/* binding */ deserializeWalletRequest),\n/* harmony export */   deserializeWalletRequestWithArgs: () => (/* binding */ deserializeWalletRequestWithArgs),\n/* harmony export */   deserializeWalletResponse: () => (/* binding */ deserializeWalletResponse),\n/* harmony export */   encodePopupWalletRequest: () => (/* binding */ encodePopupWalletRequest),\n/* harmony export */   encodeWalletRequestBody: () => (/* binding */ encodeWalletRequestBody),\n/* harmony export */   isAptosWalletResponseMessage: () => (/* binding */ isAptosWalletResponseMessage),\n/* harmony export */   isSupportedNetwork: () => (/* binding */ isSupportedNetwork),\n/* harmony export */   isTypedMessage: () => (/* binding */ isTypedMessage),\n/* harmony export */   makePopupWalletRequestChallenge: () => (/* binding */ makePopupWalletRequestChallenge),\n/* harmony export */   makeUserApproval: () => (/* binding */ makeUserApproval),\n/* harmony export */   makeUserResponseDeserializeFn: () => (/* binding */ makeUserResponseDeserializeFn),\n/* harmony export */   makeUserResponseSerializeFn: () => (/* binding */ makeUserResponseSerializeFn),\n/* harmony export */   serializeAccountAuthenticatorInput: () => (/* binding */ serializeAccountAuthenticatorInput),\n/* harmony export */   serializeAccountInfo: () => (/* binding */ serializeAccountInfo),\n/* harmony export */   serializeAccountInput: () => (/* binding */ serializeAccountInput),\n/* harmony export */   serializeDappInfo: () => (/* binding */ serializeDappInfo),\n/* harmony export */   serializeEntryFunctionArgument: () => (/* binding */ serializeEntryFunctionArgument),\n/* harmony export */   serializePublicKey: () => (/* binding */ serializePublicKey),\n/* harmony export */   serializeSignature: () => (/* binding */ serializeSignature),\n/* harmony export */   serializeTransactionPayloadInput: () => (/* binding */ serializeTransactionPayloadInput),\n/* harmony export */   serializeWalletRequest: () => (/* binding */ serializeWalletRequest),\n/* harmony export */   serializeWalletRequestWithArgs: () => (/* binding */ serializeWalletRequestWithArgs),\n/* harmony export */   serializeWalletResponse: () => (/* binding */ serializeWalletResponse),\n/* harmony export */   urlDecodeWalletRequest: () => (/* binding */ urlDecodeWalletRequest),\n/* harmony export */   urlEncodeWalletRequest: () => (/* binding */ urlEncodeWalletRequest)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n// src/base64.ts\nfunction base64ToBytes(base64) {\n  const binaryString = atob(base64);\n  return Uint8Array.from(binaryString, (m) => m.charCodeAt(0));\n}\nfunction bytesToBase64(bytes) {\n  const binaryString = String.fromCharCode(...bytes);\n  return btoa(binaryString);\n}\nfunction base64urlToBytes(base64) {\n  return base64ToBytes(base64.replace(/-/g, \"+\").replace(/_/g, \"/\"));\n}\nfunction bytesToBase64url(bytes) {\n  return bytesToBase64(bytes).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/=+$/, \"\");\n}\n\n// src/helpers.ts\n\nfunction chainIdToNetwork(chainId) {\n  switch (chainId) {\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.NetworkToChainId.mainnet:\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.MAINNET;\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.NetworkToChainId.testnet:\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.TESTNET;\n    default:\n      return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.DEVNET;\n  }\n}\nfunction isSupportedNetwork(network) {\n  return [_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.MAINNET, _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.TESTNET, _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Network.DEVNET].includes(network);\n}\n\n// src/WalletRequest.ts\n\n\n// src/shared/AccountAuthenticatorInput.ts\n\nfunction serializeAccountAuthenticatorInput(serializer, value) {\n  serializer.serialize(value.address);\n  serializer.serialize(value.authenticator);\n}\nfunction deserializeAccountAuthenticatorInput(deserializer) {\n  const address = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n  const authenticator = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator);\n  return { address, authenticator };\n}\n\n// src/shared/AccountInfo.ts\n\n\n// src/shared/PublicKey.ts\n\nfunction serializePublicKey(serializer, value) {\n  if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.Ed25519);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiEd25519PublicKey) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiEd25519);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AnyPublicKey) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.SingleKey);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiKey) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiKey);\n  } else {\n    throw new Error(\"Unexpected public key type\");\n  }\n  serializer.serialize(value);\n}\nfunction deserializePublicKey(deserializer) {\n  const signingScheme = deserializer.deserializeUleb128AsU32();\n  switch (signingScheme) {\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.Ed25519:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiEd25519:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiEd25519PublicKey);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.SingleKey:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AnyPublicKey);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiKey:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiKey);\n    default:\n      throw new Error(`Unknown signing scheme: ${signingScheme}`);\n  }\n}\n\n// src/shared/AccountInfo.ts\nfunction serializeAccountInfo(serializer, value) {\n  serializer.serialize(value.address);\n  serializePublicKey(serializer, value.publicKey);\n  serializer.serializeStr(value.name ?? \"\");\n}\nfunction deserializeAccountInfo(deserializer) {\n  const address = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n  const publicKey = deserializePublicKey(deserializer);\n  const name = deserializer.deserializeStr();\n  return {\n    address,\n    publicKey,\n    ...name.length > 0 ? { name } : void 0\n  };\n}\n\n// src/shared/AccountInput.ts\n\nfunction serializeAccountInput(serializer, value) {\n  serializer.serialize(value.address);\n  serializer.serializeBool(value.publicKey !== void 0);\n  if (value.publicKey) {\n    serializePublicKey(serializer, value.publicKey);\n  }\n}\nfunction deserializeAccountInput(deserializer) {\n  const address = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n  const hasPublicKey = deserializer.deserializeBool();\n  const publicKey = hasPublicKey ? deserializePublicKey(deserializer) : void 0;\n  return { address, publicKey };\n}\n\n// src/shared/DappInfo.ts\nfunction serializeDappInfo(serializer, value) {\n  serializer.serializeStr(value.domain);\n  serializer.serializeStr(value.name);\n  serializer.serializeBool(value.imageURI !== void 0);\n  if (value.imageURI !== void 0) {\n    serializer.serializeStr(value.imageURI);\n  }\n}\nfunction deserializeDappInfo(deserializer) {\n  const domain = deserializer.deserializeStr();\n  const name = deserializer.deserializeStr();\n  const hasImageUri = deserializer.deserializeBool();\n  const imageURI = hasImageUri ? deserializer.deserializeStr() : void 0;\n  return { domain, imageURI, name };\n}\n\n// src/shared/EntryFunctionArgument.ts\n\nvar EntryFunctionArgumentVariant = /* @__PURE__ */ ((EntryFunctionArgumentVariant2) => {\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"Undefined\"] = 0] = \"Undefined\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"Array\"] = 1] = \"Array\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"String\"] = 2] = \"String\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"Uint8Array\"] = 3] = \"Uint8Array\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"AccountAddress\"] = 4] = \"AccountAddress\";\n  EntryFunctionArgumentVariant2[EntryFunctionArgumentVariant2[\"FixedBytes\"] = 5] = \"FixedBytes\";\n  return EntryFunctionArgumentVariant2;\n})(EntryFunctionArgumentVariant || {});\nfunction serializeEntryFunctionArgument(serializer, argument) {\n  if (argument === void 0 || argument === null) {\n    serializer.serializeU32AsUleb128(0 /* Undefined */);\n    return;\n  }\n  if (Array.isArray(argument)) {\n    serializer.serializeU32AsUleb128(1 /* Array */);\n    serializer.serializeU32AsUleb128(argument.length);\n    for (const subArgument of argument) {\n      serializeEntryFunctionArgument(serializer, subArgument);\n    }\n    return;\n  }\n  if (typeof argument === \"string\" || typeof argument === \"number\" || typeof argument === \"boolean\" || typeof argument === \"bigint\") {\n    serializer.serializeU32AsUleb128(2 /* String */);\n    serializer.serializeStr(argument.toString());\n    return;\n  }\n  if (argument instanceof Uint8Array) {\n    serializer.serializeU32AsUleb128(3 /* Uint8Array */);\n    serializer.serializeBytes(argument);\n    return;\n  }\n  if (argument instanceof ArrayBuffer) {\n    serializer.serializeU32AsUleb128(3 /* Uint8Array */);\n    serializer.serializeBytes(new Uint8Array(argument));\n    return;\n  }\n  if (\"values\" in argument) {\n    serializer.serializeU32AsUleb128(1 /* Array */);\n    serializer.serializeU32AsUleb128(argument.values.length);\n    for (const subArgument of argument.values) {\n      serializeEntryFunctionArgument(serializer, subArgument);\n    }\n    return;\n  }\n  if (\"data\" in argument) {\n    serializer.serializeU32AsUleb128(4 /* AccountAddress */);\n    serializer.serialize(argument);\n    return;\n  }\n  if (argument.value === void 0) {\n    serializer.serializeU32AsUleb128(0 /* Undefined */);\n    serializer.serialize(argument);\n    return;\n  }\n  if (argument.value instanceof Uint8Array) {\n    serializer.serializeU32AsUleb128(5 /* FixedBytes */);\n    serializer.serializeBytes(argument.value);\n    return;\n  }\n  serializer.serializeU32AsUleb128(2 /* String */);\n  serializer.serializeStr(argument.value.toString());\n}\nfunction deserializeEntryFunctionArgument(deserializer) {\n  const variant = deserializer.deserializeUleb128AsU32();\n  switch (variant) {\n    case 0 /* Undefined */: {\n      return void 0;\n    }\n    case 1 /* Array */: {\n      const length = deserializer.deserializeUleb128AsU32();\n      const args = [];\n      for (let i = 0; i < length; i += 1) {\n        const argument = deserializeEntryFunctionArgument(deserializer);\n        args.push(argument);\n      }\n      return args;\n    }\n    case 3 /* Uint8Array */: {\n      return deserializer.deserializeBytes();\n    }\n    case 4 /* AccountAddress */: {\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n    }\n    case 2 /* String */: {\n      return deserializer.deserializeStr();\n    }\n    case 5 /* FixedBytes */: {\n      const bytes = deserializer.deserializeBytes();\n      return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.FixedBytes(bytes);\n    }\n    default: {\n      throw new Error(\"Unexpected variant\");\n    }\n  }\n}\n\n// src/shared/Signature.ts\n\nfunction serializeSignature(serializer, value) {\n  if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.Ed25519);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiEd25519Signature) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiEd25519);\n  } else if (value instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AnySignature) {\n    serializer.serializeU32AsUleb128(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.SingleKey);\n  } else {\n    throw new Error(\"Unexpected signature type\");\n  }\n  serializer.serialize(value);\n}\nfunction deserializeSignature(deserializer) {\n  const signingScheme = deserializer.deserializeUleb128AsU32();\n  switch (signingScheme) {\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.Ed25519:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.MultiEd25519:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.MultiEd25519Signature);\n    case _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.SigningScheme.SingleKey:\n      return deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AnySignature);\n    default:\n      throw new Error(`Unknown signing scheme: ${signingScheme}`);\n  }\n}\n\n// src/shared/TransactionPayloadInput.ts\n\nvar TransactionPayloadInputVariant = /* @__PURE__ */ ((TransactionPayloadInputVariant2) => {\n  TransactionPayloadInputVariant2[TransactionPayloadInputVariant2[\"EntryFunction\"] = 0] = \"EntryFunction\";\n  TransactionPayloadInputVariant2[TransactionPayloadInputVariant2[\"Script\"] = 1] = \"Script\";\n  TransactionPayloadInputVariant2[TransactionPayloadInputVariant2[\"Multisig\"] = 2] = \"Multisig\";\n  return TransactionPayloadInputVariant2;\n})(TransactionPayloadInputVariant || {});\nfunction serializeTypeArguments(serializer, typeArguments) {\n  serializer.serializeU32AsUleb128(typeArguments.length);\n  for (const typeArgument of typeArguments) {\n    const typeTag = typeof typeArgument === \"string\" ? (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.parseTypeTag)(typeArgument, { allowGenerics: true }) : typeArgument;\n    serializer.serialize(typeTag);\n  }\n}\nfunction deserializeTypeArguments(deserializer) {\n  const typeArguments = [];\n  const typeArgumentsLength = deserializer.deserializeUleb128AsU32();\n  for (let i = 0; i < typeArgumentsLength; i += 1) {\n    const typeTag = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TypeTag);\n    typeArguments.push(typeTag);\n  }\n  return typeArguments;\n}\nfunction serializeEntryFunctionArguments(serializer, functionArguments) {\n  serializer.serializeU32AsUleb128(functionArguments.length);\n  for (const functionArgument of functionArguments) {\n    serializeEntryFunctionArgument(serializer, functionArgument);\n  }\n}\nfunction deserializeEntryFunctionArguments(deserializer) {\n  const functionArgumentsLength = deserializer.deserializeUleb128AsU32();\n  const functionArguments = [];\n  for (let i = 0; i < functionArgumentsLength; i += 1) {\n    const functionArgument = deserializeEntryFunctionArgument(deserializer);\n    functionArguments.push(functionArgument);\n  }\n  return functionArguments;\n}\nfunction serializeTransactionPayloadInput(serializer, value) {\n  if (\"multisigAddress\" in value) {\n    serializer.serializeU32AsUleb128(2 /* Multisig */);\n    serializer.serializeStr(value.function);\n    serializeEntryFunctionArguments(serializer, value.functionArguments);\n    serializeTypeArguments(serializer, value.typeArguments ?? []);\n    const multisigAddress = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress.from(value.multisigAddress);\n    serializer.serialize(multisigAddress);\n  } else if (\"function\" in value) {\n    serializer.serializeU32AsUleb128(0 /* EntryFunction */);\n    serializer.serializeStr(value.function);\n    serializeEntryFunctionArguments(serializer, value.functionArguments);\n    serializeTypeArguments(serializer, value.typeArguments ?? []);\n  } else {\n    serializer.serializeU32AsUleb128(1 /* Script */);\n    const bytecode = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(value.bytecode);\n    serializer.serializeBytes(bytecode.toUint8Array());\n    serializer.serializeU32AsUleb128(value.functionArguments.length);\n    for (const argument of value.functionArguments) {\n      argument.serializeForScriptFunction(serializer);\n    }\n    serializeTypeArguments(serializer, value.typeArguments ?? []);\n  }\n}\nfunction deserializeTransactionPayloadInput(deserializer) {\n  const variant = deserializer.deserializeUleb128AsU32();\n  switch (variant) {\n    case 2 /* Multisig */: {\n      const functionId = deserializer.deserializeStr();\n      const functionArguments = deserializeEntryFunctionArguments(deserializer);\n      const typeArguments = deserializeTypeArguments(deserializer);\n      const multisigAddress = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress);\n      return {\n        function: functionId,\n        functionArguments,\n        multisigAddress,\n        typeArguments\n      };\n    }\n    case 0 /* EntryFunction */: {\n      const functionId = deserializer.deserializeStr();\n      const functionArguments = deserializeEntryFunctionArguments(deserializer);\n      const typeArguments = deserializeTypeArguments(deserializer);\n      return {\n        function: functionId,\n        functionArguments,\n        typeArguments\n      };\n    }\n    case 1 /* Script */: {\n      const bytecode = deserializer.deserializeBytes();\n      const functionArgumentsLength = deserializer.deserializeUleb128AsU32();\n      const functionArguments = [];\n      for (let i = 0; i < functionArgumentsLength; i += 1) {\n        const argument = (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.deserializeFromScriptArgument)(deserializer);\n        functionArguments.push(argument);\n      }\n      const typeArguments = deserializeTypeArguments(deserializer);\n      return {\n        bytecode,\n        functionArguments,\n        typeArguments\n      };\n    }\n    default: {\n      throw new Error(\"Unexpected variant\");\n    }\n  }\n}\n\n// src/WalletRequest.ts\nfunction serializeWalletRequest({\n  dappInfo,\n  name,\n  version\n}) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializeDappInfo(serializer, dappInfo);\n  const data = serializer.toUint8Array();\n  return { data, name, version };\n}\nfunction deserializeWalletRequest({\n  data,\n  name,\n  version\n}) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(data);\n  const dappInfo = deserializeDappInfo(deserializer);\n  return { dappInfo, name, version };\n}\nfunction serializeWalletRequestWithArgs({ args, dappInfo, name, version }, serializeArgsFn) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializeDappInfo(serializer, dappInfo);\n  serializeArgsFn(serializer, args);\n  const data = serializer.toUint8Array();\n  return { data, name, version };\n}\nfunction deserializeWalletRequestWithArgs({ data, name, version }, deserializeArgsFn) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(data);\n  const dappInfo = deserializeDappInfo(deserializer);\n  const args = deserializeArgsFn(deserializer);\n  return { args, dappInfo, name, version };\n}\n\n// src/features/connect/request.ts\nvar ConnectRequest;\n((ConnectRequest2) => {\n  ConnectRequest2.name = \"connect\";\n  ConnectRequest2.supportedVersions = [1, 2, 3];\n  ConnectRequest2.currentVersion = 3;\n  function serializeArgs(serializer, value) {\n    serializer.serializeOptionStr(value.dappId);\n    serializer.serializeOptionStr(value.dappEd25519PublicKeyB64);\n    if (value.preferredWalletName) {\n      serializer.serializeOptionStr(value.preferredWalletName);\n    }\n  }\n  ConnectRequest2.serializeArgs = serializeArgs;\n  function deserializeArgs(deserializer, version) {\n    if (version === 1) {\n      return {};\n    }\n    const dappId = deserializer.deserializeOptionStr();\n    const dappEd25519PublicKeyB64 = deserializer.deserializeOptionStr();\n    const preferredWalletName = version >= 3 ? deserializer.deserializeOptionStr() : void 0;\n    return { dappEd25519PublicKeyB64, dappId, preferredWalletName };\n  }\n  ConnectRequest2.deserializeArgs = deserializeArgs;\n  function serialize(dappInfo, args = {}) {\n    const version = args.preferredWalletName ? 3 : 2;\n    return serializeWalletRequestWithArgs({ args, dappInfo, name: ConnectRequest2.name, version }, serializeArgs);\n  }\n  ConnectRequest2.serialize = serialize;\n  function deserialize(request) {\n    return deserializeWalletRequestWithArgs(request, (d) => deserializeArgs(d, request.version));\n  }\n  ConnectRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === ConnectRequest2.name && ConnectRequest2.supportedVersions.includes(request.version);\n  }\n  ConnectRequest2.isSerialized = isSerialized;\n})(ConnectRequest || (ConnectRequest = {}));\n\n// src/UserResponse.ts\nfunction makeUserApproval(args) {\n  return { args, status: \"approved\" };\n}\nfunction makeUserResponseSerializeFn(serializeArgs) {\n  return (serializer, value) => {\n    serializer.serializeBool(value.status === \"approved\");\n    if (value.status === \"approved\") {\n      serializeArgs(serializer, value.args);\n    }\n  };\n}\nfunction makeUserResponseDeserializeFn(deserializeArgs) {\n  return (deserializer) => {\n    const isApproved = deserializer.deserializeBool();\n    return isApproved ? { args: deserializeArgs(deserializer), status: \"approved\" } : { status: \"dismissed\" };\n  };\n}\n\n// src/WalletResponse.ts\n\nfunction serializeWalletResponse(args, serializeFn) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializeFn(serializer, args);\n  const data = serializer.toUint8Array();\n  return { data };\n}\nfunction deserializeWalletResponse({ data }, deserializeFn) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(data);\n  const args = deserializeFn(deserializer);\n  return { args };\n}\n\n// src/features/connect/response.ts\nvar ConnectResponse;\n((ConnectResponse2) => {\n  ConnectResponse2.supportedVersions = [1, 2];\n  ConnectResponse2.currentVersion = 2;\n  function serializeApprovalArgsV1(serializer, value) {\n    serializeAccountInfo(serializer, value.account);\n  }\n  function serializeApprovalArgs(serializer, value) {\n    serializeAccountInfo(serializer, value.account);\n    serializer.serializeOptionStr(value.pairing !== void 0 ? JSON.stringify(value.pairing) : void 0);\n  }\n  function deserializeApprovalArgs(deserializer) {\n    const account = deserializeAccountInfo(deserializer);\n    const serializedPairing = deserializer.deserializeOptionStr();\n    const pairing = serializedPairing !== void 0 ? JSON.parse(serializedPairing) : void 0;\n    return { account, pairing };\n  }\n  const serializeArgsV1 = makeUserResponseSerializeFn(serializeApprovalArgsV1);\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n  function serialize(args, version = ConnectResponse2.currentVersion) {\n    return serializeWalletResponse(args, version === 1 ? serializeArgsV1 : serializeArgs);\n  }\n  ConnectResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  ConnectResponse2.deserialize = deserialize;\n})(ConnectResponse || (ConnectResponse = {}));\n\n// src/features/disconnect/request.ts\nvar DisconnectRequest;\n((DisconnectRequest2) => {\n  DisconnectRequest2.name = \"disconnect\";\n  DisconnectRequest2.currentVersion = 1;\n  function serialize(dappInfo) {\n    return serializeWalletRequest({ dappInfo, name: DisconnectRequest2.name, version: DisconnectRequest2.currentVersion });\n  }\n  DisconnectRequest2.serialize = serialize;\n  function deserialize(request) {\n    return deserializeWalletRequest(request);\n  }\n  DisconnectRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === DisconnectRequest2.name && request.version === DisconnectRequest2.currentVersion;\n  }\n  DisconnectRequest2.isSerialized = isSerialized;\n})(DisconnectRequest || (DisconnectRequest = {}));\n\n// src/features/disconnect/response.ts\nvar DisconnectResponse;\n((DisconnectResponse2) => {\n  function serialize(args) {\n    return serializeWalletResponse(args, () => {\n    });\n  }\n  DisconnectResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, () => ({}));\n  }\n  DisconnectResponse2.deserialize = deserialize;\n})(DisconnectResponse || (DisconnectResponse = {}));\n\n// src/features/getConnectedAccounts/request.ts\nvar GetConnectedAccountsRequest;\n((GetConnectedAccountsRequest2) => {\n  GetConnectedAccountsRequest2.name = \"getConnectedAccounts\";\n  GetConnectedAccountsRequest2.currentVersion = 1;\n  function serialize(dappInfo) {\n    return serializeWalletRequest({ dappInfo, name: GetConnectedAccountsRequest2.name, version: GetConnectedAccountsRequest2.currentVersion });\n  }\n  GetConnectedAccountsRequest2.serialize = serialize;\n  function deserialize(request) {\n    return deserializeWalletRequest(request);\n  }\n  GetConnectedAccountsRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === GetConnectedAccountsRequest2.name && request.version === GetConnectedAccountsRequest2.currentVersion;\n  }\n  GetConnectedAccountsRequest2.isSerialized = isSerialized;\n})(GetConnectedAccountsRequest || (GetConnectedAccountsRequest = {}));\n\n// src/features/getConnectedAccounts/response.ts\nvar GetConnectedAccountsResponse;\n((GetConnectedAccountsResponse2) => {\n  function serializeArgs(serializer, args) {\n    serializer.serializeU32AsUleb128(args.length);\n    for (const account of args) {\n      serializeAccountInfo(serializer, account);\n    }\n  }\n  function deserializeArgs(deserializer) {\n    const length = deserializer.deserializeUleb128AsU32();\n    const accounts = [];\n    for (let i = 0; i < length; i += 1) {\n      accounts.push(deserializeAccountInfo(deserializer));\n    }\n    return accounts;\n  }\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  GetConnectedAccountsResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  GetConnectedAccountsResponse2.deserialize = deserialize;\n})(GetConnectedAccountsResponse || (GetConnectedAccountsResponse = {}));\n\n// src/features/isConnected/request.ts\nvar IsConnectedRequest;\n((IsConnectedRequest2) => {\n  IsConnectedRequest2.name = \"isConnected\";\n  IsConnectedRequest2.currentVersion = 1;\n  function serialize(dappInfo) {\n    return serializeWalletRequest({ dappInfo, name: IsConnectedRequest2.name, version: IsConnectedRequest2.currentVersion });\n  }\n  IsConnectedRequest2.serialize = serialize;\n  function deserialize(request) {\n    return deserializeWalletRequest(request);\n  }\n  IsConnectedRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === IsConnectedRequest2.name && request.version === IsConnectedRequest2.currentVersion;\n  }\n  IsConnectedRequest2.isSerialized = isSerialized;\n})(IsConnectedRequest || (IsConnectedRequest = {}));\n\n// src/features/isConnected/response.ts\nvar IsConnectedResponse;\n((IsConnectedResponse2) => {\n  function serializeArgs(serializer, value) {\n    serializer.serializeBool(value);\n  }\n  function deserializeArgs(deserializer) {\n    return deserializer.deserializeBool();\n  }\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  IsConnectedResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  IsConnectedResponse2.deserialize = deserialize;\n})(IsConnectedResponse || (IsConnectedResponse = {}));\n\n// src/features/signAndSubmitTransaction/request.ts\n\nvar SignAndSubmitTransactionRequest;\n((SignAndSubmitTransactionRequest2) => {\n  SignAndSubmitTransactionRequest2.name = \"signAndSubmitTransaction\";\n  SignAndSubmitTransactionRequest2.supportedVersions = [1, 2, 3];\n  SignAndSubmitTransactionRequest2.currentVersion = 3;\n  function serializeArgs(serializer, value) {\n    if (value.network !== void 0 && !isSupportedNetwork(value.network)) {\n      throw new Error(`Unsupported network '${value.network}'`);\n    }\n    serializer.serializeBool(value.signerAddress !== void 0);\n    if (value.signerAddress !== void 0) {\n      serializer.serialize(value.signerAddress);\n    }\n    serializer.serializeOptionStr(value.network);\n    if (\"bcsToBytes\" in value.payload) {\n      serializer.serializeBool(true);\n      serializer.serialize(value.payload);\n    } else {\n      serializer.serializeBool(false);\n      serializeTransactionPayloadInput(serializer, value.payload);\n    }\n    serializer.serializeU64(value.expirationTimestamp ?? 0);\n    serializer.serializeU32AsUleb128(value.gasUnitPrice ?? 0);\n    serializer.serializeU32AsUleb128(value.maxGasAmount ?? 0);\n    serializer.serializeU32AsUleb128(value.feePayer ? 1 : 0);\n    if (value.feePayer) {\n      serializeAccountAuthenticatorInput(serializer, value.feePayer);\n    }\n  }\n  SignAndSubmitTransactionRequest2.serializeArgs = serializeArgs;\n  function deserializeArgs(deserializer, version) {\n    const hasSignerAddress = version >= 3 && deserializer.deserializeBool();\n    const signerAddress = hasSignerAddress ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress) : void 0;\n    const network = version === 1 ? deserializer.deserializeStr() : deserializer.deserializeOptionStr();\n    if (network !== void 0 && !isSupportedNetwork(network)) {\n      throw new Error(`Unsupported network '${network}'`);\n    }\n    const isPayloadBcsSerializable = version === 1 || deserializer.deserializeBool();\n    const payload = isPayloadBcsSerializable ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload) : deserializeTransactionPayloadInput(deserializer);\n    const expirationTimestamp = Number(deserializer.deserializeU64());\n    const gasUnitPrice = deserializer.deserializeUleb128AsU32();\n    const maxGasAmount = deserializer.deserializeUleb128AsU32();\n    const hasFeePayer = deserializer.deserializeUleb128AsU32();\n    const feePayer = hasFeePayer ? deserializeAccountAuthenticatorInput(deserializer) : void 0;\n    return {\n      expirationTimestamp: expirationTimestamp > 0 ? expirationTimestamp : void 0,\n      feePayer,\n      gasUnitPrice: gasUnitPrice > 0 ? gasUnitPrice : void 0,\n      maxGasAmount: maxGasAmount > 0 ? maxGasAmount : void 0,\n      network,\n      payload,\n      signerAddress\n    };\n  }\n  SignAndSubmitTransactionRequest2.deserializeArgs = deserializeArgs;\n  function serialize(dappInfo, args) {\n    const request = { args, dappInfo, name: SignAndSubmitTransactionRequest2.name, version: SignAndSubmitTransactionRequest2.currentVersion };\n    return serializeWalletRequestWithArgs(request, serializeArgs);\n  }\n  SignAndSubmitTransactionRequest2.serialize = serialize;\n  function deserialize(serializedRequest) {\n    return deserializeWalletRequestWithArgs(\n      serializedRequest,\n      (deserializer) => deserializeArgs(deserializer, serializedRequest.version)\n    );\n  }\n  SignAndSubmitTransactionRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === SignAndSubmitTransactionRequest2.name && SignAndSubmitTransactionRequest2.supportedVersions.includes(request.version);\n  }\n  SignAndSubmitTransactionRequest2.isSerialized = isSerialized;\n})(SignAndSubmitTransactionRequest || (SignAndSubmitTransactionRequest = {}));\n\n// src/features/signAndSubmitTransaction/response.ts\nvar SignAndSubmitTransactionResponse;\n((SignAndSubmitTransactionResponse2) => {\n  function serializeApprovalArgs(serializer, value) {\n    serializer.serializeStr(value.txnHash);\n  }\n  function deserializeApprovalArgs(deserializer) {\n    const txnHash = deserializer.deserializeStr();\n    return { txnHash };\n  }\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  SignAndSubmitTransactionResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  SignAndSubmitTransactionResponse2.deserialize = deserialize;\n})(SignAndSubmitTransactionResponse || (SignAndSubmitTransactionResponse = {}));\n\n// src/features/signMessage/request.ts\n\nvar SignMessageRequest;\n((SignMessageRequest2) => {\n  SignMessageRequest2.name = \"signMessage\";\n  SignMessageRequest2.supportedVersions = [1, 2];\n  SignMessageRequest2.currentVersion = 2;\n  function serializeArgs(serializer, value) {\n    serializer.serializeBool(value.signerAddress !== void 0);\n    if (value.signerAddress !== void 0) {\n      serializer.serialize(value.signerAddress);\n    }\n    serializer.serializeU8(value.chainId);\n    serializer.serializeBytes(value.nonce);\n    serializer.serializeBytes(value.message);\n  }\n  function deserializeArgs(deserializer, version) {\n    const hasSignerAddress = version >= 2 && deserializer.deserializeBool();\n    const signerAddress = hasSignerAddress ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress) : void 0;\n    const chainId = deserializer.deserializeU8();\n    const nonce = deserializer.deserializeBytes();\n    const message = deserializer.deserializeBytes();\n    return { chainId, message, nonce, signerAddress };\n  }\n  function serialize(dappInfo, args) {\n    const request = { args, dappInfo, name: SignMessageRequest2.name, version: SignMessageRequest2.currentVersion };\n    return serializeWalletRequestWithArgs(request, serializeArgs);\n  }\n  SignMessageRequest2.serialize = serialize;\n  function deserialize(serializedRequest) {\n    return deserializeWalletRequestWithArgs(serializedRequest, (d) => deserializeArgs(d, serializedRequest.version));\n  }\n  SignMessageRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === SignMessageRequest2.name && request.version === SignMessageRequest2.currentVersion;\n  }\n  SignMessageRequest2.isSerialized = isSerialized;\n})(SignMessageRequest || (SignMessageRequest = {}));\n\n// src/features/signMessage/response.ts\nvar SignMessageResponse;\n((SignMessageResponse2) => {\n  function serializeApprovalArgs(serializer, value) {\n    serializer.serializeStr(value.fullMessage);\n    serializeSignature(serializer, value.signature);\n  }\n  function deserializeApprovalArgs(deserializer) {\n    const fullMessage = deserializer.deserializeStr();\n    const signature = deserializeSignature(deserializer);\n    return { fullMessage, signature };\n  }\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  SignMessageResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  SignMessageResponse2.deserialize = deserialize;\n})(SignMessageResponse || (SignMessageResponse = {}));\n\n// src/features/signTransaction/request.ts\n\nvar SignTransactionRequest;\n((SignTransactionRequest2) => {\n  SignTransactionRequest2.name = \"signTransaction\";\n  SignTransactionRequest2.supportedVersions = [1, 2, 3, 4];\n  SignTransactionRequest2.currentVersion = 4;\n  function normalizeArgs(args) {\n    const { feePayer, secondarySigners, senderPublicKey, signerAddress, transaction } = args;\n    const sender = {\n      address: transaction.sender,\n      publicKey: senderPublicKey\n    };\n    const network = chainIdToNetwork(args.transaction.chain_id.chainId);\n    return {\n      expirationTimestamp: Number(transaction.expiration_timestamp_secs),\n      feePayer,\n      gasUnitPrice: Number(transaction.gas_unit_price),\n      maxGasAmount: Number(transaction.max_gas_amount),\n      network,\n      payload: transaction.payload,\n      secondarySigners,\n      sender,\n      signerAddress\n    };\n  }\n  SignTransactionRequest2.normalizeArgs = normalizeArgs;\n  function serializeArgs(serializer, value) {\n    if (value.network !== void 0 && !isSupportedNetwork(value.network)) {\n      throw new Error(`Unsupported network '${value.network}'`);\n    }\n    serializer.serializeBool(value.signerAddress !== void 0);\n    if (value.signerAddress !== void 0) {\n      serializer.serialize(value.signerAddress);\n    }\n    serializer.serializeOptionStr(value.network);\n    serializer.serializeBool(value.sender !== void 0);\n    if (value.sender !== void 0) {\n      serializeAccountInput(serializer, value.sender);\n    }\n    if (\"bcsToBytes\" in value.payload) {\n      serializer.serializeBool(true);\n      serializer.serialize(value.payload);\n    } else {\n      serializer.serializeBool(false);\n      serializeTransactionPayloadInput(serializer, value.payload);\n    }\n    serializer.serializeU32AsUleb128(value.expirationSecondsFromNow ?? 0);\n    serializer.serializeU64(value.expirationTimestamp ?? 0);\n    serializer.serializeU32AsUleb128(value.gasUnitPrice ?? 0);\n    serializer.serializeU32AsUleb128(value.maxGasAmount ?? 0);\n    serializer.serializeBool(value.feePayer !== void 0);\n    if (value.feePayer !== void 0) {\n      serializeAccountInput(serializer, value.feePayer);\n    }\n    const secondarySigners = value.secondarySigners ?? [];\n    serializer.serializeU32AsUleb128(secondarySigners.length);\n    for (const signer of secondarySigners) {\n      serializeAccountInput(serializer, signer);\n    }\n  }\n  function deserializeArgs(deserializer, version) {\n    const hasSignerAddress = version >= 3 && deserializer.deserializeBool();\n    const signerAddress = hasSignerAddress ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress) : void 0;\n    const network = version === 1 ? deserializer.deserializeStr() : deserializer.deserializeOptionStr();\n    if (network !== void 0 && !isSupportedNetwork(network)) {\n      throw new Error(`Unsupported network '${network}'`);\n    }\n    const hasSender = deserializer.deserializeBool();\n    const sender = hasSender ? deserializeAccountInput(deserializer) : void 0;\n    const isPayloadBcsSerializable = version < 4 || deserializer.deserializeBool();\n    const payload = isPayloadBcsSerializable ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload) : deserializeTransactionPayloadInput(deserializer);\n    const expirationSecondsFromNow = deserializer.deserializeUleb128AsU32();\n    const expirationTimestamp = Number(deserializer.deserializeU64());\n    const gasUnitPrice = deserializer.deserializeUleb128AsU32();\n    const maxGasAmount = deserializer.deserializeUleb128AsU32();\n    const hasFeePayer = deserializer.deserializeBool();\n    const feePayer = hasFeePayer ? deserializeAccountInput(deserializer) : void 0;\n    const secondarySignersLength = deserializer.deserializeUleb128AsU32();\n    const secondarySigners = [];\n    for (let i = 0; i < secondarySignersLength; i += 1) {\n      secondarySigners.push(deserializeAccountInput(deserializer));\n    }\n    return {\n      expirationSecondsFromNow: expirationSecondsFromNow > 0 ? expirationSecondsFromNow : void 0,\n      expirationTimestamp: expirationTimestamp > 0 ? expirationTimestamp : void 0,\n      feePayer,\n      gasUnitPrice: gasUnitPrice > 0 ? gasUnitPrice : void 0,\n      maxGasAmount: maxGasAmount > 0 ? maxGasAmount : void 0,\n      network,\n      payload,\n      secondarySigners,\n      sender,\n      signerAddress\n    };\n  }\n  function serialize(dappInfo, args) {\n    const request = { args, dappInfo, name: SignTransactionRequest2.name, version: SignTransactionRequest2.currentVersion };\n    return serializeWalletRequestWithArgs(request, serializeArgs);\n  }\n  SignTransactionRequest2.serialize = serialize;\n  function deserialize(serializedRequest) {\n    return deserializeWalletRequestWithArgs(\n      serializedRequest,\n      (deserializer) => deserializeArgs(deserializer, serializedRequest.version)\n    );\n  }\n  SignTransactionRequest2.deserialize = deserialize;\n  function isSerialized(request) {\n    return request.name === SignTransactionRequest2.name && SignTransactionRequest2.supportedVersions.includes(request.version);\n  }\n  SignTransactionRequest2.isSerialized = isSerialized;\n})(SignTransactionRequest || (SignTransactionRequest = {}));\n\n// src/features/signTransaction/response.ts\n\nvar SignTransactionResponse;\n((SignTransactionResponse2) => {\n  function serializeApprovalArgs(serializer, value) {\n    serializer.serialize(value.authenticator);\n    serializer.serializeBool(value.rawTransaction !== void 0);\n    if (value.rawTransaction !== void 0) {\n      serializer.serialize(value.rawTransaction);\n    }\n  }\n  function deserializeApprovalArgs(deserializer) {\n    const authenticator = deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator);\n    const hasRawTransaction = deserializer.deserializeBool();\n    const rawTransaction = hasRawTransaction ? deserializer.deserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransaction) : void 0;\n    return {\n      authenticator,\n      rawTransaction\n    };\n  }\n  const serializeArgs = makeUserResponseSerializeFn(serializeApprovalArgs);\n  const deserializeArgs = makeUserResponseDeserializeFn(deserializeApprovalArgs);\n  function serialize(args) {\n    return serializeWalletResponse(args, serializeArgs);\n  }\n  SignTransactionResponse2.serialize = serialize;\n  function deserialize(serializedResponse) {\n    return deserializeWalletResponse(serializedResponse, deserializeArgs);\n  }\n  SignTransactionResponse2.deserialize = deserialize;\n})(SignTransactionResponse || (SignTransactionResponse = {}));\n\n// src/messages/common.ts\nfunction isTypedMessage(messageCls, message) {\n  return message?.__messageType === messageCls.TYPE;\n}\n\n// src/messages/background.ts\nvar _AptosWalletRequestMessage = class _AptosWalletRequestMessage {\n  constructor(nonce, serializedValue) {\n    this.nonce = nonce;\n    this.serializedValue = serializedValue;\n    this.__messageType = _AptosWalletRequestMessage.TYPE;\n  }\n};\n_AptosWalletRequestMessage.TYPE = \"AptosWalletRequest\";\nvar AptosWalletRequestMessage = _AptosWalletRequestMessage;\nvar _AptosWalletSuccessResponseMessage = class _AptosWalletSuccessResponseMessage {\n  constructor(serializedValue, nonce) {\n    this.serializedValue = serializedValue;\n    this.nonce = nonce;\n    this.__messageType = _AptosWalletSuccessResponseMessage.TYPE;\n  }\n};\n_AptosWalletSuccessResponseMessage.TYPE = \"AptosWalletSuccessResponseMessage\";\nvar AptosWalletSuccessResponseMessage = _AptosWalletSuccessResponseMessage;\nvar _AptosWalletErrorResponseMessage = class _AptosWalletErrorResponseMessage {\n  constructor(error, nonce) {\n    this.error = error;\n    this.nonce = nonce;\n    this.__messageType = _AptosWalletErrorResponseMessage.TYPE;\n  }\n};\n_AptosWalletErrorResponseMessage.TYPE = \"AptosWalletErrorResponseMessage\";\nvar AptosWalletErrorResponseMessage = _AptosWalletErrorResponseMessage;\nfunction isAptosWalletResponseMessage(message) {\n  return isTypedMessage(AptosWalletSuccessResponseMessage, message) || isTypedMessage(AptosWalletErrorResponseMessage, message);\n}\n\n// src/messages/prompt.ts\n\nvar _PromptOpenerPingRequestMessage = class _PromptOpenerPingRequestMessage {\n  constructor() {\n    this.__messageType = _PromptOpenerPingRequestMessage.TYPE;\n  }\n};\n_PromptOpenerPingRequestMessage.TYPE = \"PromptOpenerPingRequest\";\nvar PromptOpenerPingRequestMessage = _PromptOpenerPingRequestMessage;\nvar _PromptOpenerPingResponseMessage = class _PromptOpenerPingResponseMessage {\n  constructor() {\n    this.__messageType = _PromptOpenerPingResponseMessage.TYPE;\n  }\n};\n_PromptOpenerPingResponseMessage.TYPE = \"PromptOpenerPingResponse\";\nvar PromptOpenerPingResponseMessage = _PromptOpenerPingResponseMessage;\nvar _PromptApprovalResponseMessage = class _PromptApprovalResponseMessage {\n  constructor(serializedValue) {\n    this.serializedValue = serializedValue;\n    this.__messageType = _PromptApprovalResponseMessage.TYPE;\n  }\n};\n_PromptApprovalResponseMessage.TYPE = \"PromptApprovalResponse\";\nvar PromptApprovalResponseMessage = _PromptApprovalResponseMessage;\nvar _PromptUnauthorizedErrorMessage = class _PromptUnauthorizedErrorMessage {\n  constructor() {\n    this.__messageType = _PromptUnauthorizedErrorMessage.TYPE;\n  }\n};\n_PromptUnauthorizedErrorMessage.TYPE = \"PromptUnauthorizedError\";\nvar PromptUnauthorizedErrorMessage = _PromptUnauthorizedErrorMessage;\nfunction urlEncodeWalletRequest(request) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializer.serializeStr(request.name);\n  serializer.serializeBytes(request.data);\n  serializer.serializeStr(request.version.toString());\n  return bytesToBase64(serializer.toUint8Array());\n}\nfunction urlDecodeWalletRequest(encodedRequest) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(base64ToBytes(encodedRequest));\n  const name = deserializer.deserializeStr();\n  const data = deserializer.deserializeBytes();\n  let version;\n  try {\n    version = Number(deserializer.deserializeStr());\n  } catch {\n    version = 1;\n  }\n  return { data, name, version };\n}\n\n// src/PopupWalletRequest.ts\n\n\n// src/WalletRequestBody.ts\nfunction encodeWalletRequestBody({ data, ...rest }) {\n  const serialized = JSON.stringify({ data, ...rest }, (key, value) => key === \"data\" ? bytesToBase64(value) : value);\n  const utf8Encoded = new TextEncoder().encode(serialized);\n  return bytesToBase64(utf8Encoded);\n}\nfunction decodeWalletRequestBody(encoded) {\n  const utfEncoded = base64ToBytes(encoded);\n  const serialized = new TextDecoder().decode(utfEncoded);\n  return JSON.parse(serialized, (key, value) => key === \"data\" ? base64ToBytes(value) : value);\n}\n\n// src/PopupWalletRequest.ts\nfunction encodePopupWalletRequest(request) {\n  const serialized = JSON.stringify(request, (key, value) => {\n    switch (key) {\n      case \"body\":\n        return encodeWalletRequestBody(value);\n      case \"clientIdentityKey\":\n        return bytesToBase64(value.toUint8Array());\n      case \"signature\":\n        return bytesToBase64(value.toUint8Array());\n      default:\n        return value;\n    }\n  });\n  const utf8Encoded = new TextEncoder().encode(serialized);\n  return bytesToBase64url(utf8Encoded);\n}\nfunction decodePopupWalletRequest(encoded) {\n  const utfEncoded = base64urlToBytes(encoded);\n  const serialized = new TextDecoder().decode(utfEncoded);\n  return JSON.parse(serialized, (key, value) => {\n    switch (key) {\n      case \"body\":\n        return decodeWalletRequestBody(value);\n      case \"clientIdentityKey\":\n        return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(base64ToBytes(value));\n      case \"signature\":\n        return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(base64ToBytes(value));\n      default:\n        return value;\n    }\n  });\n}\nfunction makePopupWalletRequestChallenge({\n  accountAddress,\n  body,\n  id,\n  timestamp\n}) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  serializer.serializeStr(\"SignedPopupWalletRequest\");\n  serializer.serializeStr(id);\n  serializer.serializeU64(timestamp);\n  serializer.serializeBool(accountAddress !== void 0);\n  if (accountAddress !== void 0) {\n    serializer.serialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAddress.from(accountAddress));\n  }\n  serializer.serializeStr(body.name);\n  serializer.serializeU8(body.version);\n  serializer.serializeBytes(body.data);\n  return serializer.toUint8Array();\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy9AYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpL2Rpc3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDK0Q7QUFDL0Q7QUFDQTtBQUNBLFNBQVMsZ0VBQWdCO0FBQ3pCLGFBQWEsdURBQU87QUFDcEIsU0FBUyxnRUFBZ0I7QUFDekIsYUFBYSx1REFBTztBQUNwQjtBQUNBLGFBQWEsdURBQU87QUFDcEI7QUFDQTtBQUNBO0FBQ0EsVUFBVSx1REFBTyxVQUFVLHVEQUFPLFVBQVUsdURBQU87QUFDbkQ7O0FBRUE7QUFDOEY7O0FBRTlGO0FBQzBFO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsOERBQWM7QUFDekQsaURBQWlELG9FQUFvQjtBQUNyRSxXQUFXO0FBQ1g7O0FBRUE7QUFDdUU7O0FBRXZFO0FBTzRCO0FBQzVCO0FBQ0EsdUJBQXVCLGdFQUFnQjtBQUN2QyxxQ0FBcUMsNkRBQWE7QUFDbEQsSUFBSSwwQkFBMEIscUVBQXFCO0FBQ25ELHFDQUFxQyw2REFBYTtBQUNsRCxJQUFJLDBCQUEwQiw0REFBWTtBQUMxQyxxQ0FBcUMsNkRBQWE7QUFDbEQsSUFBSSwwQkFBMEIsd0RBQVE7QUFDdEMscUNBQXFDLDZEQUFhO0FBQ2xELElBQUk7QUFDSjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsNkRBQWE7QUFDdEIsc0NBQXNDLGdFQUFnQjtBQUN0RCxTQUFTLDZEQUFhO0FBQ3RCLHNDQUFzQyxxRUFBcUI7QUFDM0QsU0FBUyw2REFB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFpRUU7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL25leHRqcy1ib2lsZXJwbGF0ZS10ZW1wbGF0ZS8uL25vZGVfbW9kdWxlcy9AYXB0b3MtY29ubmVjdC93YWxsZXQtYWRhcHRlci1wbHVnaW4vbm9kZV9tb2R1bGVzL0BhcHRvcy1jb25uZWN0L3dhbGxldC1hcGkvZGlzdC9pbmRleC5tanM/Y2Q3NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvYmFzZTY0LnRzXG5mdW5jdGlvbiBiYXNlNjRUb0J5dGVzKGJhc2U2NCkge1xuICBjb25zdCBiaW5hcnlTdHJpbmcgPSBhdG9iKGJhc2U2NCk7XG4gIHJldHVybiBVaW50OEFycmF5LmZyb20oYmluYXJ5U3RyaW5nLCAobSkgPT4gbS5jaGFyQ29kZUF0KDApKTtcbn1cbmZ1bmN0aW9uIGJ5dGVzVG9CYXNlNjQoYnl0ZXMpIHtcbiAgY29uc3QgYmluYXJ5U3RyaW5nID0gU3RyaW5nLmZyb21DaGFyQ29kZSguLi5ieXRlcyk7XG4gIHJldHVybiBidG9hKGJpbmFyeVN0cmluZyk7XG59XG5mdW5jdGlvbiBiYXNlNjR1cmxUb0J5dGVzKGJhc2U2NCkge1xuICByZXR1cm4gYmFzZTY0VG9CeXRlcyhiYXNlNjQucmVwbGFjZSgvLS9nLCBcIitcIikucmVwbGFjZSgvXy9nLCBcIi9cIikpO1xufVxuZnVuY3Rpb24gYnl0ZXNUb0Jhc2U2NHVybChieXRlcykge1xuICByZXR1cm4gYnl0ZXNUb0Jhc2U2NChieXRlcykucmVwbGFjZSgvXFwrL2csIFwiLVwiKS5yZXBsYWNlKC9cXC8vZywgXCJfXCIpLnJlcGxhY2UoLz0rJC8sIFwiXCIpO1xufVxuXG4vLyBzcmMvaGVscGVycy50c1xuaW1wb3J0IHsgTmV0d29yaywgTmV0d29ya1RvQ2hhaW5JZCB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmZ1bmN0aW9uIGNoYWluSWRUb05ldHdvcmsoY2hhaW5JZCkge1xuICBzd2l0Y2ggKGNoYWluSWQpIHtcbiAgICBjYXNlIE5ldHdvcmtUb0NoYWluSWQubWFpbm5ldDpcbiAgICAgIHJldHVybiBOZXR3b3JrLk1BSU5ORVQ7XG4gICAgY2FzZSBOZXR3b3JrVG9DaGFpbklkLnRlc3RuZXQ6XG4gICAgICByZXR1cm4gTmV0d29yay5URVNUTkVUO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gTmV0d29yay5ERVZORVQ7XG4gIH1cbn1cbmZ1bmN0aW9uIGlzU3VwcG9ydGVkTmV0d29yayhuZXR3b3JrKSB7XG4gIHJldHVybiBbTmV0d29yay5NQUlOTkVULCBOZXR3b3JrLlRFU1RORVQsIE5ldHdvcmsuREVWTkVUXS5pbmNsdWRlcyhuZXR3b3JrKTtcbn1cblxuLy8gc3JjL1dhbGxldFJlcXVlc3QudHNcbmltcG9ydCB7IERlc2VyaWFsaXplciBhcyBEZXNlcmlhbGl6ZXI5LCBTZXJpYWxpemVyIGFzIFNlcmlhbGl6ZXI5IH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuXG4vLyBzcmMvc2hhcmVkL0FjY291bnRBdXRoZW50aWNhdG9ySW5wdXQudHNcbmltcG9ydCB7IEFjY291bnRBZGRyZXNzLCBBY2NvdW50QXV0aGVudGljYXRvciB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmZ1bmN0aW9uIHNlcmlhbGl6ZUFjY291bnRBdXRoZW50aWNhdG9ySW5wdXQoc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUuYWRkcmVzcyk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplKHZhbHVlLmF1dGhlbnRpY2F0b3IpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVBY2NvdW50QXV0aGVudGljYXRvcklucHV0KGRlc2VyaWFsaXplcikge1xuICBjb25zdCBhZGRyZXNzID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEFjY291bnRBZGRyZXNzKTtcbiAgY29uc3QgYXV0aGVudGljYXRvciA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBY2NvdW50QXV0aGVudGljYXRvcik7XG4gIHJldHVybiB7IGFkZHJlc3MsIGF1dGhlbnRpY2F0b3IgfTtcbn1cblxuLy8gc3JjL3NoYXJlZC9BY2NvdW50SW5mby50c1xuaW1wb3J0IHsgQWNjb3VudEFkZHJlc3MgYXMgQWNjb3VudEFkZHJlc3MyIH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuXG4vLyBzcmMvc2hhcmVkL1B1YmxpY0tleS50c1xuaW1wb3J0IHtcbiAgQW55UHVibGljS2V5LFxuICBFZDI1NTE5UHVibGljS2V5LFxuICBNdWx0aUVkMjU1MTlQdWJsaWNLZXksXG4gIE11bHRpS2V5LFxuICBTaWduaW5nU2NoZW1lXG59IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmZ1bmN0aW9uIHNlcmlhbGl6ZVB1YmxpY0tleShzZXJpYWxpemVyLCB2YWx1ZSkge1xuICBpZiAodmFsdWUgaW5zdGFuY2VvZiBFZDI1NTE5UHVibGljS2V5KSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoU2lnbmluZ1NjaGVtZS5FZDI1NTE5KTtcbiAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE11bHRpRWQyNTUxOVB1YmxpY0tleSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KFNpZ25pbmdTY2hlbWUuTXVsdGlFZDI1NTE5KTtcbiAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFueVB1YmxpY0tleSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KFNpZ25pbmdTY2hlbWUuU2luZ2xlS2V5KTtcbiAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIE11bHRpS2V5KSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoU2lnbmluZ1NjaGVtZS5NdWx0aUtleSk7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBwdWJsaWMga2V5IHR5cGVcIik7XG4gIH1cbiAgc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVQdWJsaWNLZXkoZGVzZXJpYWxpemVyKSB7XG4gIGNvbnN0IHNpZ25pbmdTY2hlbWUgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgc3dpdGNoIChzaWduaW5nU2NoZW1lKSB7XG4gICAgY2FzZSBTaWduaW5nU2NoZW1lLkVkMjU1MTk6XG4gICAgICByZXR1cm4gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEVkMjU1MTlQdWJsaWNLZXkpO1xuICAgIGNhc2UgU2lnbmluZ1NjaGVtZS5NdWx0aUVkMjU1MTk6XG4gICAgICByZXR1cm4gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKE11bHRpRWQyNTUxOVB1YmxpY0tleSk7XG4gICAgY2FzZSBTaWduaW5nU2NoZW1lLlNpbmdsZUtleTpcbiAgICAgIHJldHVybiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoQW55UHVibGljS2V5KTtcbiAgICBjYXNlIFNpZ25pbmdTY2hlbWUuTXVsdGlLZXk6XG4gICAgICByZXR1cm4gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKE11bHRpS2V5KTtcbiAgICBkZWZhdWx0OlxuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIHNpZ25pbmcgc2NoZW1lOiAke3NpZ25pbmdTY2hlbWV9YCk7XG4gIH1cbn1cblxuLy8gc3JjL3NoYXJlZC9BY2NvdW50SW5mby50c1xuZnVuY3Rpb24gc2VyaWFsaXplQWNjb3VudEluZm8oc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUuYWRkcmVzcyk7XG4gIHNlcmlhbGl6ZVB1YmxpY0tleShzZXJpYWxpemVyLCB2YWx1ZS5wdWJsaWNLZXkpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cih2YWx1ZS5uYW1lID8/IFwiXCIpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVBY2NvdW50SW5mbyhkZXNlcmlhbGl6ZXIpIHtcbiAgY29uc3QgYWRkcmVzcyA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBY2NvdW50QWRkcmVzczIpO1xuICBjb25zdCBwdWJsaWNLZXkgPSBkZXNlcmlhbGl6ZVB1YmxpY0tleShkZXNlcmlhbGl6ZXIpO1xuICBjb25zdCBuYW1lID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplU3RyKCk7XG4gIHJldHVybiB7XG4gICAgYWRkcmVzcyxcbiAgICBwdWJsaWNLZXksXG4gICAgLi4ubmFtZS5sZW5ndGggPiAwID8geyBuYW1lIH0gOiB2b2lkIDBcbiAgfTtcbn1cblxuLy8gc3JjL3NoYXJlZC9BY2NvdW50SW5wdXQudHNcbmltcG9ydCB7IEFjY291bnRBZGRyZXNzIGFzIEFjY291bnRBZGRyZXNzMyB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmZ1bmN0aW9uIHNlcmlhbGl6ZUFjY291bnRJbnB1dChzZXJpYWxpemVyLCB2YWx1ZSkge1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZS5hZGRyZXNzKTtcbiAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKHZhbHVlLnB1YmxpY0tleSAhPT0gdm9pZCAwKTtcbiAgaWYgKHZhbHVlLnB1YmxpY0tleSkge1xuICAgIHNlcmlhbGl6ZVB1YmxpY0tleShzZXJpYWxpemVyLCB2YWx1ZS5wdWJsaWNLZXkpO1xuICB9XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUFjY291bnRJbnB1dChkZXNlcmlhbGl6ZXIpIHtcbiAgY29uc3QgYWRkcmVzcyA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBY2NvdW50QWRkcmVzczMpO1xuICBjb25zdCBoYXNQdWJsaWNLZXkgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVCb29sKCk7XG4gIGNvbnN0IHB1YmxpY0tleSA9IGhhc1B1YmxpY0tleSA/IGRlc2VyaWFsaXplUHVibGljS2V5KGRlc2VyaWFsaXplcikgOiB2b2lkIDA7XG4gIHJldHVybiB7IGFkZHJlc3MsIHB1YmxpY0tleSB9O1xufVxuXG4vLyBzcmMvc2hhcmVkL0RhcHBJbmZvLnRzXG5mdW5jdGlvbiBzZXJpYWxpemVEYXBwSW5mbyhzZXJpYWxpemVyLCB2YWx1ZSkge1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cih2YWx1ZS5kb21haW4pO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cih2YWx1ZS5uYW1lKTtcbiAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKHZhbHVlLmltYWdlVVJJICE9PSB2b2lkIDApO1xuICBpZiAodmFsdWUuaW1hZ2VVUkkgIT09IHZvaWQgMCkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKHZhbHVlLmltYWdlVVJJKTtcbiAgfVxufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVEYXBwSW5mbyhkZXNlcmlhbGl6ZXIpIHtcbiAgY29uc3QgZG9tYWluID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplU3RyKCk7XG4gIGNvbnN0IG5hbWUgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKTtcbiAgY29uc3QgaGFzSW1hZ2VVcmkgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVCb29sKCk7XG4gIGNvbnN0IGltYWdlVVJJID0gaGFzSW1hZ2VVcmkgPyBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKSA6IHZvaWQgMDtcbiAgcmV0dXJuIHsgZG9tYWluLCBpbWFnZVVSSSwgbmFtZSB9O1xufVxuXG4vLyBzcmMvc2hhcmVkL0VudHJ5RnVuY3Rpb25Bcmd1bWVudC50c1xuaW1wb3J0IHtcbiAgQWNjb3VudEFkZHJlc3MgYXMgQWNjb3VudEFkZHJlc3M0LFxuICBGaXhlZEJ5dGVzXG59IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbnZhciBFbnRyeUZ1bmN0aW9uQXJndW1lbnRWYXJpYW50ID0gLyogQF9fUFVSRV9fICovICgoRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDIpID0+IHtcbiAgRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbXCJVbmRlZmluZWRcIl0gPSAwXSA9IFwiVW5kZWZpbmVkXCI7XG4gIEVudHJ5RnVuY3Rpb25Bcmd1bWVudFZhcmlhbnQyW0VudHJ5RnVuY3Rpb25Bcmd1bWVudFZhcmlhbnQyW1wiQXJyYXlcIl0gPSAxXSA9IFwiQXJyYXlcIjtcbiAgRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbXCJTdHJpbmdcIl0gPSAyXSA9IFwiU3RyaW5nXCI7XG4gIEVudHJ5RnVuY3Rpb25Bcmd1bWVudFZhcmlhbnQyW0VudHJ5RnVuY3Rpb25Bcmd1bWVudFZhcmlhbnQyW1wiVWludDhBcnJheVwiXSA9IDNdID0gXCJVaW50OEFycmF5XCI7XG4gIEVudHJ5RnVuY3Rpb25Bcmd1bWVudFZhcmlhbnQyW0VudHJ5RnVuY3Rpb25Bcmd1bWVudFZhcmlhbnQyW1wiQWNjb3VudEFkZHJlc3NcIl0gPSA0XSA9IFwiQWNjb3VudEFkZHJlc3NcIjtcbiAgRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudDJbXCJGaXhlZEJ5dGVzXCJdID0gNV0gPSBcIkZpeGVkQnl0ZXNcIjtcbiAgcmV0dXJuIEVudHJ5RnVuY3Rpb25Bcmd1bWVudFZhcmlhbnQyO1xufSkoRW50cnlGdW5jdGlvbkFyZ3VtZW50VmFyaWFudCB8fCB7fSk7XG5mdW5jdGlvbiBzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnQoc2VyaWFsaXplciwgYXJndW1lbnQpIHtcbiAgaWYgKGFyZ3VtZW50ID09PSB2b2lkIDAgfHwgYXJndW1lbnQgPT09IG51bGwpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCgwIC8qIFVuZGVmaW5lZCAqLyk7XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChBcnJheS5pc0FycmF5KGFyZ3VtZW50KSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KDEgLyogQXJyYXkgKi8pO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KGFyZ3VtZW50Lmxlbmd0aCk7XG4gICAgZm9yIChjb25zdCBzdWJBcmd1bWVudCBvZiBhcmd1bWVudCkge1xuICAgICAgc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZ3VtZW50KHNlcmlhbGl6ZXIsIHN1YkFyZ3VtZW50KTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmICh0eXBlb2YgYXJndW1lbnQgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGFyZ3VtZW50ID09PSBcIm51bWJlclwiIHx8IHR5cGVvZiBhcmd1bWVudCA9PT0gXCJib29sZWFuXCIgfHwgdHlwZW9mIGFyZ3VtZW50ID09PSBcImJpZ2ludFwiKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoMiAvKiBTdHJpbmcgKi8pO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKGFyZ3VtZW50LnRvU3RyaW5nKCkpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoYXJndW1lbnQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoMyAvKiBVaW50OEFycmF5ICovKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJ5dGVzKGFyZ3VtZW50KTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGFyZ3VtZW50IGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCgzIC8qIFVpbnQ4QXJyYXkgKi8pO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQnl0ZXMobmV3IFVpbnQ4QXJyYXkoYXJndW1lbnQpKTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKFwidmFsdWVzXCIgaW4gYXJndW1lbnQpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCgxIC8qIEFycmF5ICovKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOChhcmd1bWVudC52YWx1ZXMubGVuZ3RoKTtcbiAgICBmb3IgKGNvbnN0IHN1YkFyZ3VtZW50IG9mIGFyZ3VtZW50LnZhbHVlcykge1xuICAgICAgc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZ3VtZW50KHNlcmlhbGl6ZXIsIHN1YkFyZ3VtZW50KTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG4gIGlmIChcImRhdGFcIiBpbiBhcmd1bWVudCkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KDQgLyogQWNjb3VudEFkZHJlc3MgKi8pO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplKGFyZ3VtZW50KTtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGFyZ3VtZW50LnZhbHVlID09PSB2b2lkIDApIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCgwIC8qIFVuZGVmaW5lZCAqLyk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemUoYXJndW1lbnQpO1xuICAgIHJldHVybjtcbiAgfVxuICBpZiAoYXJndW1lbnQudmFsdWUgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoNSAvKiBGaXhlZEJ5dGVzICovKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJ5dGVzKGFyZ3VtZW50LnZhbHVlKTtcbiAgICByZXR1cm47XG4gIH1cbiAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoMiAvKiBTdHJpbmcgKi8pO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cihhcmd1bWVudC52YWx1ZS50b1N0cmluZygpKTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZ3VtZW50KGRlc2VyaWFsaXplcikge1xuICBjb25zdCB2YXJpYW50ID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gIHN3aXRjaCAodmFyaWFudCkge1xuICAgIGNhc2UgMCAvKiBVbmRlZmluZWQgKi86IHtcbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICAgIGNhc2UgMSAvKiBBcnJheSAqLzoge1xuICAgICAgY29uc3QgbGVuZ3RoID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gICAgICBjb25zdCBhcmdzID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSArPSAxKSB7XG4gICAgICAgIGNvbnN0IGFyZ3VtZW50ID0gZGVzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnQoZGVzZXJpYWxpemVyKTtcbiAgICAgICAgYXJncy5wdXNoKGFyZ3VtZW50KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBhcmdzO1xuICAgIH1cbiAgICBjYXNlIDMgLyogVWludDhBcnJheSAqLzoge1xuICAgICAgcmV0dXJuIGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJ5dGVzKCk7XG4gICAgfVxuICAgIGNhc2UgNCAvKiBBY2NvdW50QWRkcmVzcyAqLzoge1xuICAgICAgcmV0dXJuIGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBY2NvdW50QWRkcmVzczQpO1xuICAgIH1cbiAgICBjYXNlIDIgLyogU3RyaW5nICovOiB7XG4gICAgICByZXR1cm4gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplU3RyKCk7XG4gICAgfVxuICAgIGNhc2UgNSAvKiBGaXhlZEJ5dGVzICovOiB7XG4gICAgICBjb25zdCBieXRlcyA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJ5dGVzKCk7XG4gICAgICByZXR1cm4gbmV3IEZpeGVkQnl0ZXMoYnl0ZXMpO1xuICAgIH1cbiAgICBkZWZhdWx0OiB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJVbmV4cGVjdGVkIHZhcmlhbnRcIik7XG4gICAgfVxuICB9XG59XG5cbi8vIHNyYy9zaGFyZWQvU2lnbmF0dXJlLnRzXG5pbXBvcnQge1xuICBBbnlTaWduYXR1cmUsXG4gIEVkMjU1MTlTaWduYXR1cmUsXG4gIE11bHRpRWQyNTUxOVNpZ25hdHVyZSxcbiAgU2lnbmluZ1NjaGVtZSBhcyBTaWduaW5nU2NoZW1lMlxufSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5mdW5jdGlvbiBzZXJpYWxpemVTaWduYXR1cmUoc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgaWYgKHZhbHVlIGluc3RhbmNlb2YgRWQyNTUxOVNpZ25hdHVyZSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KFNpZ25pbmdTY2hlbWUyLkVkMjU1MTkpO1xuICB9IGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgTXVsdGlFZDI1NTE5U2lnbmF0dXJlKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoU2lnbmluZ1NjaGVtZTIuTXVsdGlFZDI1NTE5KTtcbiAgfSBlbHNlIGlmICh2YWx1ZSBpbnN0YW5jZW9mIEFueVNpZ25hdHVyZSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KFNpZ25pbmdTY2hlbWUyLlNpbmdsZUtleSk7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCBzaWduYXR1cmUgdHlwZVwiKTtcbiAgfVxuICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZSk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNpZ25hdHVyZShkZXNlcmlhbGl6ZXIpIHtcbiAgY29uc3Qgc2lnbmluZ1NjaGVtZSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICBzd2l0Y2ggKHNpZ25pbmdTY2hlbWUpIHtcbiAgICBjYXNlIFNpZ25pbmdTY2hlbWUyLkVkMjU1MTk6XG4gICAgICByZXR1cm4gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEVkMjU1MTlTaWduYXR1cmUpO1xuICAgIGNhc2UgU2lnbmluZ1NjaGVtZTIuTXVsdGlFZDI1NTE5OlxuICAgICAgcmV0dXJuIGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShNdWx0aUVkMjU1MTlTaWduYXR1cmUpO1xuICAgIGNhc2UgU2lnbmluZ1NjaGVtZTIuU2luZ2xlS2V5OlxuICAgICAgcmV0dXJuIGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShBbnlTaWduYXR1cmUpO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua25vd24gc2lnbmluZyBzY2hlbWU6ICR7c2lnbmluZ1NjaGVtZX1gKTtcbiAgfVxufVxuXG4vLyBzcmMvc2hhcmVkL1RyYW5zYWN0aW9uUGF5bG9hZElucHV0LnRzXG5pbXBvcnQge1xuICBBY2NvdW50QWRkcmVzcyBhcyBBY2NvdW50QWRkcmVzczUsXG4gIGRlc2VyaWFsaXplRnJvbVNjcmlwdEFyZ3VtZW50LFxuICBIZXgsXG4gIHBhcnNlVHlwZVRhZyxcbiAgVHlwZVRhZ1xufSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG52YXIgVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXRWYXJpYW50ID0gLyogQF9fUFVSRV9fICovICgoVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXRWYXJpYW50MikgPT4ge1xuICBUcmFuc2FjdGlvblBheWxvYWRJbnB1dFZhcmlhbnQyW1RyYW5zYWN0aW9uUGF5bG9hZElucHV0VmFyaWFudDJbXCJFbnRyeUZ1bmN0aW9uXCJdID0gMF0gPSBcIkVudHJ5RnVuY3Rpb25cIjtcbiAgVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXRWYXJpYW50MltUcmFuc2FjdGlvblBheWxvYWRJbnB1dFZhcmlhbnQyW1wiU2NyaXB0XCJdID0gMV0gPSBcIlNjcmlwdFwiO1xuICBUcmFuc2FjdGlvblBheWxvYWRJbnB1dFZhcmlhbnQyW1RyYW5zYWN0aW9uUGF5bG9hZElucHV0VmFyaWFudDJbXCJNdWx0aXNpZ1wiXSA9IDJdID0gXCJNdWx0aXNpZ1wiO1xuICByZXR1cm4gVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXRWYXJpYW50Mjtcbn0pKFRyYW5zYWN0aW9uUGF5bG9hZElucHV0VmFyaWFudCB8fCB7fSk7XG5mdW5jdGlvbiBzZXJpYWxpemVUeXBlQXJndW1lbnRzKHNlcmlhbGl6ZXIsIHR5cGVBcmd1bWVudHMpIHtcbiAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgodHlwZUFyZ3VtZW50cy5sZW5ndGgpO1xuICBmb3IgKGNvbnN0IHR5cGVBcmd1bWVudCBvZiB0eXBlQXJndW1lbnRzKSB7XG4gICAgY29uc3QgdHlwZVRhZyA9IHR5cGVvZiB0eXBlQXJndW1lbnQgPT09IFwic3RyaW5nXCIgPyBwYXJzZVR5cGVUYWcodHlwZUFyZ3VtZW50LCB7IGFsbG93R2VuZXJpY3M6IHRydWUgfSkgOiB0eXBlQXJndW1lbnQ7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemUodHlwZVRhZyk7XG4gIH1cbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplVHlwZUFyZ3VtZW50cyhkZXNlcmlhbGl6ZXIpIHtcbiAgY29uc3QgdHlwZUFyZ3VtZW50cyA9IFtdO1xuICBjb25zdCB0eXBlQXJndW1lbnRzTGVuZ3RoID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gIGZvciAobGV0IGkgPSAwOyBpIDwgdHlwZUFyZ3VtZW50c0xlbmd0aDsgaSArPSAxKSB7XG4gICAgY29uc3QgdHlwZVRhZyA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZShUeXBlVGFnKTtcbiAgICB0eXBlQXJndW1lbnRzLnB1c2godHlwZVRhZyk7XG4gIH1cbiAgcmV0dXJuIHR5cGVBcmd1bWVudHM7XG59XG5mdW5jdGlvbiBzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnRzKHNlcmlhbGl6ZXIsIGZ1bmN0aW9uQXJndW1lbnRzKSB7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KGZ1bmN0aW9uQXJndW1lbnRzLmxlbmd0aCk7XG4gIGZvciAoY29uc3QgZnVuY3Rpb25Bcmd1bWVudCBvZiBmdW5jdGlvbkFyZ3VtZW50cykge1xuICAgIHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudChzZXJpYWxpemVyLCBmdW5jdGlvbkFyZ3VtZW50KTtcbiAgfVxufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnRzKGRlc2VyaWFsaXplcikge1xuICBjb25zdCBmdW5jdGlvbkFyZ3VtZW50c0xlbmd0aCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICBjb25zdCBmdW5jdGlvbkFyZ3VtZW50cyA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGZ1bmN0aW9uQXJndW1lbnRzTGVuZ3RoOyBpICs9IDEpIHtcbiAgICBjb25zdCBmdW5jdGlvbkFyZ3VtZW50ID0gZGVzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnQoZGVzZXJpYWxpemVyKTtcbiAgICBmdW5jdGlvbkFyZ3VtZW50cy5wdXNoKGZ1bmN0aW9uQXJndW1lbnQpO1xuICB9XG4gIHJldHVybiBmdW5jdGlvbkFyZ3VtZW50cztcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZVRyYW5zYWN0aW9uUGF5bG9hZElucHV0KHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gIGlmIChcIm11bHRpc2lnQWRkcmVzc1wiIGluIHZhbHVlKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoMiAvKiBNdWx0aXNpZyAqLyk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVTdHIodmFsdWUuZnVuY3Rpb24pO1xuICAgIHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudHMoc2VyaWFsaXplciwgdmFsdWUuZnVuY3Rpb25Bcmd1bWVudHMpO1xuICAgIHNlcmlhbGl6ZVR5cGVBcmd1bWVudHMoc2VyaWFsaXplciwgdmFsdWUudHlwZUFyZ3VtZW50cyA/PyBbXSk7XG4gICAgY29uc3QgbXVsdGlzaWdBZGRyZXNzID0gQWNjb3VudEFkZHJlc3M1LmZyb20odmFsdWUubXVsdGlzaWdBZGRyZXNzKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZShtdWx0aXNpZ0FkZHJlc3MpO1xuICB9IGVsc2UgaWYgKFwiZnVuY3Rpb25cIiBpbiB2YWx1ZSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KDAgLyogRW50cnlGdW5jdGlvbiAqLyk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVTdHIodmFsdWUuZnVuY3Rpb24pO1xuICAgIHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudHMoc2VyaWFsaXplciwgdmFsdWUuZnVuY3Rpb25Bcmd1bWVudHMpO1xuICAgIHNlcmlhbGl6ZVR5cGVBcmd1bWVudHMoc2VyaWFsaXplciwgdmFsdWUudHlwZUFyZ3VtZW50cyA/PyBbXSk7XG4gIH0gZWxzZSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoMSAvKiBTY3JpcHQgKi8pO1xuICAgIGNvbnN0IGJ5dGVjb2RlID0gSGV4LmZyb21IZXhJbnB1dCh2YWx1ZS5ieXRlY29kZSk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCeXRlcyhieXRlY29kZS50b1VpbnQ4QXJyYXkoKSk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgodmFsdWUuZnVuY3Rpb25Bcmd1bWVudHMubGVuZ3RoKTtcbiAgICBmb3IgKGNvbnN0IGFyZ3VtZW50IG9mIHZhbHVlLmZ1bmN0aW9uQXJndW1lbnRzKSB7XG4gICAgICBhcmd1bWVudC5zZXJpYWxpemVGb3JTY3JpcHRGdW5jdGlvbihzZXJpYWxpemVyKTtcbiAgICB9XG4gICAgc2VyaWFsaXplVHlwZUFyZ3VtZW50cyhzZXJpYWxpemVyLCB2YWx1ZS50eXBlQXJndW1lbnRzID8/IFtdKTtcbiAgfVxufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVUcmFuc2FjdGlvblBheWxvYWRJbnB1dChkZXNlcmlhbGl6ZXIpIHtcbiAgY29uc3QgdmFyaWFudCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICBzd2l0Y2ggKHZhcmlhbnQpIHtcbiAgICBjYXNlIDIgLyogTXVsdGlzaWcgKi86IHtcbiAgICAgIGNvbnN0IGZ1bmN0aW9uSWQgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKTtcbiAgICAgIGNvbnN0IGZ1bmN0aW9uQXJndW1lbnRzID0gZGVzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnRzKGRlc2VyaWFsaXplcik7XG4gICAgICBjb25zdCB0eXBlQXJndW1lbnRzID0gZGVzZXJpYWxpemVUeXBlQXJndW1lbnRzKGRlc2VyaWFsaXplcik7XG4gICAgICBjb25zdCBtdWx0aXNpZ0FkZHJlc3MgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoQWNjb3VudEFkZHJlc3M1KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZ1bmN0aW9uOiBmdW5jdGlvbklkLFxuICAgICAgICBmdW5jdGlvbkFyZ3VtZW50cyxcbiAgICAgICAgbXVsdGlzaWdBZGRyZXNzLFxuICAgICAgICB0eXBlQXJndW1lbnRzXG4gICAgICB9O1xuICAgIH1cbiAgICBjYXNlIDAgLyogRW50cnlGdW5jdGlvbiAqLzoge1xuICAgICAgY29uc3QgZnVuY3Rpb25JZCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVN0cigpO1xuICAgICAgY29uc3QgZnVuY3Rpb25Bcmd1bWVudHMgPSBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25Bcmd1bWVudHMoZGVzZXJpYWxpemVyKTtcbiAgICAgIGNvbnN0IHR5cGVBcmd1bWVudHMgPSBkZXNlcmlhbGl6ZVR5cGVBcmd1bWVudHMoZGVzZXJpYWxpemVyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGZ1bmN0aW9uOiBmdW5jdGlvbklkLFxuICAgICAgICBmdW5jdGlvbkFyZ3VtZW50cyxcbiAgICAgICAgdHlwZUFyZ3VtZW50c1xuICAgICAgfTtcbiAgICB9XG4gICAgY2FzZSAxIC8qIFNjcmlwdCAqLzoge1xuICAgICAgY29uc3QgYnl0ZWNvZGUgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVCeXRlcygpO1xuICAgICAgY29uc3QgZnVuY3Rpb25Bcmd1bWVudHNMZW5ndGggPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgICAgIGNvbnN0IGZ1bmN0aW9uQXJndW1lbnRzID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGZ1bmN0aW9uQXJndW1lbnRzTGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgICAgY29uc3QgYXJndW1lbnQgPSBkZXNlcmlhbGl6ZUZyb21TY3JpcHRBcmd1bWVudChkZXNlcmlhbGl6ZXIpO1xuICAgICAgICBmdW5jdGlvbkFyZ3VtZW50cy5wdXNoKGFyZ3VtZW50KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHR5cGVBcmd1bWVudHMgPSBkZXNlcmlhbGl6ZVR5cGVBcmd1bWVudHMoZGVzZXJpYWxpemVyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGJ5dGVjb2RlLFxuICAgICAgICBmdW5jdGlvbkFyZ3VtZW50cyxcbiAgICAgICAgdHlwZUFyZ3VtZW50c1xuICAgICAgfTtcbiAgICB9XG4gICAgZGVmYXVsdDoge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCB2YXJpYW50XCIpO1xuICAgIH1cbiAgfVxufVxuXG4vLyBzcmMvV2FsbGV0UmVxdWVzdC50c1xuZnVuY3Rpb24gc2VyaWFsaXplV2FsbGV0UmVxdWVzdCh7XG4gIGRhcHBJbmZvLFxuICBuYW1lLFxuICB2ZXJzaW9uXG59KSB7XG4gIGNvbnN0IHNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcjkoKTtcbiAgc2VyaWFsaXplRGFwcEluZm8oc2VyaWFsaXplciwgZGFwcEluZm8pO1xuICBjb25zdCBkYXRhID0gc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKTtcbiAgcmV0dXJuIHsgZGF0YSwgbmFtZSwgdmVyc2lvbiB9O1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVXYWxsZXRSZXF1ZXN0KHtcbiAgZGF0YSxcbiAgbmFtZSxcbiAgdmVyc2lvblxufSkge1xuICBjb25zdCBkZXNlcmlhbGl6ZXIgPSBuZXcgRGVzZXJpYWxpemVyOShkYXRhKTtcbiAgY29uc3QgZGFwcEluZm8gPSBkZXNlcmlhbGl6ZURhcHBJbmZvKGRlc2VyaWFsaXplcik7XG4gIHJldHVybiB7IGRhcHBJbmZvLCBuYW1lLCB2ZXJzaW9uIH07XG59XG5mdW5jdGlvbiBzZXJpYWxpemVXYWxsZXRSZXF1ZXN0V2l0aEFyZ3MoeyBhcmdzLCBkYXBwSW5mbywgbmFtZSwgdmVyc2lvbiB9LCBzZXJpYWxpemVBcmdzRm4pIHtcbiAgY29uc3Qgc2VyaWFsaXplciA9IG5ldyBTZXJpYWxpemVyOSgpO1xuICBzZXJpYWxpemVEYXBwSW5mbyhzZXJpYWxpemVyLCBkYXBwSW5mbyk7XG4gIHNlcmlhbGl6ZUFyZ3NGbihzZXJpYWxpemVyLCBhcmdzKTtcbiAgY29uc3QgZGF0YSA9IHNlcmlhbGl6ZXIudG9VaW50OEFycmF5KCk7XG4gIHJldHVybiB7IGRhdGEsIG5hbWUsIHZlcnNpb24gfTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplV2FsbGV0UmVxdWVzdFdpdGhBcmdzKHsgZGF0YSwgbmFtZSwgdmVyc2lvbiB9LCBkZXNlcmlhbGl6ZUFyZ3NGbikge1xuICBjb25zdCBkZXNlcmlhbGl6ZXIgPSBuZXcgRGVzZXJpYWxpemVyOShkYXRhKTtcbiAgY29uc3QgZGFwcEluZm8gPSBkZXNlcmlhbGl6ZURhcHBJbmZvKGRlc2VyaWFsaXplcik7XG4gIGNvbnN0IGFyZ3MgPSBkZXNlcmlhbGl6ZUFyZ3NGbihkZXNlcmlhbGl6ZXIpO1xuICByZXR1cm4geyBhcmdzLCBkYXBwSW5mbywgbmFtZSwgdmVyc2lvbiB9O1xufVxuXG4vLyBzcmMvZmVhdHVyZXMvY29ubmVjdC9yZXF1ZXN0LnRzXG52YXIgQ29ubmVjdFJlcXVlc3Q7XG4oKENvbm5lY3RSZXF1ZXN0MikgPT4ge1xuICBDb25uZWN0UmVxdWVzdDIubmFtZSA9IFwiY29ubmVjdFwiO1xuICBDb25uZWN0UmVxdWVzdDIuc3VwcG9ydGVkVmVyc2lvbnMgPSBbMSwgMiwgM107XG4gIENvbm5lY3RSZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbiA9IDM7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZUFyZ3Moc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZU9wdGlvblN0cih2YWx1ZS5kYXBwSWQpO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplT3B0aW9uU3RyKHZhbHVlLmRhcHBFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBpZiAodmFsdWUucHJlZmVycmVkV2FsbGV0TmFtZSkge1xuICAgICAgc2VyaWFsaXplci5zZXJpYWxpemVPcHRpb25TdHIodmFsdWUucHJlZmVycmVkV2FsbGV0TmFtZSk7XG4gICAgfVxuICB9XG4gIENvbm5lY3RSZXF1ZXN0Mi5zZXJpYWxpemVBcmdzID0gc2VyaWFsaXplQXJncztcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemVBcmdzKGRlc2VyaWFsaXplciwgdmVyc2lvbikge1xuICAgIGlmICh2ZXJzaW9uID09PSAxKSB7XG4gICAgICByZXR1cm4ge307XG4gICAgfVxuICAgIGNvbnN0IGRhcHBJZCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZU9wdGlvblN0cigpO1xuICAgIGNvbnN0IGRhcHBFZDI1NTE5UHVibGljS2V5QjY0ID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplT3B0aW9uU3RyKCk7XG4gICAgY29uc3QgcHJlZmVycmVkV2FsbGV0TmFtZSA9IHZlcnNpb24gPj0gMyA/IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZU9wdGlvblN0cigpIDogdm9pZCAwO1xuICAgIHJldHVybiB7IGRhcHBFZDI1NTE5UHVibGljS2V5QjY0LCBkYXBwSWQsIHByZWZlcnJlZFdhbGxldE5hbWUgfTtcbiAgfVxuICBDb25uZWN0UmVxdWVzdDIuZGVzZXJpYWxpemVBcmdzID0gZGVzZXJpYWxpemVBcmdzO1xuICBmdW5jdGlvbiBzZXJpYWxpemUoZGFwcEluZm8sIGFyZ3MgPSB7fSkge1xuICAgIGNvbnN0IHZlcnNpb24gPSBhcmdzLnByZWZlcnJlZFdhbGxldE5hbWUgPyAzIDogMjtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVxdWVzdFdpdGhBcmdzKHsgYXJncywgZGFwcEluZm8sIG5hbWU6IENvbm5lY3RSZXF1ZXN0Mi5uYW1lLCB2ZXJzaW9uIH0sIHNlcmlhbGl6ZUFyZ3MpO1xuICB9XG4gIENvbm5lY3RSZXF1ZXN0Mi5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVXYWxsZXRSZXF1ZXN0V2l0aEFyZ3MocmVxdWVzdCwgKGQpID0+IGRlc2VyaWFsaXplQXJncyhkLCByZXF1ZXN0LnZlcnNpb24pKTtcbiAgfVxuICBDb25uZWN0UmVxdWVzdDIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gaXNTZXJpYWxpemVkKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gcmVxdWVzdC5uYW1lID09PSBDb25uZWN0UmVxdWVzdDIubmFtZSAmJiBDb25uZWN0UmVxdWVzdDIuc3VwcG9ydGVkVmVyc2lvbnMuaW5jbHVkZXMocmVxdWVzdC52ZXJzaW9uKTtcbiAgfVxuICBDb25uZWN0UmVxdWVzdDIuaXNTZXJpYWxpemVkID0gaXNTZXJpYWxpemVkO1xufSkoQ29ubmVjdFJlcXVlc3QgfHwgKENvbm5lY3RSZXF1ZXN0ID0ge30pKTtcblxuLy8gc3JjL1VzZXJSZXNwb25zZS50c1xuZnVuY3Rpb24gbWFrZVVzZXJBcHByb3ZhbChhcmdzKSB7XG4gIHJldHVybiB7IGFyZ3MsIHN0YXR1czogXCJhcHByb3ZlZFwiIH07XG59XG5mdW5jdGlvbiBtYWtlVXNlclJlc3BvbnNlU2VyaWFsaXplRm4oc2VyaWFsaXplQXJncykge1xuICByZXR1cm4gKHNlcmlhbGl6ZXIsIHZhbHVlKSA9PiB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKHZhbHVlLnN0YXR1cyA9PT0gXCJhcHByb3ZlZFwiKTtcbiAgICBpZiAodmFsdWUuc3RhdHVzID09PSBcImFwcHJvdmVkXCIpIHtcbiAgICAgIHNlcmlhbGl6ZUFyZ3Moc2VyaWFsaXplciwgdmFsdWUuYXJncyk7XG4gICAgfVxuICB9O1xufVxuZnVuY3Rpb24gbWFrZVVzZXJSZXNwb25zZURlc2VyaWFsaXplRm4oZGVzZXJpYWxpemVBcmdzKSB7XG4gIHJldHVybiAoZGVzZXJpYWxpemVyKSA9PiB7XG4gICAgY29uc3QgaXNBcHByb3ZlZCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgICByZXR1cm4gaXNBcHByb3ZlZCA/IHsgYXJnczogZGVzZXJpYWxpemVBcmdzKGRlc2VyaWFsaXplciksIHN0YXR1czogXCJhcHByb3ZlZFwiIH0gOiB7IHN0YXR1czogXCJkaXNtaXNzZWRcIiB9O1xuICB9O1xufVxuXG4vLyBzcmMvV2FsbGV0UmVzcG9uc2UudHNcbmltcG9ydCB7IERlc2VyaWFsaXplciBhcyBEZXNlcmlhbGl6ZXIxMCwgU2VyaWFsaXplciBhcyBTZXJpYWxpemVyMTAgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5mdW5jdGlvbiBzZXJpYWxpemVXYWxsZXRSZXNwb25zZShhcmdzLCBzZXJpYWxpemVGbikge1xuICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXIxMCgpO1xuICBzZXJpYWxpemVGbihzZXJpYWxpemVyLCBhcmdzKTtcbiAgY29uc3QgZGF0YSA9IHNlcmlhbGl6ZXIudG9VaW50OEFycmF5KCk7XG4gIHJldHVybiB7IGRhdGEgfTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplV2FsbGV0UmVzcG9uc2UoeyBkYXRhIH0sIGRlc2VyaWFsaXplRm4pIHtcbiAgY29uc3QgZGVzZXJpYWxpemVyID0gbmV3IERlc2VyaWFsaXplcjEwKGRhdGEpO1xuICBjb25zdCBhcmdzID0gZGVzZXJpYWxpemVGbihkZXNlcmlhbGl6ZXIpO1xuICByZXR1cm4geyBhcmdzIH07XG59XG5cbi8vIHNyYy9mZWF0dXJlcy9jb25uZWN0L3Jlc3BvbnNlLnRzXG52YXIgQ29ubmVjdFJlc3BvbnNlO1xuKChDb25uZWN0UmVzcG9uc2UyKSA9PiB7XG4gIENvbm5lY3RSZXNwb25zZTIuc3VwcG9ydGVkVmVyc2lvbnMgPSBbMSwgMl07XG4gIENvbm5lY3RSZXNwb25zZTIuY3VycmVudFZlcnNpb24gPSAyO1xuICBmdW5jdGlvbiBzZXJpYWxpemVBcHByb3ZhbEFyZ3NWMShzZXJpYWxpemVyLCB2YWx1ZSkge1xuICAgIHNlcmlhbGl6ZUFjY291bnRJbmZvKHNlcmlhbGl6ZXIsIHZhbHVlLmFjY291bnQpO1xuICB9XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZUFwcHJvdmFsQXJncyhzZXJpYWxpemVyLCB2YWx1ZSkge1xuICAgIHNlcmlhbGl6ZUFjY291bnRJbmZvKHNlcmlhbGl6ZXIsIHZhbHVlLmFjY291bnQpO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplT3B0aW9uU3RyKHZhbHVlLnBhaXJpbmcgIT09IHZvaWQgMCA/IEpTT04uc3RyaW5naWZ5KHZhbHVlLnBhaXJpbmcpIDogdm9pZCAwKTtcbiAgfVxuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUFwcHJvdmFsQXJncyhkZXNlcmlhbGl6ZXIpIHtcbiAgICBjb25zdCBhY2NvdW50ID0gZGVzZXJpYWxpemVBY2NvdW50SW5mbyhkZXNlcmlhbGl6ZXIpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRQYWlyaW5nID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplT3B0aW9uU3RyKCk7XG4gICAgY29uc3QgcGFpcmluZyA9IHNlcmlhbGl6ZWRQYWlyaW5nICE9PSB2b2lkIDAgPyBKU09OLnBhcnNlKHNlcmlhbGl6ZWRQYWlyaW5nKSA6IHZvaWQgMDtcbiAgICByZXR1cm4geyBhY2NvdW50LCBwYWlyaW5nIH07XG4gIH1cbiAgY29uc3Qgc2VyaWFsaXplQXJnc1YxID0gbWFrZVVzZXJSZXNwb25zZVNlcmlhbGl6ZUZuKHNlcmlhbGl6ZUFwcHJvdmFsQXJnc1YxKTtcbiAgY29uc3Qgc2VyaWFsaXplQXJncyA9IG1ha2VVc2VyUmVzcG9uc2VTZXJpYWxpemVGbihzZXJpYWxpemVBcHByb3ZhbEFyZ3MpO1xuICBjb25zdCBkZXNlcmlhbGl6ZUFyZ3MgPSBtYWtlVXNlclJlc3BvbnNlRGVzZXJpYWxpemVGbihkZXNlcmlhbGl6ZUFwcHJvdmFsQXJncyk7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShhcmdzLCB2ZXJzaW9uID0gQ29ubmVjdFJlc3BvbnNlMi5jdXJyZW50VmVyc2lvbikge1xuICAgIHJldHVybiBzZXJpYWxpemVXYWxsZXRSZXNwb25zZShhcmdzLCB2ZXJzaW9uID09PSAxID8gc2VyaWFsaXplQXJnc1YxIDogc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgQ29ubmVjdFJlc3BvbnNlMi5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKHNlcmlhbGl6ZWRSZXNwb25zZSwgZGVzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBDb25uZWN0UmVzcG9uc2UyLmRlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG59KShDb25uZWN0UmVzcG9uc2UgfHwgKENvbm5lY3RSZXNwb25zZSA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9kaXNjb25uZWN0L3JlcXVlc3QudHNcbnZhciBEaXNjb25uZWN0UmVxdWVzdDtcbigoRGlzY29ubmVjdFJlcXVlc3QyKSA9PiB7XG4gIERpc2Nvbm5lY3RSZXF1ZXN0Mi5uYW1lID0gXCJkaXNjb25uZWN0XCI7XG4gIERpc2Nvbm5lY3RSZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbiA9IDE7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShkYXBwSW5mbykge1xuICAgIHJldHVybiBzZXJpYWxpemVXYWxsZXRSZXF1ZXN0KHsgZGFwcEluZm8sIG5hbWU6IERpc2Nvbm5lY3RSZXF1ZXN0Mi5uYW1lLCB2ZXJzaW9uOiBEaXNjb25uZWN0UmVxdWVzdDIuY3VycmVudFZlcnNpb24gfSk7XG4gIH1cbiAgRGlzY29ubmVjdFJlcXVlc3QyLnNlcmlhbGl6ZSA9IHNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemUocmVxdWVzdCkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlcXVlc3QocmVxdWVzdCk7XG4gIH1cbiAgRGlzY29ubmVjdFJlcXVlc3QyLmRlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGlzU2VyaWFsaXplZChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHJlcXVlc3QubmFtZSA9PT0gRGlzY29ubmVjdFJlcXVlc3QyLm5hbWUgJiYgcmVxdWVzdC52ZXJzaW9uID09PSBEaXNjb25uZWN0UmVxdWVzdDIuY3VycmVudFZlcnNpb247XG4gIH1cbiAgRGlzY29ubmVjdFJlcXVlc3QyLmlzU2VyaWFsaXplZCA9IGlzU2VyaWFsaXplZDtcbn0pKERpc2Nvbm5lY3RSZXF1ZXN0IHx8IChEaXNjb25uZWN0UmVxdWVzdCA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9kaXNjb25uZWN0L3Jlc3BvbnNlLnRzXG52YXIgRGlzY29ubmVjdFJlc3BvbnNlO1xuKChEaXNjb25uZWN0UmVzcG9uc2UyKSA9PiB7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShhcmdzKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKGFyZ3MsICgpID0+IHtcbiAgICB9KTtcbiAgfVxuICBEaXNjb25uZWN0UmVzcG9uc2UyLnNlcmlhbGl6ZSA9IHNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplV2FsbGV0UmVzcG9uc2Uoc2VyaWFsaXplZFJlc3BvbnNlLCAoKSA9PiAoe30pKTtcbiAgfVxuICBEaXNjb25uZWN0UmVzcG9uc2UyLmRlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG59KShEaXNjb25uZWN0UmVzcG9uc2UgfHwgKERpc2Nvbm5lY3RSZXNwb25zZSA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9nZXRDb25uZWN0ZWRBY2NvdW50cy9yZXF1ZXN0LnRzXG52YXIgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0O1xuKChHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QyKSA9PiB7XG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdDIubmFtZSA9IFwiZ2V0Q29ubmVjdGVkQWNjb3VudHNcIjtcbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbiA9IDE7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShkYXBwSW5mbykge1xuICAgIHJldHVybiBzZXJpYWxpemVXYWxsZXRSZXF1ZXN0KHsgZGFwcEluZm8sIG5hbWU6IEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdDIubmFtZSwgdmVyc2lvbjogR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbiB9KTtcbiAgfVxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QyLnNlcmlhbGl6ZSA9IHNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemUocmVxdWVzdCkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlcXVlc3QocmVxdWVzdCk7XG4gIH1cbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5kZXNlcmlhbGl6ZSA9IGRlc2VyaWFsaXplO1xuICBmdW5jdGlvbiBpc1NlcmlhbGl6ZWQocmVxdWVzdCkge1xuICAgIHJldHVybiByZXF1ZXN0Lm5hbWUgPT09IEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdDIubmFtZSAmJiByZXF1ZXN0LnZlcnNpb24gPT09IEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdDIuY3VycmVudFZlcnNpb247XG4gIH1cbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5pc1NlcmlhbGl6ZWQgPSBpc1NlcmlhbGl6ZWQ7XG59KShHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QgfHwgKEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdCA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9nZXRDb25uZWN0ZWRBY2NvdW50cy9yZXNwb25zZS50c1xudmFyIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2U7XG4oKEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UyKSA9PiB7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZUFyZ3Moc2VyaWFsaXplciwgYXJncykge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KGFyZ3MubGVuZ3RoKTtcbiAgICBmb3IgKGNvbnN0IGFjY291bnQgb2YgYXJncykge1xuICAgICAgc2VyaWFsaXplQWNjb3VudEluZm8oc2VyaWFsaXplciwgYWNjb3VudCk7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplQXJncyhkZXNlcmlhbGl6ZXIpIHtcbiAgICBjb25zdCBsZW5ndGggPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgICBjb25zdCBhY2NvdW50cyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIGFjY291bnRzLnB1c2goZGVzZXJpYWxpemVBY2NvdW50SW5mbyhkZXNlcmlhbGl6ZXIpKTtcbiAgICB9XG4gICAgcmV0dXJuIGFjY291bnRzO1xuICB9XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShhcmdzKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKGFyZ3MsIHNlcmlhbGl6ZUFyZ3MpO1xuICB9XG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UyLnNlcmlhbGl6ZSA9IHNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplV2FsbGV0UmVzcG9uc2Uoc2VyaWFsaXplZFJlc3BvbnNlLCBkZXNlcmlhbGl6ZUFyZ3MpO1xuICB9XG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UyLmRlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG59KShHZXRDb25uZWN0ZWRBY2NvdW50c1Jlc3BvbnNlIHx8IChHZXRDb25uZWN0ZWRBY2NvdW50c1Jlc3BvbnNlID0ge30pKTtcblxuLy8gc3JjL2ZlYXR1cmVzL2lzQ29ubmVjdGVkL3JlcXVlc3QudHNcbnZhciBJc0Nvbm5lY3RlZFJlcXVlc3Q7XG4oKElzQ29ubmVjdGVkUmVxdWVzdDIpID0+IHtcbiAgSXNDb25uZWN0ZWRSZXF1ZXN0Mi5uYW1lID0gXCJpc0Nvbm5lY3RlZFwiO1xuICBJc0Nvbm5lY3RlZFJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uID0gMTtcbiAgZnVuY3Rpb24gc2VyaWFsaXplKGRhcHBJbmZvKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlcXVlc3QoeyBkYXBwSW5mbywgbmFtZTogSXNDb25uZWN0ZWRSZXF1ZXN0Mi5uYW1lLCB2ZXJzaW9uOiBJc0Nvbm5lY3RlZFJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uIH0pO1xuICB9XG4gIElzQ29ubmVjdGVkUmVxdWVzdDIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplV2FsbGV0UmVxdWVzdChyZXF1ZXN0KTtcbiAgfVxuICBJc0Nvbm5lY3RlZFJlcXVlc3QyLmRlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGlzU2VyaWFsaXplZChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHJlcXVlc3QubmFtZSA9PT0gSXNDb25uZWN0ZWRSZXF1ZXN0Mi5uYW1lICYmIHJlcXVlc3QudmVyc2lvbiA9PT0gSXNDb25uZWN0ZWRSZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbjtcbiAgfVxuICBJc0Nvbm5lY3RlZFJlcXVlc3QyLmlzU2VyaWFsaXplZCA9IGlzU2VyaWFsaXplZDtcbn0pKElzQ29ubmVjdGVkUmVxdWVzdCB8fCAoSXNDb25uZWN0ZWRSZXF1ZXN0ID0ge30pKTtcblxuLy8gc3JjL2ZlYXR1cmVzL2lzQ29ubmVjdGVkL3Jlc3BvbnNlLnRzXG52YXIgSXNDb25uZWN0ZWRSZXNwb25zZTtcbigoSXNDb25uZWN0ZWRSZXNwb25zZTIpID0+IHtcbiAgZnVuY3Rpb24gc2VyaWFsaXplQXJncyhzZXJpYWxpemVyLCB2YWx1ZSkge1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbCh2YWx1ZSk7XG4gIH1cbiAgZnVuY3Rpb24gZGVzZXJpYWxpemVBcmdzKGRlc2VyaWFsaXplcikge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVCb29sKCk7XG4gIH1cbiAgZnVuY3Rpb24gc2VyaWFsaXplKGFyZ3MpIHtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVzcG9uc2UoYXJncywgc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgSXNDb25uZWN0ZWRSZXNwb25zZTIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpIHtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVXYWxsZXRSZXNwb25zZShzZXJpYWxpemVkUmVzcG9uc2UsIGRlc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgSXNDb25uZWN0ZWRSZXNwb25zZTIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbn0pKElzQ29ubmVjdGVkUmVzcG9uc2UgfHwgKElzQ29ubmVjdGVkUmVzcG9uc2UgPSB7fSkpO1xuXG4vLyBzcmMvZmVhdHVyZXMvc2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uL3JlcXVlc3QudHNcbmltcG9ydCB7XG4gIEFjY291bnRBZGRyZXNzIGFzIEFjY291bnRBZGRyZXNzNixcbiAgVHJhbnNhY3Rpb25QYXlsb2FkXG59IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbnZhciBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0O1xuKChTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0MikgPT4ge1xuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5uYW1lID0gXCJzaWduQW5kU3VibWl0VHJhbnNhY3Rpb25cIjtcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdDIuc3VwcG9ydGVkVmVyc2lvbnMgPSBbMSwgMiwgM107XG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uID0gMztcbiAgZnVuY3Rpb24gc2VyaWFsaXplQXJncyhzZXJpYWxpemVyLCB2YWx1ZSkge1xuICAgIGlmICh2YWx1ZS5uZXR3b3JrICE9PSB2b2lkIDAgJiYgIWlzU3VwcG9ydGVkTmV0d29yayh2YWx1ZS5uZXR3b3JrKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBuZXR3b3JrICcke3ZhbHVlLm5ldHdvcmt9J2ApO1xuICAgIH1cbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2wodmFsdWUuc2lnbmVyQWRkcmVzcyAhPT0gdm9pZCAwKTtcbiAgICBpZiAodmFsdWUuc2lnbmVyQWRkcmVzcyAhPT0gdm9pZCAwKSB7XG4gICAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZS5zaWduZXJBZGRyZXNzKTtcbiAgICB9XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVPcHRpb25TdHIodmFsdWUubmV0d29yayk7XG4gICAgaWYgKFwiYmNzVG9CeXRlc1wiIGluIHZhbHVlLnBheWxvYWQpIHtcbiAgICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbCh0cnVlKTtcbiAgICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplKHZhbHVlLnBheWxvYWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2woZmFsc2UpO1xuICAgICAgc2VyaWFsaXplVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXQoc2VyaWFsaXplciwgdmFsdWUucGF5bG9hZCk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTY0KHZhbHVlLmV4cGlyYXRpb25UaW1lc3RhbXAgPz8gMCk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgodmFsdWUuZ2FzVW5pdFByaWNlID8/IDApO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KHZhbHVlLm1heEdhc0Ftb3VudCA/PyAwKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCh2YWx1ZS5mZWVQYXllciA/IDEgOiAwKTtcbiAgICBpZiAodmFsdWUuZmVlUGF5ZXIpIHtcbiAgICAgIHNlcmlhbGl6ZUFjY291bnRBdXRoZW50aWNhdG9ySW5wdXQoc2VyaWFsaXplciwgdmFsdWUuZmVlUGF5ZXIpO1xuICAgIH1cbiAgfVxuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5zZXJpYWxpemVBcmdzID0gc2VyaWFsaXplQXJncztcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemVBcmdzKGRlc2VyaWFsaXplciwgdmVyc2lvbikge1xuICAgIGNvbnN0IGhhc1NpZ25lckFkZHJlc3MgPSB2ZXJzaW9uID49IDMgJiYgZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQm9vbCgpO1xuICAgIGNvbnN0IHNpZ25lckFkZHJlc3MgPSBoYXNTaWduZXJBZGRyZXNzID8gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKEFjY291bnRBZGRyZXNzNikgOiB2b2lkIDA7XG4gICAgY29uc3QgbmV0d29yayA9IHZlcnNpb24gPT09IDEgPyBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKSA6IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZU9wdGlvblN0cigpO1xuICAgIGlmIChuZXR3b3JrICE9PSB2b2lkIDAgJiYgIWlzU3VwcG9ydGVkTmV0d29yayhuZXR3b3JrKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBuZXR3b3JrICcke25ldHdvcmt9J2ApO1xuICAgIH1cbiAgICBjb25zdCBpc1BheWxvYWRCY3NTZXJpYWxpemFibGUgPSB2ZXJzaW9uID09PSAxIHx8IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgICBjb25zdCBwYXlsb2FkID0gaXNQYXlsb2FkQmNzU2VyaWFsaXphYmxlID8gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKFRyYW5zYWN0aW9uUGF5bG9hZCkgOiBkZXNlcmlhbGl6ZVRyYW5zYWN0aW9uUGF5bG9hZElucHV0KGRlc2VyaWFsaXplcik7XG4gICAgY29uc3QgZXhwaXJhdGlvblRpbWVzdGFtcCA9IE51bWJlcihkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVNjQoKSk7XG4gICAgY29uc3QgZ2FzVW5pdFByaWNlID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gICAgY29uc3QgbWF4R2FzQW1vdW50ID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVWxlYjEyOEFzVTMyKCk7XG4gICAgY29uc3QgaGFzRmVlUGF5ZXIgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgICBjb25zdCBmZWVQYXllciA9IGhhc0ZlZVBheWVyID8gZGVzZXJpYWxpemVBY2NvdW50QXV0aGVudGljYXRvcklucHV0KGRlc2VyaWFsaXplcikgOiB2b2lkIDA7XG4gICAgcmV0dXJuIHtcbiAgICAgIGV4cGlyYXRpb25UaW1lc3RhbXA6IGV4cGlyYXRpb25UaW1lc3RhbXAgPiAwID8gZXhwaXJhdGlvblRpbWVzdGFtcCA6IHZvaWQgMCxcbiAgICAgIGZlZVBheWVyLFxuICAgICAgZ2FzVW5pdFByaWNlOiBnYXNVbml0UHJpY2UgPiAwID8gZ2FzVW5pdFByaWNlIDogdm9pZCAwLFxuICAgICAgbWF4R2FzQW1vdW50OiBtYXhHYXNBbW91bnQgPiAwID8gbWF4R2FzQW1vdW50IDogdm9pZCAwLFxuICAgICAgbmV0d29yayxcbiAgICAgIHBheWxvYWQsXG4gICAgICBzaWduZXJBZGRyZXNzXG4gICAgfTtcbiAgfVxuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5kZXNlcmlhbGl6ZUFyZ3MgPSBkZXNlcmlhbGl6ZUFyZ3M7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShkYXBwSW5mbywgYXJncykge1xuICAgIGNvbnN0IHJlcXVlc3QgPSB7IGFyZ3MsIGRhcHBJbmZvLCBuYW1lOiBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5uYW1lLCB2ZXJzaW9uOiBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5jdXJyZW50VmVyc2lvbiB9O1xuICAgIHJldHVybiBzZXJpYWxpemVXYWxsZXRSZXF1ZXN0V2l0aEFyZ3MocmVxdWVzdCwgc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdDIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVxdWVzdCkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlcXVlc3RXaXRoQXJncyhcbiAgICAgIHNlcmlhbGl6ZWRSZXF1ZXN0LFxuICAgICAgKGRlc2VyaWFsaXplcikgPT4gZGVzZXJpYWxpemVBcmdzKGRlc2VyaWFsaXplciwgc2VyaWFsaXplZFJlcXVlc3QudmVyc2lvbilcbiAgICApO1xuICB9XG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyLmRlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGlzU2VyaWFsaXplZChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIHJlcXVlc3QubmFtZSA9PT0gU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdDIubmFtZSAmJiBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5zdXBwb3J0ZWRWZXJzaW9ucy5pbmNsdWRlcyhyZXF1ZXN0LnZlcnNpb24pO1xuICB9XG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QyLmlzU2VyaWFsaXplZCA9IGlzU2VyaWFsaXplZDtcbn0pKFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QgfHwgKFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QgPSB7fSkpO1xuXG4vLyBzcmMvZmVhdHVyZXMvc2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uL3Jlc3BvbnNlLnRzXG52YXIgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2U7XG4oKFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlMikgPT4ge1xuICBmdW5jdGlvbiBzZXJpYWxpemVBcHByb3ZhbEFyZ3Moc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cih2YWx1ZS50eG5IYXNoKTtcbiAgfVxuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUFwcHJvdmFsQXJncyhkZXNlcmlhbGl6ZXIpIHtcbiAgICBjb25zdCB0eG5IYXNoID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplU3RyKCk7XG4gICAgcmV0dXJuIHsgdHhuSGFzaCB9O1xuICB9XG4gIGNvbnN0IHNlcmlhbGl6ZUFyZ3MgPSBtYWtlVXNlclJlc3BvbnNlU2VyaWFsaXplRm4oc2VyaWFsaXplQXBwcm92YWxBcmdzKTtcbiAgY29uc3QgZGVzZXJpYWxpemVBcmdzID0gbWFrZVVzZXJSZXNwb25zZURlc2VyaWFsaXplRm4oZGVzZXJpYWxpemVBcHByb3ZhbEFyZ3MpO1xuICBmdW5jdGlvbiBzZXJpYWxpemUoYXJncykge1xuICAgIHJldHVybiBzZXJpYWxpemVXYWxsZXRSZXNwb25zZShhcmdzLCBzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXNwb25zZTIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpIHtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVXYWxsZXRSZXNwb25zZShzZXJpYWxpemVkUmVzcG9uc2UsIGRlc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UyLmRlc2VyaWFsaXplID0gZGVzZXJpYWxpemU7XG59KShTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXNwb25zZSB8fCAoU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UgPSB7fSkpO1xuXG4vLyBzcmMvZmVhdHVyZXMvc2lnbk1lc3NhZ2UvcmVxdWVzdC50c1xuaW1wb3J0IHsgQWNjb3VudEFkZHJlc3MgYXMgQWNjb3VudEFkZHJlc3M3IH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xudmFyIFNpZ25NZXNzYWdlUmVxdWVzdDtcbigoU2lnbk1lc3NhZ2VSZXF1ZXN0MikgPT4ge1xuICBTaWduTWVzc2FnZVJlcXVlc3QyLm5hbWUgPSBcInNpZ25NZXNzYWdlXCI7XG4gIFNpZ25NZXNzYWdlUmVxdWVzdDIuc3VwcG9ydGVkVmVyc2lvbnMgPSBbMSwgMl07XG4gIFNpZ25NZXNzYWdlUmVxdWVzdDIuY3VycmVudFZlcnNpb24gPSAyO1xuICBmdW5jdGlvbiBzZXJpYWxpemVBcmdzKHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKHZhbHVlLnNpZ25lckFkZHJlc3MgIT09IHZvaWQgMCk7XG4gICAgaWYgKHZhbHVlLnNpZ25lckFkZHJlc3MgIT09IHZvaWQgMCkge1xuICAgICAgc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUuc2lnbmVyQWRkcmVzcyk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTgodmFsdWUuY2hhaW5JZCk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCeXRlcyh2YWx1ZS5ub25jZSk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCeXRlcyh2YWx1ZS5tZXNzYWdlKTtcbiAgfVxuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUFyZ3MoZGVzZXJpYWxpemVyLCB2ZXJzaW9uKSB7XG4gICAgY29uc3QgaGFzU2lnbmVyQWRkcmVzcyA9IHZlcnNpb24gPj0gMiAmJiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVCb29sKCk7XG4gICAgY29uc3Qgc2lnbmVyQWRkcmVzcyA9IGhhc1NpZ25lckFkZHJlc3MgPyBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoQWNjb3VudEFkZHJlc3M3KSA6IHZvaWQgMDtcbiAgICBjb25zdCBjaGFpbklkID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVTgoKTtcbiAgICBjb25zdCBub25jZSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJ5dGVzKCk7XG4gICAgY29uc3QgbWVzc2FnZSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJ5dGVzKCk7XG4gICAgcmV0dXJuIHsgY2hhaW5JZCwgbWVzc2FnZSwgbm9uY2UsIHNpZ25lckFkZHJlc3MgfTtcbiAgfVxuICBmdW5jdGlvbiBzZXJpYWxpemUoZGFwcEluZm8sIGFyZ3MpIHtcbiAgICBjb25zdCByZXF1ZXN0ID0geyBhcmdzLCBkYXBwSW5mbywgbmFtZTogU2lnbk1lc3NhZ2VSZXF1ZXN0Mi5uYW1lLCB2ZXJzaW9uOiBTaWduTWVzc2FnZVJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uIH07XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlcXVlc3RXaXRoQXJncyhyZXF1ZXN0LCBzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBTaWduTWVzc2FnZVJlcXVlc3QyLnNlcmlhbGl6ZSA9IHNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlcXVlc3QpIHtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVXYWxsZXRSZXF1ZXN0V2l0aEFyZ3Moc2VyaWFsaXplZFJlcXVlc3QsIChkKSA9PiBkZXNlcmlhbGl6ZUFyZ3MoZCwgc2VyaWFsaXplZFJlcXVlc3QudmVyc2lvbikpO1xuICB9XG4gIFNpZ25NZXNzYWdlUmVxdWVzdDIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gaXNTZXJpYWxpemVkKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gcmVxdWVzdC5uYW1lID09PSBTaWduTWVzc2FnZVJlcXVlc3QyLm5hbWUgJiYgcmVxdWVzdC52ZXJzaW9uID09PSBTaWduTWVzc2FnZVJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uO1xuICB9XG4gIFNpZ25NZXNzYWdlUmVxdWVzdDIuaXNTZXJpYWxpemVkID0gaXNTZXJpYWxpemVkO1xufSkoU2lnbk1lc3NhZ2VSZXF1ZXN0IHx8IChTaWduTWVzc2FnZVJlcXVlc3QgPSB7fSkpO1xuXG4vLyBzcmMvZmVhdHVyZXMvc2lnbk1lc3NhZ2UvcmVzcG9uc2UudHNcbnZhciBTaWduTWVzc2FnZVJlc3BvbnNlO1xuKChTaWduTWVzc2FnZVJlc3BvbnNlMikgPT4ge1xuICBmdW5jdGlvbiBzZXJpYWxpemVBcHByb3ZhbEFyZ3Moc2VyaWFsaXplciwgdmFsdWUpIHtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cih2YWx1ZS5mdWxsTWVzc2FnZSk7XG4gICAgc2VyaWFsaXplU2lnbmF0dXJlKHNlcmlhbGl6ZXIsIHZhbHVlLnNpZ25hdHVyZSk7XG4gIH1cbiAgZnVuY3Rpb24gZGVzZXJpYWxpemVBcHByb3ZhbEFyZ3MoZGVzZXJpYWxpemVyKSB7XG4gICAgY29uc3QgZnVsbE1lc3NhZ2UgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKTtcbiAgICBjb25zdCBzaWduYXR1cmUgPSBkZXNlcmlhbGl6ZVNpZ25hdHVyZShkZXNlcmlhbGl6ZXIpO1xuICAgIHJldHVybiB7IGZ1bGxNZXNzYWdlLCBzaWduYXR1cmUgfTtcbiAgfVxuICBjb25zdCBzZXJpYWxpemVBcmdzID0gbWFrZVVzZXJSZXNwb25zZVNlcmlhbGl6ZUZuKHNlcmlhbGl6ZUFwcHJvdmFsQXJncyk7XG4gIGNvbnN0IGRlc2VyaWFsaXplQXJncyA9IG1ha2VVc2VyUmVzcG9uc2VEZXNlcmlhbGl6ZUZuKGRlc2VyaWFsaXplQXBwcm92YWxBcmdzKTtcbiAgZnVuY3Rpb24gc2VyaWFsaXplKGFyZ3MpIHtcbiAgICByZXR1cm4gc2VyaWFsaXplV2FsbGV0UmVzcG9uc2UoYXJncywgc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgU2lnbk1lc3NhZ2VSZXNwb25zZTIuc2VyaWFsaXplID0gc2VyaWFsaXplO1xuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpIHtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVXYWxsZXRSZXNwb25zZShzZXJpYWxpemVkUmVzcG9uc2UsIGRlc2VyaWFsaXplQXJncyk7XG4gIH1cbiAgU2lnbk1lc3NhZ2VSZXNwb25zZTIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbn0pKFNpZ25NZXNzYWdlUmVzcG9uc2UgfHwgKFNpZ25NZXNzYWdlUmVzcG9uc2UgPSB7fSkpO1xuXG4vLyBzcmMvZmVhdHVyZXMvc2lnblRyYW5zYWN0aW9uL3JlcXVlc3QudHNcbmltcG9ydCB7XG4gIEFjY291bnRBZGRyZXNzIGFzIEFjY291bnRBZGRyZXNzOCxcbiAgVHJhbnNhY3Rpb25QYXlsb2FkIGFzIFRyYW5zYWN0aW9uUGF5bG9hZDJcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xudmFyIFNpZ25UcmFuc2FjdGlvblJlcXVlc3Q7XG4oKFNpZ25UcmFuc2FjdGlvblJlcXVlc3QyKSA9PiB7XG4gIFNpZ25UcmFuc2FjdGlvblJlcXVlc3QyLm5hbWUgPSBcInNpZ25UcmFuc2FjdGlvblwiO1xuICBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Mi5zdXBwb3J0ZWRWZXJzaW9ucyA9IFsxLCAyLCAzLCA0XTtcbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIuY3VycmVudFZlcnNpb24gPSA0O1xuICBmdW5jdGlvbiBub3JtYWxpemVBcmdzKGFyZ3MpIHtcbiAgICBjb25zdCB7IGZlZVBheWVyLCBzZWNvbmRhcnlTaWduZXJzLCBzZW5kZXJQdWJsaWNLZXksIHNpZ25lckFkZHJlc3MsIHRyYW5zYWN0aW9uIH0gPSBhcmdzO1xuICAgIGNvbnN0IHNlbmRlciA9IHtcbiAgICAgIGFkZHJlc3M6IHRyYW5zYWN0aW9uLnNlbmRlcixcbiAgICAgIHB1YmxpY0tleTogc2VuZGVyUHVibGljS2V5XG4gICAgfTtcbiAgICBjb25zdCBuZXR3b3JrID0gY2hhaW5JZFRvTmV0d29yayhhcmdzLnRyYW5zYWN0aW9uLmNoYWluX2lkLmNoYWluSWQpO1xuICAgIHJldHVybiB7XG4gICAgICBleHBpcmF0aW9uVGltZXN0YW1wOiBOdW1iZXIodHJhbnNhY3Rpb24uZXhwaXJhdGlvbl90aW1lc3RhbXBfc2VjcyksXG4gICAgICBmZWVQYXllcixcbiAgICAgIGdhc1VuaXRQcmljZTogTnVtYmVyKHRyYW5zYWN0aW9uLmdhc191bml0X3ByaWNlKSxcbiAgICAgIG1heEdhc0Ftb3VudDogTnVtYmVyKHRyYW5zYWN0aW9uLm1heF9nYXNfYW1vdW50KSxcbiAgICAgIG5ldHdvcmssXG4gICAgICBwYXlsb2FkOiB0cmFuc2FjdGlvbi5wYXlsb2FkLFxuICAgICAgc2Vjb25kYXJ5U2lnbmVycyxcbiAgICAgIHNlbmRlcixcbiAgICAgIHNpZ25lckFkZHJlc3NcbiAgICB9O1xuICB9XG4gIFNpZ25UcmFuc2FjdGlvblJlcXVlc3QyLm5vcm1hbGl6ZUFyZ3MgPSBub3JtYWxpemVBcmdzO1xuICBmdW5jdGlvbiBzZXJpYWxpemVBcmdzKHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gICAgaWYgKHZhbHVlLm5ldHdvcmsgIT09IHZvaWQgMCAmJiAhaXNTdXBwb3J0ZWROZXR3b3JrKHZhbHVlLm5ldHdvcmspKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIG5ldHdvcmsgJyR7dmFsdWUubmV0d29ya30nYCk7XG4gICAgfVxuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbCh2YWx1ZS5zaWduZXJBZGRyZXNzICE9PSB2b2lkIDApO1xuICAgIGlmICh2YWx1ZS5zaWduZXJBZGRyZXNzICE9PSB2b2lkIDApIHtcbiAgICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplKHZhbHVlLnNpZ25lckFkZHJlc3MpO1xuICAgIH1cbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZU9wdGlvblN0cih2YWx1ZS5uZXR3b3JrKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2wodmFsdWUuc2VuZGVyICE9PSB2b2lkIDApO1xuICAgIGlmICh2YWx1ZS5zZW5kZXIgIT09IHZvaWQgMCkge1xuICAgICAgc2VyaWFsaXplQWNjb3VudElucHV0KHNlcmlhbGl6ZXIsIHZhbHVlLnNlbmRlcik7XG4gICAgfVxuICAgIGlmIChcImJjc1RvQnl0ZXNcIiBpbiB2YWx1ZS5wYXlsb2FkKSB7XG4gICAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2wodHJ1ZSk7XG4gICAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZS5wYXlsb2FkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKGZhbHNlKTtcbiAgICAgIHNlcmlhbGl6ZVRyYW5zYWN0aW9uUGF5bG9hZElucHV0KHNlcmlhbGl6ZXIsIHZhbHVlLnBheWxvYWQpO1xuICAgIH1cbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCh2YWx1ZS5leHBpcmF0aW9uU2Vjb25kc0Zyb21Ob3cgPz8gMCk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVNjQodmFsdWUuZXhwaXJhdGlvblRpbWVzdGFtcCA/PyAwKTtcbiAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZVUzMkFzVWxlYjEyOCh2YWx1ZS5nYXNVbml0UHJpY2UgPz8gMCk7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgodmFsdWUubWF4R2FzQW1vdW50ID8/IDApO1xuICAgIHNlcmlhbGl6ZXIuc2VyaWFsaXplQm9vbCh2YWx1ZS5mZWVQYXllciAhPT0gdm9pZCAwKTtcbiAgICBpZiAodmFsdWUuZmVlUGF5ZXIgIT09IHZvaWQgMCkge1xuICAgICAgc2VyaWFsaXplQWNjb3VudElucHV0KHNlcmlhbGl6ZXIsIHZhbHVlLmZlZVBheWVyKTtcbiAgICB9XG4gICAgY29uc3Qgc2Vjb25kYXJ5U2lnbmVycyA9IHZhbHVlLnNlY29uZGFyeVNpZ25lcnMgPz8gW107XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVVMzJBc1VsZWIxMjgoc2Vjb25kYXJ5U2lnbmVycy5sZW5ndGgpO1xuICAgIGZvciAoY29uc3Qgc2lnbmVyIG9mIHNlY29uZGFyeVNpZ25lcnMpIHtcbiAgICAgIHNlcmlhbGl6ZUFjY291bnRJbnB1dChzZXJpYWxpemVyLCBzaWduZXIpO1xuICAgIH1cbiAgfVxuICBmdW5jdGlvbiBkZXNlcmlhbGl6ZUFyZ3MoZGVzZXJpYWxpemVyLCB2ZXJzaW9uKSB7XG4gICAgY29uc3QgaGFzU2lnbmVyQWRkcmVzcyA9IHZlcnNpb24gPj0gMyAmJiBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVCb29sKCk7XG4gICAgY29uc3Qgc2lnbmVyQWRkcmVzcyA9IGhhc1NpZ25lckFkZHJlc3MgPyBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoQWNjb3VudEFkZHJlc3M4KSA6IHZvaWQgMDtcbiAgICBjb25zdCBuZXR3b3JrID0gdmVyc2lvbiA9PT0gMSA/IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVN0cigpIDogZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplT3B0aW9uU3RyKCk7XG4gICAgaWYgKG5ldHdvcmsgIT09IHZvaWQgMCAmJiAhaXNTdXBwb3J0ZWROZXR3b3JrKG5ldHdvcmspKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIG5ldHdvcmsgJyR7bmV0d29ya30nYCk7XG4gICAgfVxuICAgIGNvbnN0IGhhc1NlbmRlciA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgICBjb25zdCBzZW5kZXIgPSBoYXNTZW5kZXIgPyBkZXNlcmlhbGl6ZUFjY291bnRJbnB1dChkZXNlcmlhbGl6ZXIpIDogdm9pZCAwO1xuICAgIGNvbnN0IGlzUGF5bG9hZEJjc1NlcmlhbGl6YWJsZSA9IHZlcnNpb24gPCA0IHx8IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgICBjb25zdCBwYXlsb2FkID0gaXNQYXlsb2FkQmNzU2VyaWFsaXphYmxlID8gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKFRyYW5zYWN0aW9uUGF5bG9hZDIpIDogZGVzZXJpYWxpemVUcmFuc2FjdGlvblBheWxvYWRJbnB1dChkZXNlcmlhbGl6ZXIpO1xuICAgIGNvbnN0IGV4cGlyYXRpb25TZWNvbmRzRnJvbU5vdyA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICAgIGNvbnN0IGV4cGlyYXRpb25UaW1lc3RhbXAgPSBOdW1iZXIoZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplVTY0KCkpO1xuICAgIGNvbnN0IGdhc1VuaXRQcmljZSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICAgIGNvbnN0IG1heEdhc0Ftb3VudCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICAgIGNvbnN0IGhhc0ZlZVBheWVyID0gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplQm9vbCgpO1xuICAgIGNvbnN0IGZlZVBheWVyID0gaGFzRmVlUGF5ZXIgPyBkZXNlcmlhbGl6ZUFjY291bnRJbnB1dChkZXNlcmlhbGl6ZXIpIDogdm9pZCAwO1xuICAgIGNvbnN0IHNlY29uZGFyeVNpZ25lcnNMZW5ndGggPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVVbGViMTI4QXNVMzIoKTtcbiAgICBjb25zdCBzZWNvbmRhcnlTaWduZXJzID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWNvbmRhcnlTaWduZXJzTGVuZ3RoOyBpICs9IDEpIHtcbiAgICAgIHNlY29uZGFyeVNpZ25lcnMucHVzaChkZXNlcmlhbGl6ZUFjY291bnRJbnB1dChkZXNlcmlhbGl6ZXIpKTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGV4cGlyYXRpb25TZWNvbmRzRnJvbU5vdzogZXhwaXJhdGlvblNlY29uZHNGcm9tTm93ID4gMCA/IGV4cGlyYXRpb25TZWNvbmRzRnJvbU5vdyA6IHZvaWQgMCxcbiAgICAgIGV4cGlyYXRpb25UaW1lc3RhbXA6IGV4cGlyYXRpb25UaW1lc3RhbXAgPiAwID8gZXhwaXJhdGlvblRpbWVzdGFtcCA6IHZvaWQgMCxcbiAgICAgIGZlZVBheWVyLFxuICAgICAgZ2FzVW5pdFByaWNlOiBnYXNVbml0UHJpY2UgPiAwID8gZ2FzVW5pdFByaWNlIDogdm9pZCAwLFxuICAgICAgbWF4R2FzQW1vdW50OiBtYXhHYXNBbW91bnQgPiAwID8gbWF4R2FzQW1vdW50IDogdm9pZCAwLFxuICAgICAgbmV0d29yayxcbiAgICAgIHBheWxvYWQsXG4gICAgICBzZWNvbmRhcnlTaWduZXJzLFxuICAgICAgc2VuZGVyLFxuICAgICAgc2lnbmVyQWRkcmVzc1xuICAgIH07XG4gIH1cbiAgZnVuY3Rpb24gc2VyaWFsaXplKGRhcHBJbmZvLCBhcmdzKSB7XG4gICAgY29uc3QgcmVxdWVzdCA9IHsgYXJncywgZGFwcEluZm8sIG5hbWU6IFNpZ25UcmFuc2FjdGlvblJlcXVlc3QyLm5hbWUsIHZlcnNpb246IFNpZ25UcmFuc2FjdGlvblJlcXVlc3QyLmN1cnJlbnRWZXJzaW9uIH07XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlcXVlc3RXaXRoQXJncyhyZXF1ZXN0LCBzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Mi5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXF1ZXN0KSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplV2FsbGV0UmVxdWVzdFdpdGhBcmdzKFxuICAgICAgc2VyaWFsaXplZFJlcXVlc3QsXG4gICAgICAoZGVzZXJpYWxpemVyKSA9PiBkZXNlcmlhbGl6ZUFyZ3MoZGVzZXJpYWxpemVyLCBzZXJpYWxpemVkUmVxdWVzdC52ZXJzaW9uKVxuICAgICk7XG4gIH1cbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbiAgZnVuY3Rpb24gaXNTZXJpYWxpemVkKHJlcXVlc3QpIHtcbiAgICByZXR1cm4gcmVxdWVzdC5uYW1lID09PSBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Mi5uYW1lICYmIFNpZ25UcmFuc2FjdGlvblJlcXVlc3QyLnN1cHBvcnRlZFZlcnNpb25zLmluY2x1ZGVzKHJlcXVlc3QudmVyc2lvbik7XG4gIH1cbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIuaXNTZXJpYWxpemVkID0gaXNTZXJpYWxpemVkO1xufSkoU2lnblRyYW5zYWN0aW9uUmVxdWVzdCB8fCAoU2lnblRyYW5zYWN0aW9uUmVxdWVzdCA9IHt9KSk7XG5cbi8vIHNyYy9mZWF0dXJlcy9zaWduVHJhbnNhY3Rpb24vcmVzcG9uc2UudHNcbmltcG9ydCB7IEFjY291bnRBdXRoZW50aWNhdG9yIGFzIEFjY291bnRBdXRoZW50aWNhdG9yMiwgUmF3VHJhbnNhY3Rpb24gYXMgUmF3VHJhbnNhY3Rpb24yIH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xudmFyIFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlO1xuKChTaWduVHJhbnNhY3Rpb25SZXNwb25zZTIpID0+IHtcbiAgZnVuY3Rpb24gc2VyaWFsaXplQXBwcm92YWxBcmdzKHNlcmlhbGl6ZXIsIHZhbHVlKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemUodmFsdWUuYXV0aGVudGljYXRvcik7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemVCb29sKHZhbHVlLnJhd1RyYW5zYWN0aW9uICE9PSB2b2lkIDApO1xuICAgIGlmICh2YWx1ZS5yYXdUcmFuc2FjdGlvbiAhPT0gdm9pZCAwKSB7XG4gICAgICBzZXJpYWxpemVyLnNlcmlhbGl6ZSh2YWx1ZS5yYXdUcmFuc2FjdGlvbik7XG4gICAgfVxuICB9XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplQXBwcm92YWxBcmdzKGRlc2VyaWFsaXplcikge1xuICAgIGNvbnN0IGF1dGhlbnRpY2F0b3IgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemUoQWNjb3VudEF1dGhlbnRpY2F0b3IyKTtcbiAgICBjb25zdCBoYXNSYXdUcmFuc2FjdGlvbiA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJvb2woKTtcbiAgICBjb25zdCByYXdUcmFuc2FjdGlvbiA9IGhhc1Jhd1RyYW5zYWN0aW9uID8gZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplKFJhd1RyYW5zYWN0aW9uMikgOiB2b2lkIDA7XG4gICAgcmV0dXJuIHtcbiAgICAgIGF1dGhlbnRpY2F0b3IsXG4gICAgICByYXdUcmFuc2FjdGlvblxuICAgIH07XG4gIH1cbiAgY29uc3Qgc2VyaWFsaXplQXJncyA9IG1ha2VVc2VyUmVzcG9uc2VTZXJpYWxpemVGbihzZXJpYWxpemVBcHByb3ZhbEFyZ3MpO1xuICBjb25zdCBkZXNlcmlhbGl6ZUFyZ3MgPSBtYWtlVXNlclJlc3BvbnNlRGVzZXJpYWxpemVGbihkZXNlcmlhbGl6ZUFwcHJvdmFsQXJncyk7XG4gIGZ1bmN0aW9uIHNlcmlhbGl6ZShhcmdzKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKGFyZ3MsIHNlcmlhbGl6ZUFyZ3MpO1xuICB9XG4gIFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlMi5zZXJpYWxpemUgPSBzZXJpYWxpemU7XG4gIGZ1bmN0aW9uIGRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSkge1xuICAgIHJldHVybiBkZXNlcmlhbGl6ZVdhbGxldFJlc3BvbnNlKHNlcmlhbGl6ZWRSZXNwb25zZSwgZGVzZXJpYWxpemVBcmdzKTtcbiAgfVxuICBTaWduVHJhbnNhY3Rpb25SZXNwb25zZTIuZGVzZXJpYWxpemUgPSBkZXNlcmlhbGl6ZTtcbn0pKFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlIHx8IChTaWduVHJhbnNhY3Rpb25SZXNwb25zZSA9IHt9KSk7XG5cbi8vIHNyYy9tZXNzYWdlcy9jb21tb24udHNcbmZ1bmN0aW9uIGlzVHlwZWRNZXNzYWdlKG1lc3NhZ2VDbHMsIG1lc3NhZ2UpIHtcbiAgcmV0dXJuIG1lc3NhZ2U/Ll9fbWVzc2FnZVR5cGUgPT09IG1lc3NhZ2VDbHMuVFlQRTtcbn1cblxuLy8gc3JjL21lc3NhZ2VzL2JhY2tncm91bmQudHNcbnZhciBfQXB0b3NXYWxsZXRSZXF1ZXN0TWVzc2FnZSA9IGNsYXNzIF9BcHRvc1dhbGxldFJlcXVlc3RNZXNzYWdlIHtcbiAgY29uc3RydWN0b3Iobm9uY2UsIHNlcmlhbGl6ZWRWYWx1ZSkge1xuICAgIHRoaXMubm9uY2UgPSBub25jZTtcbiAgICB0aGlzLnNlcmlhbGl6ZWRWYWx1ZSA9IHNlcmlhbGl6ZWRWYWx1ZTtcbiAgICB0aGlzLl9fbWVzc2FnZVR5cGUgPSBfQXB0b3NXYWxsZXRSZXF1ZXN0TWVzc2FnZS5UWVBFO1xuICB9XG59O1xuX0FwdG9zV2FsbGV0UmVxdWVzdE1lc3NhZ2UuVFlQRSA9IFwiQXB0b3NXYWxsZXRSZXF1ZXN0XCI7XG52YXIgQXB0b3NXYWxsZXRSZXF1ZXN0TWVzc2FnZSA9IF9BcHRvc1dhbGxldFJlcXVlc3RNZXNzYWdlO1xudmFyIF9BcHRvc1dhbGxldFN1Y2Nlc3NSZXNwb25zZU1lc3NhZ2UgPSBjbGFzcyBfQXB0b3NXYWxsZXRTdWNjZXNzUmVzcG9uc2VNZXNzYWdlIHtcbiAgY29uc3RydWN0b3Ioc2VyaWFsaXplZFZhbHVlLCBub25jZSkge1xuICAgIHRoaXMuc2VyaWFsaXplZFZhbHVlID0gc2VyaWFsaXplZFZhbHVlO1xuICAgIHRoaXMubm9uY2UgPSBub25jZTtcbiAgICB0aGlzLl9fbWVzc2FnZVR5cGUgPSBfQXB0b3NXYWxsZXRTdWNjZXNzUmVzcG9uc2VNZXNzYWdlLlRZUEU7XG4gIH1cbn07XG5fQXB0b3NXYWxsZXRTdWNjZXNzUmVzcG9uc2VNZXNzYWdlLlRZUEUgPSBcIkFwdG9zV2FsbGV0U3VjY2Vzc1Jlc3BvbnNlTWVzc2FnZVwiO1xudmFyIEFwdG9zV2FsbGV0U3VjY2Vzc1Jlc3BvbnNlTWVzc2FnZSA9IF9BcHRvc1dhbGxldFN1Y2Nlc3NSZXNwb25zZU1lc3NhZ2U7XG52YXIgX0FwdG9zV2FsbGV0RXJyb3JSZXNwb25zZU1lc3NhZ2UgPSBjbGFzcyBfQXB0b3NXYWxsZXRFcnJvclJlc3BvbnNlTWVzc2FnZSB7XG4gIGNvbnN0cnVjdG9yKGVycm9yLCBub25jZSkge1xuICAgIHRoaXMuZXJyb3IgPSBlcnJvcjtcbiAgICB0aGlzLm5vbmNlID0gbm9uY2U7XG4gICAgdGhpcy5fX21lc3NhZ2VUeXBlID0gX0FwdG9zV2FsbGV0RXJyb3JSZXNwb25zZU1lc3NhZ2UuVFlQRTtcbiAgfVxufTtcbl9BcHRvc1dhbGxldEVycm9yUmVzcG9uc2VNZXNzYWdlLlRZUEUgPSBcIkFwdG9zV2FsbGV0RXJyb3JSZXNwb25zZU1lc3NhZ2VcIjtcbnZhciBBcHRvc1dhbGxldEVycm9yUmVzcG9uc2VNZXNzYWdlID0gX0FwdG9zV2FsbGV0RXJyb3JSZXNwb25zZU1lc3NhZ2U7XG5mdW5jdGlvbiBpc0FwdG9zV2FsbGV0UmVzcG9uc2VNZXNzYWdlKG1lc3NhZ2UpIHtcbiAgcmV0dXJuIGlzVHlwZWRNZXNzYWdlKEFwdG9zV2FsbGV0U3VjY2Vzc1Jlc3BvbnNlTWVzc2FnZSwgbWVzc2FnZSkgfHwgaXNUeXBlZE1lc3NhZ2UoQXB0b3NXYWxsZXRFcnJvclJlc3BvbnNlTWVzc2FnZSwgbWVzc2FnZSk7XG59XG5cbi8vIHNyYy9tZXNzYWdlcy9wcm9tcHQudHNcbmltcG9ydCB7IERlc2VyaWFsaXplciBhcyBEZXNlcmlhbGl6ZXIxNSwgU2VyaWFsaXplciBhcyBTZXJpYWxpemVyMTUgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG52YXIgX1Byb21wdE9wZW5lclBpbmdSZXF1ZXN0TWVzc2FnZSA9IGNsYXNzIF9Qcm9tcHRPcGVuZXJQaW5nUmVxdWVzdE1lc3NhZ2Uge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9fbWVzc2FnZVR5cGUgPSBfUHJvbXB0T3BlbmVyUGluZ1JlcXVlc3RNZXNzYWdlLlRZUEU7XG4gIH1cbn07XG5fUHJvbXB0T3BlbmVyUGluZ1JlcXVlc3RNZXNzYWdlLlRZUEUgPSBcIlByb21wdE9wZW5lclBpbmdSZXF1ZXN0XCI7XG52YXIgUHJvbXB0T3BlbmVyUGluZ1JlcXVlc3RNZXNzYWdlID0gX1Byb21wdE9wZW5lclBpbmdSZXF1ZXN0TWVzc2FnZTtcbnZhciBfUHJvbXB0T3BlbmVyUGluZ1Jlc3BvbnNlTWVzc2FnZSA9IGNsYXNzIF9Qcm9tcHRPcGVuZXJQaW5nUmVzcG9uc2VNZXNzYWdlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgdGhpcy5fX21lc3NhZ2VUeXBlID0gX1Byb21wdE9wZW5lclBpbmdSZXNwb25zZU1lc3NhZ2UuVFlQRTtcbiAgfVxufTtcbl9Qcm9tcHRPcGVuZXJQaW5nUmVzcG9uc2VNZXNzYWdlLlRZUEUgPSBcIlByb21wdE9wZW5lclBpbmdSZXNwb25zZVwiO1xudmFyIFByb21wdE9wZW5lclBpbmdSZXNwb25zZU1lc3NhZ2UgPSBfUHJvbXB0T3BlbmVyUGluZ1Jlc3BvbnNlTWVzc2FnZTtcbnZhciBfUHJvbXB0QXBwcm92YWxSZXNwb25zZU1lc3NhZ2UgPSBjbGFzcyBfUHJvbXB0QXBwcm92YWxSZXNwb25zZU1lc3NhZ2Uge1xuICBjb25zdHJ1Y3RvcihzZXJpYWxpemVkVmFsdWUpIHtcbiAgICB0aGlzLnNlcmlhbGl6ZWRWYWx1ZSA9IHNlcmlhbGl6ZWRWYWx1ZTtcbiAgICB0aGlzLl9fbWVzc2FnZVR5cGUgPSBfUHJvbXB0QXBwcm92YWxSZXNwb25zZU1lc3NhZ2UuVFlQRTtcbiAgfVxufTtcbl9Qcm9tcHRBcHByb3ZhbFJlc3BvbnNlTWVzc2FnZS5UWVBFID0gXCJQcm9tcHRBcHByb3ZhbFJlc3BvbnNlXCI7XG52YXIgUHJvbXB0QXBwcm92YWxSZXNwb25zZU1lc3NhZ2UgPSBfUHJvbXB0QXBwcm92YWxSZXNwb25zZU1lc3NhZ2U7XG52YXIgX1Byb21wdFVuYXV0aG9yaXplZEVycm9yTWVzc2FnZSA9IGNsYXNzIF9Qcm9tcHRVbmF1dGhvcml6ZWRFcnJvck1lc3NhZ2Uge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICB0aGlzLl9fbWVzc2FnZVR5cGUgPSBfUHJvbXB0VW5hdXRob3JpemVkRXJyb3JNZXNzYWdlLlRZUEU7XG4gIH1cbn07XG5fUHJvbXB0VW5hdXRob3JpemVkRXJyb3JNZXNzYWdlLlRZUEUgPSBcIlByb21wdFVuYXV0aG9yaXplZEVycm9yXCI7XG52YXIgUHJvbXB0VW5hdXRob3JpemVkRXJyb3JNZXNzYWdlID0gX1Byb21wdFVuYXV0aG9yaXplZEVycm9yTWVzc2FnZTtcbmZ1bmN0aW9uIHVybEVuY29kZVdhbGxldFJlcXVlc3QocmVxdWVzdCkge1xuICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXIxNSgpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cihyZXF1ZXN0Lm5hbWUpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJ5dGVzKHJlcXVlc3QuZGF0YSk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplU3RyKHJlcXVlc3QudmVyc2lvbi50b1N0cmluZygpKTtcbiAgcmV0dXJuIGJ5dGVzVG9CYXNlNjQoc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKSk7XG59XG5mdW5jdGlvbiB1cmxEZWNvZGVXYWxsZXRSZXF1ZXN0KGVuY29kZWRSZXF1ZXN0KSB7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXIxNShiYXNlNjRUb0J5dGVzKGVuY29kZWRSZXF1ZXN0KSk7XG4gIGNvbnN0IG5hbWUgPSBkZXNlcmlhbGl6ZXIuZGVzZXJpYWxpemVTdHIoKTtcbiAgY29uc3QgZGF0YSA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZUJ5dGVzKCk7XG4gIGxldCB2ZXJzaW9uO1xuICB0cnkge1xuICAgIHZlcnNpb24gPSBOdW1iZXIoZGVzZXJpYWxpemVyLmRlc2VyaWFsaXplU3RyKCkpO1xuICB9IGNhdGNoIHtcbiAgICB2ZXJzaW9uID0gMTtcbiAgfVxuICByZXR1cm4geyBkYXRhLCBuYW1lLCB2ZXJzaW9uIH07XG59XG5cbi8vIHNyYy9Qb3B1cFdhbGxldFJlcXVlc3QudHNcbmltcG9ydCB7XG4gIEFjY291bnRBZGRyZXNzIGFzIEFjY291bnRBZGRyZXNzOSxcbiAgRWQyNTUxOVB1YmxpY0tleSBhcyBFZDI1NTE5UHVibGljS2V5MixcbiAgRWQyNTUxOVNpZ25hdHVyZSBhcyBFZDI1NTE5U2lnbmF0dXJlMixcbiAgU2VyaWFsaXplciBhcyBTZXJpYWxpemVyMTZcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuXG4vLyBzcmMvV2FsbGV0UmVxdWVzdEJvZHkudHNcbmZ1bmN0aW9uIGVuY29kZVdhbGxldFJlcXVlc3RCb2R5KHsgZGF0YSwgLi4ucmVzdCB9KSB7XG4gIGNvbnN0IHNlcmlhbGl6ZWQgPSBKU09OLnN0cmluZ2lmeSh7IGRhdGEsIC4uLnJlc3QgfSwgKGtleSwgdmFsdWUpID0+IGtleSA9PT0gXCJkYXRhXCIgPyBieXRlc1RvQmFzZTY0KHZhbHVlKSA6IHZhbHVlKTtcbiAgY29uc3QgdXRmOEVuY29kZWQgPSBuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc2VyaWFsaXplZCk7XG4gIHJldHVybiBieXRlc1RvQmFzZTY0KHV0ZjhFbmNvZGVkKTtcbn1cbmZ1bmN0aW9uIGRlY29kZVdhbGxldFJlcXVlc3RCb2R5KGVuY29kZWQpIHtcbiAgY29uc3QgdXRmRW5jb2RlZCA9IGJhc2U2NFRvQnl0ZXMoZW5jb2RlZCk7XG4gIGNvbnN0IHNlcmlhbGl6ZWQgPSBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUodXRmRW5jb2RlZCk7XG4gIHJldHVybiBKU09OLnBhcnNlKHNlcmlhbGl6ZWQsIChrZXksIHZhbHVlKSA9PiBrZXkgPT09IFwiZGF0YVwiID8gYmFzZTY0VG9CeXRlcyh2YWx1ZSkgOiB2YWx1ZSk7XG59XG5cbi8vIHNyYy9Qb3B1cFdhbGxldFJlcXVlc3QudHNcbmZ1bmN0aW9uIGVuY29kZVBvcHVwV2FsbGV0UmVxdWVzdChyZXF1ZXN0KSB7XG4gIGNvbnN0IHNlcmlhbGl6ZWQgPSBKU09OLnN0cmluZ2lmeShyZXF1ZXN0LCAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICBjYXNlIFwiYm9keVwiOlxuICAgICAgICByZXR1cm4gZW5jb2RlV2FsbGV0UmVxdWVzdEJvZHkodmFsdWUpO1xuICAgICAgY2FzZSBcImNsaWVudElkZW50aXR5S2V5XCI6XG4gICAgICAgIHJldHVybiBieXRlc1RvQmFzZTY0KHZhbHVlLnRvVWludDhBcnJheSgpKTtcbiAgICAgIGNhc2UgXCJzaWduYXR1cmVcIjpcbiAgICAgICAgcmV0dXJuIGJ5dGVzVG9CYXNlNjQodmFsdWUudG9VaW50OEFycmF5KCkpO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgfSk7XG4gIGNvbnN0IHV0ZjhFbmNvZGVkID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlcmlhbGl6ZWQpO1xuICByZXR1cm4gYnl0ZXNUb0Jhc2U2NHVybCh1dGY4RW5jb2RlZCk7XG59XG5mdW5jdGlvbiBkZWNvZGVQb3B1cFdhbGxldFJlcXVlc3QoZW5jb2RlZCkge1xuICBjb25zdCB1dGZFbmNvZGVkID0gYmFzZTY0dXJsVG9CeXRlcyhlbmNvZGVkKTtcbiAgY29uc3Qgc2VyaWFsaXplZCA9IG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZSh1dGZFbmNvZGVkKTtcbiAgcmV0dXJuIEpTT04ucGFyc2Uoc2VyaWFsaXplZCwgKGtleSwgdmFsdWUpID0+IHtcbiAgICBzd2l0Y2ggKGtleSkge1xuICAgICAgY2FzZSBcImJvZHlcIjpcbiAgICAgICAgcmV0dXJuIGRlY29kZVdhbGxldFJlcXVlc3RCb2R5KHZhbHVlKTtcbiAgICAgIGNhc2UgXCJjbGllbnRJZGVudGl0eUtleVwiOlxuICAgICAgICByZXR1cm4gbmV3IEVkMjU1MTlQdWJsaWNLZXkyKGJhc2U2NFRvQnl0ZXModmFsdWUpKTtcbiAgICAgIGNhc2UgXCJzaWduYXR1cmVcIjpcbiAgICAgICAgcmV0dXJuIG5ldyBFZDI1NTE5U2lnbmF0dXJlMihiYXNlNjRUb0J5dGVzKHZhbHVlKSk7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICB9KTtcbn1cbmZ1bmN0aW9uIG1ha2VQb3B1cFdhbGxldFJlcXVlc3RDaGFsbGVuZ2Uoe1xuICBhY2NvdW50QWRkcmVzcyxcbiAgYm9keSxcbiAgaWQsXG4gIHRpbWVzdGFtcFxufSkge1xuICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXIxNigpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cihcIlNpZ25lZFBvcHVwV2FsbGV0UmVxdWVzdFwiKTtcbiAgc2VyaWFsaXplci5zZXJpYWxpemVTdHIoaWQpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVU2NCh0aW1lc3RhbXApO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZUJvb2woYWNjb3VudEFkZHJlc3MgIT09IHZvaWQgMCk7XG4gIGlmIChhY2NvdW50QWRkcmVzcyAhPT0gdm9pZCAwKSB7XG4gICAgc2VyaWFsaXplci5zZXJpYWxpemUoQWNjb3VudEFkZHJlc3M5LmZyb20oYWNjb3VudEFkZHJlc3MpKTtcbiAgfVxuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVN0cihib2R5Lm5hbWUpO1xuICBzZXJpYWxpemVyLnNlcmlhbGl6ZVU4KGJvZHkudmVyc2lvbik7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplQnl0ZXMoYm9keS5kYXRhKTtcbiAgcmV0dXJuIHNlcmlhbGl6ZXIudG9VaW50OEFycmF5KCk7XG59XG5leHBvcnQge1xuICBBcHRvc1dhbGxldEVycm9yUmVzcG9uc2VNZXNzYWdlLFxuICBBcHRvc1dhbGxldFJlcXVlc3RNZXNzYWdlLFxuICBBcHRvc1dhbGxldFN1Y2Nlc3NSZXNwb25zZU1lc3NhZ2UsXG4gIENvbm5lY3RSZXF1ZXN0LFxuICBDb25uZWN0UmVzcG9uc2UsXG4gIERpc2Nvbm5lY3RSZXF1ZXN0LFxuICBEaXNjb25uZWN0UmVzcG9uc2UsXG4gIEVudHJ5RnVuY3Rpb25Bcmd1bWVudFZhcmlhbnQsXG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdCxcbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZSxcbiAgSXNDb25uZWN0ZWRSZXF1ZXN0LFxuICBJc0Nvbm5lY3RlZFJlc3BvbnNlLFxuICBQcm9tcHRBcHByb3ZhbFJlc3BvbnNlTWVzc2FnZSxcbiAgUHJvbXB0T3BlbmVyUGluZ1JlcXVlc3RNZXNzYWdlLFxuICBQcm9tcHRPcGVuZXJQaW5nUmVzcG9uc2VNZXNzYWdlLFxuICBQcm9tcHRVbmF1dGhvcml6ZWRFcnJvck1lc3NhZ2UsXG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QsXG4gIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlLFxuICBTaWduTWVzc2FnZVJlcXVlc3QsXG4gIFNpZ25NZXNzYWdlUmVzcG9uc2UsXG4gIFNpZ25UcmFuc2FjdGlvblJlcXVlc3QsXG4gIFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlLFxuICBUcmFuc2FjdGlvblBheWxvYWRJbnB1dFZhcmlhbnQsXG4gIGJhc2U2NFRvQnl0ZXMsXG4gIGJhc2U2NHVybFRvQnl0ZXMsXG4gIGJ5dGVzVG9CYXNlNjQsXG4gIGJ5dGVzVG9CYXNlNjR1cmwsXG4gIGNoYWluSWRUb05ldHdvcmssXG4gIGRlY29kZVBvcHVwV2FsbGV0UmVxdWVzdCxcbiAgZGVjb2RlV2FsbGV0UmVxdWVzdEJvZHksXG4gIGRlc2VyaWFsaXplQWNjb3VudEF1dGhlbnRpY2F0b3JJbnB1dCxcbiAgZGVzZXJpYWxpemVBY2NvdW50SW5mbyxcbiAgZGVzZXJpYWxpemVBY2NvdW50SW5wdXQsXG4gIGRlc2VyaWFsaXplRGFwcEluZm8sXG4gIGRlc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZ3VtZW50LFxuICBkZXNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgZGVzZXJpYWxpemVTaWduYXR1cmUsXG4gIGRlc2VyaWFsaXplVHJhbnNhY3Rpb25QYXlsb2FkSW5wdXQsXG4gIGRlc2VyaWFsaXplV2FsbGV0UmVxdWVzdCxcbiAgZGVzZXJpYWxpemVXYWxsZXRSZXF1ZXN0V2l0aEFyZ3MsXG4gIGRlc2VyaWFsaXplV2FsbGV0UmVzcG9uc2UsXG4gIGVuY29kZVBvcHVwV2FsbGV0UmVxdWVzdCxcbiAgZW5jb2RlV2FsbGV0UmVxdWVzdEJvZHksXG4gIGlzQXB0b3NXYWxsZXRSZXNwb25zZU1lc3NhZ2UsXG4gIGlzU3VwcG9ydGVkTmV0d29yayxcbiAgaXNUeXBlZE1lc3NhZ2UsXG4gIG1ha2VQb3B1cFdhbGxldFJlcXVlc3RDaGFsbGVuZ2UsXG4gIG1ha2VVc2VyQXBwcm92YWwsXG4gIG1ha2VVc2VyUmVzcG9uc2VEZXNlcmlhbGl6ZUZuLFxuICBtYWtlVXNlclJlc3BvbnNlU2VyaWFsaXplRm4sXG4gIHNlcmlhbGl6ZUFjY291bnRBdXRoZW50aWNhdG9ySW5wdXQsXG4gIHNlcmlhbGl6ZUFjY291bnRJbmZvLFxuICBzZXJpYWxpemVBY2NvdW50SW5wdXQsXG4gIHNlcmlhbGl6ZURhcHBJbmZvLFxuICBzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJndW1lbnQsXG4gIHNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgc2VyaWFsaXplU2lnbmF0dXJlLFxuICBzZXJpYWxpemVUcmFuc2FjdGlvblBheWxvYWRJbnB1dCxcbiAgc2VyaWFsaXplV2FsbGV0UmVxdWVzdCxcbiAgc2VyaWFsaXplV2FsbGV0UmVxdWVzdFdpdGhBcmdzLFxuICBzZXJpYWxpemVXYWxsZXRSZXNwb25zZSxcbiAgdXJsRGVjb2RlV2FsbGV0UmVxdWVzdCxcbiAgdXJsRW5jb2RlV2FsbGV0UmVxdWVzdFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@aptos-connect/wallet-api/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/crypto/dist/index.mjs":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/crypto/dist/index.mjs ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   AccountConnectionAction: () => (/* binding */ AccountConnectionAction),\n/* harmony export */   DecryptionError: () => (/* binding */ DecryptionError),\n/* harmony export */   EncryptionEnvelopeError: () => (/* binding */ EncryptionEnvelopeError),\n/* harmony export */   EnvelopeMessageMismatchError: () => (/* binding */ EnvelopeMessageMismatchError),\n/* harmony export */   KeyTypes: () => (/* binding */ KeyTypes),\n/* harmony export */   REQUIRED_FIELDS: () => (/* binding */ REQUIRED_FIELDS),\n/* harmony export */   SIGNATURE_PREFIX: () => (/* binding */ SIGNATURE_PREFIX),\n/* harmony export */   aptosAccountToEd25519Keypair: () => (/* binding */ aptosAccountToEd25519Keypair),\n/* harmony export */   aptosAccountToSerializedInfo: () => (/* binding */ aptosAccountToSerializedInfo),\n/* harmony export */   concatUint8array: () => (/* binding */ concatUint8array),\n/* harmony export */   constructMetadata: () => (/* binding */ constructMetadata),\n/* harmony export */   convertEd25519PublicKeyToX25519PublicKey: () => (/* binding */ convertEd25519PublicKeyToX25519PublicKey),\n/* harmony export */   convertEd25519SecretKeyToX25519SecretKey: () => (/* binding */ convertEd25519SecretKeyToX25519SecretKey),\n/* harmony export */   createEd25519KeyPair: () => (/* binding */ createEd25519KeyPair),\n/* harmony export */   createSerializedAccountInfo: () => (/* binding */ createSerializedAccountInfo),\n/* harmony export */   createX25519KeyPair: () => (/* binding */ createX25519KeyPair),\n/* harmony export */   dangerouslyEncryptAndSignEnvelopeUnvalidated: () => (/* binding */ dangerouslyEncryptAndSignEnvelopeUnvalidated),\n/* harmony export */   decodeBase64: () => (/* binding */ decodeBase64),\n/* harmony export */   decryptEnvelope: () => (/* binding */ decryptEnvelope),\n/* harmony export */   decryptMessage: () => (/* binding */ decryptMessage),\n/* harmony export */   decryptMessageDirect: () => (/* binding */ decryptMessageDirect),\n/* harmony export */   decryptObject: () => (/* binding */ decryptObject),\n/* harmony export */   decryptObjectDirect: () => (/* binding */ decryptObjectDirect),\n/* harmony export */   decryptSerializedEncryptionResult: () => (/* binding */ decryptSerializedEncryptionResult),\n/* harmony export */   decryptSerializedEncryptionResultDirect: () => (/* binding */ decryptSerializedEncryptionResultDirect),\n/* harmony export */   deriveAccountTransportEd25519Keypair: () => (/* binding */ deriveAccountTransportEd25519Keypair),\n/* harmony export */   deserializeEd25519PublicKeyB64: () => (/* binding */ deserializeEd25519PublicKeyB64),\n/* harmony export */   deserializeEd25519SignatureB64: () => (/* binding */ deserializeEd25519SignatureB64),\n/* harmony export */   deserializeEncryptionResult: () => (/* binding */ deserializeEncryptionResult),\n/* harmony export */   deserializePublicKeyB64: () => (/* binding */ deserializePublicKeyB64),\n/* harmony export */   deserializeSignatureB64: () => (/* binding */ deserializeSignatureB64),\n/* harmony export */   deserializeTransportEnvelope: () => (/* binding */ deserializeTransportEnvelope),\n/* harmony export */   ed25519KeypairFromSecret: () => (/* binding */ ed25519KeypairFromSecret),\n/* harmony export */   encodeBase64: () => (/* binding */ encodeBase64),\n/* harmony export */   encryptAndSignEnvelope: () => (/* binding */ encryptAndSignEnvelope),\n/* harmony export */   encryptMessage: () => (/* binding */ encryptMessage),\n/* harmony export */   encryptMessageDirect: () => (/* binding */ encryptMessageDirect),\n/* harmony export */   encryptObject: () => (/* binding */ encryptObject),\n/* harmony export */   encryptObjectDirect: () => (/* binding */ encryptObjectDirect),\n/* harmony export */   ensureMetadataFields: () => (/* binding */ ensureMetadataFields),\n/* harmony export */   ensurePrivatePublicFieldsDisjoint: () => (/* binding */ ensurePrivatePublicFieldsDisjoint),\n/* harmony export */   hashAndVerifySignature: () => (/* binding */ hashAndVerifySignature),\n/* harmony export */   keypairToEd25519: () => (/* binding */ keypairToEd25519),\n/* harmony export */   keypairToX25519: () => (/* binding */ keypairToX25519),\n/* harmony export */   makeEd25519SecretKeySignCallbackNoDomainSeparation: () => (/* binding */ makeEd25519SecretKeySignCallbackNoDomainSeparation),\n/* harmony export */   messageHash: () => (/* binding */ messageHash),\n/* harmony export */   publicKeyB64FromEd25519PublicKeyB64: () => (/* binding */ publicKeyB64FromEd25519PublicKeyB64),\n/* harmony export */   serializeEncryptionResult: () => (/* binding */ serializeEncryptionResult),\n/* harmony export */   serializePublicKeyB64: () => (/* binding */ serializePublicKeyB64),\n/* harmony export */   serializeSignatureB64: () => (/* binding */ serializeSignatureB64),\n/* harmony export */   signWithEd25519SecretKey: () => (/* binding */ signWithEd25519SecretKey),\n/* harmony export */   toKey: () => (/* binding */ toKey),\n/* harmony export */   verifyEnvelopeSignature: () => (/* binding */ verifyEnvelopeSignature),\n/* harmony export */   verifySignature: () => (/* binding */ verifySignature)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @noble/hashes/sha3 */ \"(ssr)/./node_modules/@noble/hashes/esm/sha3.js\");\n/* harmony import */ var tweetnacl__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! tweetnacl */ \"(ssr)/./node_modules/tweetnacl/nacl-fast.js\");\n/* harmony import */ var ed2curve__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ed2curve */ \"(ssr)/./node_modules/ed2curve/ed2curve.js\");\n/* harmony import */ var _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @aptos-connect/wallet-api */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@aptos-connect/wallet-api/dist/index.mjs\");\n// src/encrDecr.ts\n\n\n\n\n\n// src/errors.ts\nvar EncryptionEnvelopeError = class extends Error {\n};\nvar EnvelopeMessageMismatchError = class _EnvelopeMessageMismatchError extends EncryptionEnvelopeError {\n  constructor(message, field) {\n    super(message);\n    this.field = field;\n    this.name = \"EnvelopeMessageMismatchError\";\n    Object.setPrototypeOf(this, _EnvelopeMessageMismatchError.prototype);\n  }\n};\nvar DecryptionError = class _DecryptionError extends EncryptionEnvelopeError {\n  constructor(message) {\n    super(message);\n    this.name = \"DecryptionError\";\n    Object.setPrototypeOf(this, _DecryptionError.prototype);\n  }\n};\n\n// src/utils.ts\n\nvar KeyTypes = /* @__PURE__ */ ((KeyTypes2) => {\n  KeyTypes2[\"Ed25519PublicKey\"] = \"Ed25519PublicKey\";\n  KeyTypes2[\"Ed25519SecretKey\"] = \"Ed25519SecretKey\";\n  KeyTypes2[\"X25519PublicKey\"] = \"X25519PublicKey\";\n  KeyTypes2[\"X25519SecretKey\"] = \"X25519SecretKey\";\n  return KeyTypes2;\n})(KeyTypes || {});\nfunction createX25519KeyPair() {\n  return keypairToX25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.keyPair());\n}\nfunction createEd25519KeyPair() {\n  return keypairToEd25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.keyPair());\n}\nfunction toKey(rawKey, type) {\n  return {\n    key: rawKey,\n    type\n  };\n}\nfunction keypairToEd25519(keyPair) {\n  return {\n    publicKey: toKey(keyPair.publicKey, \"Ed25519PublicKey\" /* Ed25519PublicKey */),\n    secretKey: toKey(keyPair.secretKey, \"Ed25519SecretKey\" /* Ed25519SecretKey */)\n  };\n}\nfunction keypairToX25519(keyPair) {\n  return {\n    publicKey: toKey(keyPair.publicKey, \"X25519PublicKey\" /* X25519PublicKey */),\n    secretKey: toKey(keyPair.secretKey, \"X25519SecretKey\" /* X25519SecretKey */)\n  };\n}\nfunction aptosAccountToEd25519Keypair(account) {\n  return ed25519KeypairFromSecret(account.signingKey.secretKey);\n}\nfunction ed25519KeypairFromSecret(ed25519SecretKeyBytes) {\n  return keypairToEd25519(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.keyPair.fromSeed(ed25519SecretKeyBytes.slice(0, 32)));\n}\nfunction decodeBase64(base64Str) {\n  if (globalThis.Buffer) {\n    return new Uint8Array(Buffer.from(base64Str, \"base64\"));\n  }\n  return Uint8Array.from(atob(base64Str), (m) => m.codePointAt(0));\n}\nfunction encodeBase64(bytes) {\n  if (globalThis.Buffer) {\n    return Buffer.from(bytes).toString(\"base64\");\n  }\n  return btoa(Array.from(bytes, (x) => String.fromCodePoint(x)).join(\"\"));\n}\nfunction concatUint8array(arrayOne, arrayTwo) {\n  const mergedArray = new Uint8Array(arrayOne.length + arrayTwo.length);\n  mergedArray.set(arrayOne);\n  mergedArray.set(arrayTwo, arrayOne.length);\n  return mergedArray;\n}\n\n// src/encrDecr.ts\nvar SIGNATURE_PREFIX = \"APTOS::IDENTITY_CONNECT\";\nfunction convertEd25519PublicKeyToX25519PublicKey(ed25519PublicKey, errorKeyName) {\n  const x25519PublicKey = ed2curve__WEBPACK_IMPORTED_MODULE_2__.convertPublicKey(ed25519PublicKey.key.slice(0, 32));\n  if (!x25519PublicKey)\n    throw new Error(`${errorKeyName} is not a valid Ed25519 public key`);\n  return toKey(x25519PublicKey, \"X25519PublicKey\" /* X25519PublicKey */);\n}\nfunction convertEd25519SecretKeyToX25519SecretKey(ed25519SecretKey) {\n  const x25519SecretKey = ed2curve__WEBPACK_IMPORTED_MODULE_2__.convertSecretKey(ed25519SecretKey.key.slice(0, 32));\n  return toKey(x25519SecretKey, \"X25519SecretKey\" /* X25519SecretKey */);\n}\nfunction serializeEncryptionResult(enc) {\n  return {\n    nonceB64: encodeBase64(enc.nonce),\n    securedB64: encodeBase64(enc.secured)\n  };\n}\nfunction deserializeEncryptionResult(enc) {\n  return {\n    nonce: decodeBase64(enc.nonceB64),\n    secured: decodeBase64(enc.securedB64)\n  };\n}\nfunction decryptSerializedEncryptionResult(senderX25519PublicKey, receiverEd25519SecretKey, enc) {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObject(senderX25519PublicKey, receiverEd25519SecretKey, des.secured, des.nonce);\n}\nfunction decryptSerializedEncryptionResultDirect(senderX25519PublicKey, receiverX25519SecretKey, enc) {\n  const des = deserializeEncryptionResult(enc);\n  return decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, des.secured, des.nonce);\n}\nfunction encryptMessage(senderX25519SecretKey, receiverEd25519PublicKey, message) {\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    \"receiver public key\"\n  );\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\nfunction encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, message) {\n  const nonce = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.randomBytes(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.nonceLength);\n  const messageUint8 = new TextEncoder().encode(message);\n  const secured = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box(messageUint8, nonce, receiverX25519PublicKey.key, senderX25519SecretKey.key.slice(0, 32));\n  return { nonce, secured };\n}\nfunction encryptObject(senderX25519SecretKey, receiverEd25519PublicKey, message) {\n  const receiverX25519PublicKey = convertEd25519PublicKeyToX25519PublicKey(\n    receiverEd25519PublicKey,\n    \"receiver public key\"\n  );\n  return encryptObjectDirect(senderX25519SecretKey, receiverX25519PublicKey, message);\n}\nfunction encryptObjectDirect(senderX25519SecretKey, receiverX25519PublicKey, message) {\n  return encryptMessageDirect(senderX25519SecretKey, receiverX25519PublicKey, JSON.stringify(message));\n}\nfunction decryptMessage(senderX25519PublicKey, receiverEd25519SecretKey, securedMessage, nonce) {\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\nfunction decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce) {\n  let decryptedUint8;\n  try {\n    decryptedUint8 = tweetnacl__WEBPACK_IMPORTED_MODULE_1__.box.open(\n      securedMessage,\n      nonce,\n      senderX25519PublicKey.key.slice(0, 32),\n      receiverX25519SecretKey.key.slice(0, 32)\n    );\n  } catch (e) {\n    throw new DecryptionError(`Could not decrypt message: ${e.message}`);\n  }\n  if (!decryptedUint8)\n    throw new DecryptionError(\"Could not decrypt message\");\n  return new TextDecoder().decode(decryptedUint8);\n}\nfunction decryptObject(senderX25519PublicKey, receiverEd25519SecretKey, securedMessage, nonce) {\n  const receiverX25519SecretKey = convertEd25519SecretKeyToX25519SecretKey(receiverEd25519SecretKey);\n  return decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n}\nfunction decryptObjectDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce) {\n  const decryptedStr = decryptMessageDirect(senderX25519PublicKey, receiverX25519SecretKey, securedMessage, nonce);\n  return JSON.parse(decryptedStr);\n}\nfunction messageHash(message, purpose) {\n  const signaturePrefixHash = new Uint8Array((0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(`${SIGNATURE_PREFIX}::${purpose}::`));\n  return new Uint8Array((0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(concatUint8array(signaturePrefixHash, message)));\n}\nfunction signWithEd25519SecretKey(message, signingEd25519SecretKey, purpose) {\n  return tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.detached(messageHash(message, purpose), signingEd25519SecretKey.key);\n}\nfunction makeEd25519SecretKeySignCallbackNoDomainSeparation(signingEd25519SecretKey) {\n  return async (message) => new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(tweetnacl__WEBPACK_IMPORTED_MODULE_1__.sign.detached(message, signingEd25519SecretKey.key));\n}\nfunction verifySignature(message, signature, signingPublicKey, purpose) {\n  return signingPublicKey.verifySignature({ message: messageHash(message, purpose), signature });\n}\nfunction hashAndVerifySignature(message, signature, signingPublicKey, purpose) {\n  const messageUint8 = message instanceof Uint8Array ? message : new TextEncoder().encode(message);\n  const messageUint8Hash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(messageUint8);\n  return verifySignature(messageUint8Hash, signature, signingPublicKey, purpose);\n}\n\n// src/securedEnvelope.ts\n\n\nvar REQUIRED_FIELDS = [\n  \"receiverEd25519PublicKeyB64\",\n  \"senderEd25519PublicKeyB64\",\n  \"senderX25519PublicKeyB64\",\n  \"sequence\",\n  \"timestampMillis\"\n].sort();\nfunction ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage) {\n  const intersection = Object.keys(privateMessage).filter((x) => Object.keys(publicMessage).includes(x));\n  if (intersection.length > 0) {\n    const field = intersection[0];\n    throw new EnvelopeMessageMismatchError(`Field ${field} appears in both private and public message fields`, field);\n  }\n}\nfunction ensureMetadataFields(message) {\n  const messageKeys = Object.keys(message).sort();\n  const extraFields = messageKeys.filter((key) => !REQUIRED_FIELDS.includes(key));\n  const missingFields = REQUIRED_FIELDS.filter((key) => !messageKeys.includes(key));\n  if (extraFields.length > 0 || missingFields.length > 0) {\n    let extraFieldsStr = extraFields.length > 0 ? `extra(${extraFields.join(\", \")})` : \"\";\n    const missingFieldsStr = missingFields.length > 0 ? `missing(${missingFields.join(\", \")})` : \"\";\n    extraFieldsStr = extraFieldsStr.length > 0 && missingFieldsStr.length > 0 ? `${extraFieldsStr}, ` : extraFieldsStr;\n    throw new EnvelopeMessageMismatchError(\n      `PublicMessage metadata fields do not conform to spec: ${extraFieldsStr}${missingFieldsStr}`,\n      \"_metadata\"\n    );\n  }\n}\nfunction deserializeTransportEnvelope(transportEnvelope) {\n  const publicMessage = JSON.parse(transportEnvelope.serializedPublicMessage);\n  return {\n    ...transportEnvelope,\n    publicMessage\n  };\n}\nfunction encryptAndSignEnvelope(senderEd25519SecretKey, senderEd25519PublicKey, receiverEd25519PublicKey, sequence, publicMessage, privateMessage) {\n  const senderEphemeralX25519KeyPair = createX25519KeyPair();\n  const metadata = constructMetadata(\n    senderEd25519PublicKey,\n    receiverEd25519PublicKey,\n    sequence,\n    senderEphemeralX25519KeyPair.publicKey\n  );\n  ensureMetadataFields(metadata);\n  ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage);\n  return dangerouslyEncryptAndSignEnvelopeUnvalidated(\n    senderEd25519SecretKey,\n    receiverEd25519PublicKey,\n    metadata,\n    privateMessage,\n    publicMessage,\n    senderEphemeralX25519KeyPair\n  );\n}\nfunction constructMetadata(senderEd25519PublicKey, receiverEd25519PublicKey, sequence, senderEphemeralX25519PublicKey) {\n  return {\n    receiverEd25519PublicKeyB64: encodeBase64(receiverEd25519PublicKey.key),\n    senderEd25519PublicKeyB64: encodeBase64(senderEd25519PublicKey.key),\n    senderX25519PublicKeyB64: encodeBase64(senderEphemeralX25519PublicKey.key),\n    sequence,\n    timestampMillis: Date.now()\n  };\n}\nfunction dangerouslyEncryptAndSignEnvelopeUnvalidated(senderEd25519SecretKey, receiverEd25519PublicKey, metadata, privateMessage, publicMessage, senderEphemeralX25519KeyPair) {\n  const encryptionResult = encryptObject(\n    senderEphemeralX25519KeyPair.secretKey,\n    receiverEd25519PublicKey,\n    privateMessage\n  );\n  const encryptedPrivateMessage = serializeEncryptionResult(encryptionResult);\n  const encryptedPrivateMessageBytes = decodeBase64(encryptedPrivateMessage.securedB64);\n  const serializedPublicMessage = JSON.stringify({ ...publicMessage, _metadata: metadata });\n  const publicMessageBytes = new TextEncoder().encode(serializedPublicMessage);\n  const messageSignature = signEnvelope(publicMessageBytes, encryptedPrivateMessageBytes, senderEd25519SecretKey);\n  return {\n    encryptedPrivateMessage,\n    messageSignature,\n    serializedPublicMessage\n  };\n}\nfunction combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes) {\n  const publicMessageBytesHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(publicMessageBytes);\n  const privateMessageBytesHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(privateMessageBytes);\n  const combinedHash = new Uint8Array(publicMessageBytesHash.length + privateMessageBytesHash.length);\n  combinedHash.set(publicMessageBytesHash);\n  combinedHash.set(privateMessageBytesHash, publicMessageBytesHash.length);\n  return (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(combinedHash);\n}\nfunction signEnvelope(publicMessageBytes, privateMessageBytes, senderEd25519SecretKey) {\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const signatureBytes = signWithEd25519SecretKey(messageHashBytes, senderEd25519SecretKey, \"SECURED_ENVELOPE\");\n  return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(signatureBytes).toString();\n}\nfunction verifyEnvelopeSignature(publicMessageBytes, privateMessageBytes, messageSignatureInput, senderEd25519PublicKey) {\n  const messageSignature = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(messageSignatureInput).toUint8Array());\n  const senderPublicKey = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(senderEd25519PublicKey.key);\n  const messageHashBytes = combineHashedEnvelopeMessageBytes(publicMessageBytes, privateMessageBytes);\n  const messageVerified = verifySignature(messageHashBytes, messageSignature, senderPublicKey, \"SECURED_ENVELOPE\");\n  if (!messageVerified) {\n    throw new EnvelopeMessageMismatchError(\"Could not verify SecuredEnvelope signature\", \"messageSignature\");\n  }\n}\nfunction decryptEnvelope(senderEd25519PublicKey, receiverEd25519SecretKey, message) {\n  const { encryptedPrivateMessage, messageSignature, serializedPublicMessage } = message;\n  const publicMessage = JSON.parse(serializedPublicMessage);\n  const rawPrivateMessage = decodeBase64(encryptedPrivateMessage.securedB64);\n  const rawPublicMessage = new TextEncoder().encode(serializedPublicMessage);\n  verifyEnvelopeSignature(rawPublicMessage, rawPrivateMessage, messageSignature, senderEd25519PublicKey);\n  const senderEd25519PublicKeyB64 = encodeBase64(senderEd25519PublicKey.key);\n  const expectedPublicKeyB64 = publicMessage._metadata.senderEd25519PublicKeyB64;\n  if (senderEd25519PublicKeyB64 !== expectedPublicKeyB64) {\n    throw new EnvelopeMessageMismatchError(\n      \"senderEd25519PublicKey in envelope does not match provided receiverEd25519SecretKey\",\n      \"senderPublicKey\"\n    );\n  }\n  const senderX25519PublicKeyBytes = decodeBase64(publicMessage._metadata.senderX25519PublicKeyB64);\n  const senderX25519PublicKey = toKey(senderX25519PublicKeyBytes, \"X25519PublicKey\" /* X25519PublicKey */);\n  const encryptionResult = deserializeEncryptionResult(encryptedPrivateMessage);\n  const privateMessage = decryptObject(\n    senderX25519PublicKey,\n    receiverEd25519SecretKey,\n    encryptionResult.secured,\n    encryptionResult.nonce\n  );\n  ensureMetadataFields(publicMessage._metadata);\n  ensurePrivatePublicFieldsDisjoint(privateMessage, publicMessage);\n  return {\n    messageSignature,\n    privateMessage,\n    publicMessage\n  };\n}\n\n// src/serialization.ts\n\n\nfunction serializePublicKeyB64(publicKey) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.serializePublicKey)(serializer, publicKey);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.bytesToBase64)(serializer.toUint8Array());\n}\nfunction deserializePublicKeyB64(publicKeyB64) {\n  const serializedPublicKey = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.base64ToBytes)(publicKeyB64);\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedPublicKey);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.deserializePublicKey)(deserializer);\n}\nfunction deserializeEd25519PublicKeyB64(ed25519PublicKeyB64) {\n  return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519PublicKey(decodeBase64(ed25519PublicKeyB64));\n}\nfunction serializeSignatureB64(signature) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Serializer();\n  (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.serializeSignature)(serializer, signature);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.bytesToBase64)(serializer.toUint8Array());\n}\nfunction deserializeSignatureB64(signatureB64) {\n  const serializedSignature = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.base64ToBytes)(signatureB64);\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedSignature);\n  return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_4__.deserializeSignature)(deserializer);\n}\nfunction deserializeEd25519SignatureB64(ed25519SignatureB64) {\n  const signatureBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(ed25519SignatureB64).toUint8Array();\n  return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Ed25519Signature(signatureBytes);\n}\nfunction publicKeyB64FromEd25519PublicKeyB64(ed25519PublicKeyB64) {\n  const publicKey = deserializeEd25519PublicKeyB64(ed25519PublicKeyB64);\n  return serializePublicKeyB64(publicKey);\n}\n\n// src/walletAccounts.ts\n\n\nvar AccountConnectionAction = /* @__PURE__ */ ((AccountConnectionAction2) => {\n  AccountConnectionAction2[\"ADD\"] = \"add\";\n  AccountConnectionAction2[\"REMOVE\"] = \"remove\";\n  return AccountConnectionAction2;\n})(AccountConnectionAction || {});\nfunction deriveAccountTransportEd25519Keypair(ed25519SecretKeyOrSignCallback, publicKey) {\n  const publicKeyBytes = publicKey instanceof _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.PublicKey ? publicKey.toUint8Array() : publicKey.key;\n  if (ed25519SecretKeyOrSignCallback instanceof Function) {\n    const seedGeneratorBytes = messageHash(publicKeyBytes, \"TRANSPORT_KEYPAIR\");\n    const signature = ed25519SecretKeyOrSignCallback(seedGeneratorBytes);\n    if (signature instanceof Promise) {\n      return signature.then((value) => ed25519KeypairFromSecret(value.toUint8Array()));\n    }\n    return ed25519KeypairFromSecret(signature.toUint8Array());\n  }\n  const seedBytes = signWithEd25519SecretKey(publicKeyBytes, ed25519SecretKeyOrSignCallback, \"TRANSPORT_KEYPAIR\");\n  return ed25519KeypairFromSecret(seedBytes);\n}\nfunction createSerializedAccountInfo(...[\n  signCallback,\n  publicKey,\n  transportEd25519PublicKey,\n  action,\n  intentId,\n  accountAddress\n]) {\n  const authKey = publicKey.authKey();\n  const finalAccountAddress = accountAddress || authKey.derivedAddress().toString();\n  const publicKeyB64 = serializePublicKeyB64(publicKey);\n  const accountInfo = {\n    accountAddress: finalAccountAddress,\n    action,\n    intentId,\n    publicKeyB64,\n    timestampMillis: Date.now(),\n    transportEd25519PublicKeyB64: encodeBase64(transportEd25519PublicKey.key)\n  };\n  const accountInfoSerialized = JSON.stringify(accountInfo);\n  const accountInfoBytes = new TextEncoder().encode(accountInfoSerialized);\n  const accountInfoHash = (0,_noble_hashes_sha3__WEBPACK_IMPORTED_MODULE_3__.sha3_256)(accountInfoBytes);\n  const signature = signCallback(messageHash(accountInfoHash, \"ACCOUNT_INFO\"));\n  if (signature instanceof Promise) {\n    return signature.then((value) => ({\n      accountInfoSerialized,\n      signatureB64: serializeSignatureB64(value)\n    }));\n  }\n  return {\n    accountInfoSerialized,\n    signatureB64: serializeSignatureB64(signature)\n  };\n}\nasync function aptosAccountToSerializedInfo(account, intentId) {\n  const signCallback = async (data) => account.sign(data);\n  const transportKey = await deriveAccountTransportEd25519Keypair(signCallback, account.publicKey);\n  return createSerializedAccountInfo(\n    signCallback,\n    account.publicKey,\n    transportKey.publicKey,\n    \"add\" /* ADD */,\n    intentId\n  );\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC9jcnlwdG8vZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNzRDtBQUNSO0FBQ2hCO0FBQ0U7O0FBRWhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUM2QjtBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLGdCQUFnQjtBQUNqQjtBQUNBLHlCQUF5QiwwQ0FBUTtBQUNqQztBQUNBO0FBQ0EsMEJBQTBCLDJDQUFTO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsMkNBQVM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHNEQUF5QjtBQUNuRDtBQUNBLHVCQUF1QixjQUFjO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixzREFBeUI7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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Q0E7QUFDQTtBQUNBLENBQUMsK0JBQStCO0FBQ2hDO0FBQ0EsOENBQThDLHlEQUFjO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsNERBQVM7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBd0RFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtYm9pbGVycGxhdGUtdGVtcGxhdGUvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC9jcnlwdG8vZGlzdC9pbmRleC5tanM/MTE5ZiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvZW5jckRlY3IudHNcbmltcG9ydCB7IEVkMjU1MTlTaWduYXR1cmUgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5pbXBvcnQgeyBzaGEzXzI1NiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTNcIjtcbmltcG9ydCBuYWNsMiBmcm9tIFwidHdlZXRuYWNsXCI7XG5pbXBvcnQgZWQyY3VydmUgZnJvbSBcImVkMmN1cnZlXCI7XG5cbi8vIHNyYy9lcnJvcnMudHNcbnZhciBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciA9IGNsYXNzIGV4dGVuZHMgRXJyb3Ige1xufTtcbnZhciBFbnZlbG9wZU1lc3NhZ2VNaXNtYXRjaEVycm9yID0gY2xhc3MgX0VudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IgZXh0ZW5kcyBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIGZpZWxkKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5maWVsZCA9IGZpZWxkO1xuICAgIHRoaXMubmFtZSA9IFwiRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xudmFyIERlY3J5cHRpb25FcnJvciA9IGNsYXNzIF9EZWNyeXB0aW9uRXJyb3IgZXh0ZW5kcyBFbmNyeXB0aW9uRW52ZWxvcGVFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UpIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIkRlY3J5cHRpb25FcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfRGVjcnlwdGlvbkVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG5cbi8vIHNyYy91dGlscy50c1xuaW1wb3J0IG5hY2wgZnJvbSBcInR3ZWV0bmFjbFwiO1xudmFyIEtleVR5cGVzID0gLyogQF9fUFVSRV9fICovICgoS2V5VHlwZXMyKSA9PiB7XG4gIEtleVR5cGVzMltcIkVkMjU1MTlQdWJsaWNLZXlcIl0gPSBcIkVkMjU1MTlQdWJsaWNLZXlcIjtcbiAgS2V5VHlwZXMyW1wiRWQyNTUxOVNlY3JldEtleVwiXSA9IFwiRWQyNTUxOVNlY3JldEtleVwiO1xuICBLZXlUeXBlczJbXCJYMjU1MTlQdWJsaWNLZXlcIl0gPSBcIlgyNTUxOVB1YmxpY0tleVwiO1xuICBLZXlUeXBlczJbXCJYMjU1MTlTZWNyZXRLZXlcIl0gPSBcIlgyNTUxOVNlY3JldEtleVwiO1xuICByZXR1cm4gS2V5VHlwZXMyO1xufSkoS2V5VHlwZXMgfHwge30pO1xuZnVuY3Rpb24gY3JlYXRlWDI1NTE5S2V5UGFpcigpIHtcbiAgcmV0dXJuIGtleXBhaXJUb1gyNTUxOShuYWNsLmJveC5rZXlQYWlyKCkpO1xufVxuZnVuY3Rpb24gY3JlYXRlRWQyNTUxOUtleVBhaXIoKSB7XG4gIHJldHVybiBrZXlwYWlyVG9FZDI1NTE5KG5hY2wuc2lnbi5rZXlQYWlyKCkpO1xufVxuZnVuY3Rpb24gdG9LZXkocmF3S2V5LCB0eXBlKSB7XG4gIHJldHVybiB7XG4gICAga2V5OiByYXdLZXksXG4gICAgdHlwZVxuICB9O1xufVxuZnVuY3Rpb24ga2V5cGFpclRvRWQyNTUxOShrZXlQYWlyKSB7XG4gIHJldHVybiB7XG4gICAgcHVibGljS2V5OiB0b0tleShrZXlQYWlyLnB1YmxpY0tleSwgXCJFZDI1NTE5UHVibGljS2V5XCIgLyogRWQyNTUxOVB1YmxpY0tleSAqLyksXG4gICAgc2VjcmV0S2V5OiB0b0tleShrZXlQYWlyLnNlY3JldEtleSwgXCJFZDI1NTE5U2VjcmV0S2V5XCIgLyogRWQyNTUxOVNlY3JldEtleSAqLylcbiAgfTtcbn1cbmZ1bmN0aW9uIGtleXBhaXJUb1gyNTUxOShrZXlQYWlyKSB7XG4gIHJldHVybiB7XG4gICAgcHVibGljS2V5OiB0b0tleShrZXlQYWlyLnB1YmxpY0tleSwgXCJYMjU1MTlQdWJsaWNLZXlcIiAvKiBYMjU1MTlQdWJsaWNLZXkgKi8pLFxuICAgIHNlY3JldEtleTogdG9LZXkoa2V5UGFpci5zZWNyZXRLZXksIFwiWDI1NTE5U2VjcmV0S2V5XCIgLyogWDI1NTE5U2VjcmV0S2V5ICovKVxuICB9O1xufVxuZnVuY3Rpb24gYXB0b3NBY2NvdW50VG9FZDI1NTE5S2V5cGFpcihhY2NvdW50KSB7XG4gIHJldHVybiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQoYWNjb3VudC5zaWduaW5nS2V5LnNlY3JldEtleSk7XG59XG5mdW5jdGlvbiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQoZWQyNTUxOVNlY3JldEtleUJ5dGVzKSB7XG4gIHJldHVybiBrZXlwYWlyVG9FZDI1NTE5KG5hY2wuc2lnbi5rZXlQYWlyLmZyb21TZWVkKGVkMjU1MTlTZWNyZXRLZXlCeXRlcy5zbGljZSgwLCAzMikpKTtcbn1cbmZ1bmN0aW9uIGRlY29kZUJhc2U2NChiYXNlNjRTdHIpIHtcbiAgaWYgKGdsb2JhbFRoaXMuQnVmZmVyKSB7XG4gICAgcmV0dXJuIG5ldyBVaW50OEFycmF5KEJ1ZmZlci5mcm9tKGJhc2U2NFN0ciwgXCJiYXNlNjRcIikpO1xuICB9XG4gIHJldHVybiBVaW50OEFycmF5LmZyb20oYXRvYihiYXNlNjRTdHIpLCAobSkgPT4gbS5jb2RlUG9pbnRBdCgwKSk7XG59XG5mdW5jdGlvbiBlbmNvZGVCYXNlNjQoYnl0ZXMpIHtcbiAgaWYgKGdsb2JhbFRoaXMuQnVmZmVyKSB7XG4gICAgcmV0dXJuIEJ1ZmZlci5mcm9tKGJ5dGVzKS50b1N0cmluZyhcImJhc2U2NFwiKTtcbiAgfVxuICByZXR1cm4gYnRvYShBcnJheS5mcm9tKGJ5dGVzLCAoeCkgPT4gU3RyaW5nLmZyb21Db2RlUG9pbnQoeCkpLmpvaW4oXCJcIikpO1xufVxuZnVuY3Rpb24gY29uY2F0VWludDhhcnJheShhcnJheU9uZSwgYXJyYXlUd28pIHtcbiAgY29uc3QgbWVyZ2VkQXJyYXkgPSBuZXcgVWludDhBcnJheShhcnJheU9uZS5sZW5ndGggKyBhcnJheVR3by5sZW5ndGgpO1xuICBtZXJnZWRBcnJheS5zZXQoYXJyYXlPbmUpO1xuICBtZXJnZWRBcnJheS5zZXQoYXJyYXlUd28sIGFycmF5T25lLmxlbmd0aCk7XG4gIHJldHVybiBtZXJnZWRBcnJheTtcbn1cblxuLy8gc3JjL2VuY3JEZWNyLnRzXG52YXIgU0lHTkFUVVJFX1BSRUZJWCA9IFwiQVBUT1M6OklERU5USVRZX0NPTk5FQ1RcIjtcbmZ1bmN0aW9uIGNvbnZlcnRFZDI1NTE5UHVibGljS2V5VG9YMjU1MTlQdWJsaWNLZXkoZWQyNTUxOVB1YmxpY0tleSwgZXJyb3JLZXlOYW1lKSB7XG4gIGNvbnN0IHgyNTUxOVB1YmxpY0tleSA9IGVkMmN1cnZlLmNvbnZlcnRQdWJsaWNLZXkoZWQyNTUxOVB1YmxpY0tleS5rZXkuc2xpY2UoMCwgMzIpKTtcbiAgaWYgKCF4MjU1MTlQdWJsaWNLZXkpXG4gICAgdGhyb3cgbmV3IEVycm9yKGAke2Vycm9yS2V5TmFtZX0gaXMgbm90IGEgdmFsaWQgRWQyNTUxOSBwdWJsaWMga2V5YCk7XG4gIHJldHVybiB0b0tleSh4MjU1MTlQdWJsaWNLZXksIFwiWDI1NTE5UHVibGljS2V5XCIgLyogWDI1NTE5UHVibGljS2V5ICovKTtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRFZDI1NTE5U2VjcmV0S2V5VG9YMjU1MTlTZWNyZXRLZXkoZWQyNTUxOVNlY3JldEtleSkge1xuICBjb25zdCB4MjU1MTlTZWNyZXRLZXkgPSBlZDJjdXJ2ZS5jb252ZXJ0U2VjcmV0S2V5KGVkMjU1MTlTZWNyZXRLZXkua2V5LnNsaWNlKDAsIDMyKSk7XG4gIHJldHVybiB0b0tleSh4MjU1MTlTZWNyZXRLZXksIFwiWDI1NTE5U2VjcmV0S2V5XCIgLyogWDI1NTE5U2VjcmV0S2V5ICovKTtcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQoZW5jKSB7XG4gIHJldHVybiB7XG4gICAgbm9uY2VCNjQ6IGVuY29kZUJhc2U2NChlbmMubm9uY2UpLFxuICAgIHNlY3VyZWRCNjQ6IGVuY29kZUJhc2U2NChlbmMuc2VjdXJlZClcbiAgfTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplRW5jcnlwdGlvblJlc3VsdChlbmMpIHtcbiAgcmV0dXJuIHtcbiAgICBub25jZTogZGVjb2RlQmFzZTY0KGVuYy5ub25jZUI2NCksXG4gICAgc2VjdXJlZDogZGVjb2RlQmFzZTY0KGVuYy5zZWN1cmVkQjY0KVxuICB9O1xufVxuZnVuY3Rpb24gZGVjcnlwdFNlcmlhbGl6ZWRFbmNyeXB0aW9uUmVzdWx0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBlbmMpIHtcbiAgY29uc3QgZGVzID0gZGVzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuYyk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBkZXMuc2VjdXJlZCwgZGVzLm5vbmNlKTtcbn1cbmZ1bmN0aW9uIGRlY3J5cHRTZXJpYWxpemVkRW5jcnlwdGlvblJlc3VsdERpcmVjdChzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LCBlbmMpIHtcbiAgY29uc3QgZGVzID0gZGVzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuYyk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIGRlcy5zZWN1cmVkLCBkZXMubm9uY2UpO1xufVxuZnVuY3Rpb24gZW5jcnlwdE1lc3NhZ2Uoc2VuZGVyWDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksIG1lc3NhZ2UpIHtcbiAgY29uc3QgcmVjZWl2ZXJYMjU1MTlQdWJsaWNLZXkgPSBjb252ZXJ0RWQyNTUxOVB1YmxpY0tleVRvWDI1NTE5UHVibGljS2V5KFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBcInJlY2VpdmVyIHB1YmxpYyBrZXlcIlxuICApO1xuICByZXR1cm4gZW5jcnlwdE1lc3NhZ2VEaXJlY3Qoc2VuZGVyWDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlclgyNTUxOVB1YmxpY0tleSwgbWVzc2FnZSk7XG59XG5mdW5jdGlvbiBlbmNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBtZXNzYWdlKSB7XG4gIGNvbnN0IG5vbmNlID0gbmFjbDIucmFuZG9tQnl0ZXMobmFjbDIuYm94Lm5vbmNlTGVuZ3RoKTtcbiAgY29uc3QgbWVzc2FnZVVpbnQ4ID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKG1lc3NhZ2UpO1xuICBjb25zdCBzZWN1cmVkID0gbmFjbDIuYm94KG1lc3NhZ2VVaW50OCwgbm9uY2UsIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LmtleSwgc2VuZGVyWDI1NTE5U2VjcmV0S2V5LmtleS5zbGljZSgwLCAzMikpO1xuICByZXR1cm4geyBub25jZSwgc2VjdXJlZCB9O1xufVxuZnVuY3Rpb24gZW5jcnlwdE9iamVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSwgbWVzc2FnZSkge1xuICBjb25zdCByZWNlaXZlclgyNTUxOVB1YmxpY0tleSA9IGNvbnZlcnRFZDI1NTE5UHVibGljS2V5VG9YMjU1MTlQdWJsaWNLZXkoXG4gICAgcmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5LFxuICAgIFwicmVjZWl2ZXIgcHVibGljIGtleVwiXG4gICk7XG4gIHJldHVybiBlbmNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVNlY3JldEtleSwgcmVjZWl2ZXJYMjU1MTlQdWJsaWNLZXksIG1lc3NhZ2UpO1xufVxuZnVuY3Rpb24gZW5jcnlwdE9iamVjdERpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBtZXNzYWdlKSB7XG4gIHJldHVybiBlbmNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlTZWNyZXRLZXksIHJlY2VpdmVyWDI1NTE5UHVibGljS2V5LCBKU09OLnN0cmluZ2lmeShtZXNzYWdlKSk7XG59XG5mdW5jdGlvbiBkZWNyeXB0TWVzc2FnZShzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSwgc2VjdXJlZE1lc3NhZ2UsIG5vbmNlKSB7XG4gIGNvbnN0IHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5ID0gY29udmVydEVkMjU1MTlTZWNyZXRLZXlUb1gyNTUxOVNlY3JldEtleShyZWNlaXZlckVkMjU1MTlTZWNyZXRLZXkpO1xuICByZXR1cm4gZGVjcnlwdE1lc3NhZ2VEaXJlY3Qoc2VuZGVyWDI1NTE5UHVibGljS2V5LCByZWNlaXZlclgyNTUxOVNlY3JldEtleSwgc2VjdXJlZE1lc3NhZ2UsIG5vbmNlKTtcbn1cbmZ1bmN0aW9uIGRlY3J5cHRNZXNzYWdlRGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSkge1xuICBsZXQgZGVjcnlwdGVkVWludDg7XG4gIHRyeSB7XG4gICAgZGVjcnlwdGVkVWludDggPSBuYWNsMi5ib3gub3BlbihcbiAgICAgIHNlY3VyZWRNZXNzYWdlLFxuICAgICAgbm9uY2UsXG4gICAgICBzZW5kZXJYMjU1MTlQdWJsaWNLZXkua2V5LnNsaWNlKDAsIDMyKSxcbiAgICAgIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LmtleS5zbGljZSgwLCAzMilcbiAgICApO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IERlY3J5cHRpb25FcnJvcihgQ291bGQgbm90IGRlY3J5cHQgbWVzc2FnZTogJHtlLm1lc3NhZ2V9YCk7XG4gIH1cbiAgaWYgKCFkZWNyeXB0ZWRVaW50OClcbiAgICB0aHJvdyBuZXcgRGVjcnlwdGlvbkVycm9yKFwiQ291bGQgbm90IGRlY3J5cHQgbWVzc2FnZVwiKTtcbiAgcmV0dXJuIG5ldyBUZXh0RGVjb2RlcigpLmRlY29kZShkZWNyeXB0ZWRVaW50OCk7XG59XG5mdW5jdGlvbiBkZWNyeXB0T2JqZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBzZWN1cmVkTWVzc2FnZSwgbm9uY2UpIHtcbiAgY29uc3QgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXkgPSBjb252ZXJ0RWQyNTUxOVNlY3JldEtleVRvWDI1NTE5U2VjcmV0S2V5KHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSk7XG4gIHJldHVybiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSk7XG59XG5mdW5jdGlvbiBkZWNyeXB0T2JqZWN0RGlyZWN0KHNlbmRlclgyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJYMjU1MTlTZWNyZXRLZXksIHNlY3VyZWRNZXNzYWdlLCBub25jZSkge1xuICBjb25zdCBkZWNyeXB0ZWRTdHIgPSBkZWNyeXB0TWVzc2FnZURpcmVjdChzZW5kZXJYMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyWDI1NTE5U2VjcmV0S2V5LCBzZWN1cmVkTWVzc2FnZSwgbm9uY2UpO1xuICByZXR1cm4gSlNPTi5wYXJzZShkZWNyeXB0ZWRTdHIpO1xufVxuZnVuY3Rpb24gbWVzc2FnZUhhc2gobWVzc2FnZSwgcHVycG9zZSkge1xuICBjb25zdCBzaWduYXR1cmVQcmVmaXhIYXNoID0gbmV3IFVpbnQ4QXJyYXkoc2hhM18yNTYoYCR7U0lHTkFUVVJFX1BSRUZJWH06OiR7cHVycG9zZX06OmApKTtcbiAgcmV0dXJuIG5ldyBVaW50OEFycmF5KHNoYTNfMjU2KGNvbmNhdFVpbnQ4YXJyYXkoc2lnbmF0dXJlUHJlZml4SGFzaCwgbWVzc2FnZSkpKTtcbn1cbmZ1bmN0aW9uIHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShtZXNzYWdlLCBzaWduaW5nRWQyNTUxOVNlY3JldEtleSwgcHVycG9zZSkge1xuICByZXR1cm4gbmFjbDIuc2lnbi5kZXRhY2hlZChtZXNzYWdlSGFzaChtZXNzYWdlLCBwdXJwb3NlKSwgc2lnbmluZ0VkMjU1MTlTZWNyZXRLZXkua2V5KTtcbn1cbmZ1bmN0aW9uIG1ha2VFZDI1NTE5U2VjcmV0S2V5U2lnbkNhbGxiYWNrTm9Eb21haW5TZXBhcmF0aW9uKHNpZ25pbmdFZDI1NTE5U2VjcmV0S2V5KSB7XG4gIHJldHVybiBhc3luYyAobWVzc2FnZSkgPT4gbmV3IEVkMjU1MTlTaWduYXR1cmUobmFjbDIuc2lnbi5kZXRhY2hlZChtZXNzYWdlLCBzaWduaW5nRWQyNTUxOVNlY3JldEtleS5rZXkpKTtcbn1cbmZ1bmN0aW9uIHZlcmlmeVNpZ25hdHVyZShtZXNzYWdlLCBzaWduYXR1cmUsIHNpZ25pbmdQdWJsaWNLZXksIHB1cnBvc2UpIHtcbiAgcmV0dXJuIHNpZ25pbmdQdWJsaWNLZXkudmVyaWZ5U2lnbmF0dXJlKHsgbWVzc2FnZTogbWVzc2FnZUhhc2gobWVzc2FnZSwgcHVycG9zZSksIHNpZ25hdHVyZSB9KTtcbn1cbmZ1bmN0aW9uIGhhc2hBbmRWZXJpZnlTaWduYXR1cmUobWVzc2FnZSwgc2lnbmF0dXJlLCBzaWduaW5nUHVibGljS2V5LCBwdXJwb3NlKSB7XG4gIGNvbnN0IG1lc3NhZ2VVaW50OCA9IG1lc3NhZ2UgaW5zdGFuY2VvZiBVaW50OEFycmF5ID8gbWVzc2FnZSA6IG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShtZXNzYWdlKTtcbiAgY29uc3QgbWVzc2FnZVVpbnQ4SGFzaCA9IHNoYTNfMjU2KG1lc3NhZ2VVaW50OCk7XG4gIHJldHVybiB2ZXJpZnlTaWduYXR1cmUobWVzc2FnZVVpbnQ4SGFzaCwgc2lnbmF0dXJlLCBzaWduaW5nUHVibGljS2V5LCBwdXJwb3NlKTtcbn1cblxuLy8gc3JjL3NlY3VyZWRFbnZlbG9wZS50c1xuaW1wb3J0IHsgRWQyNTUxOVB1YmxpY0tleSBhcyBBcHRvc0VkMjU1MTlQdWJsaWNLZXksIEVkMjU1MTlTaWduYXR1cmUgYXMgRWQyNTUxOVNpZ25hdHVyZTIsIEhleCB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmltcG9ydCB7IHNoYTNfMjU2IGFzIHNoYTNfMjU2MiB9IGZyb20gXCJAbm9ibGUvaGFzaGVzL3NoYTNcIjtcbnZhciBSRVFVSVJFRF9GSUVMRFMgPSBbXG4gIFwicmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5QjY0XCIsXG4gIFwic2VuZGVyRWQyNTUxOVB1YmxpY0tleUI2NFwiLFxuICBcInNlbmRlclgyNTUxOVB1YmxpY0tleUI2NFwiLFxuICBcInNlcXVlbmNlXCIsXG4gIFwidGltZXN0YW1wTWlsbGlzXCJcbl0uc29ydCgpO1xuZnVuY3Rpb24gZW5zdXJlUHJpdmF0ZVB1YmxpY0ZpZWxkc0Rpc2pvaW50KHByaXZhdGVNZXNzYWdlLCBwdWJsaWNNZXNzYWdlKSB7XG4gIGNvbnN0IGludGVyc2VjdGlvbiA9IE9iamVjdC5rZXlzKHByaXZhdGVNZXNzYWdlKS5maWx0ZXIoKHgpID0+IE9iamVjdC5rZXlzKHB1YmxpY01lc3NhZ2UpLmluY2x1ZGVzKHgpKTtcbiAgaWYgKGludGVyc2VjdGlvbi5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgZmllbGQgPSBpbnRlcnNlY3Rpb25bMF07XG4gICAgdGhyb3cgbmV3IEVudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IoYEZpZWxkICR7ZmllbGR9IGFwcGVhcnMgaW4gYm90aCBwcml2YXRlIGFuZCBwdWJsaWMgbWVzc2FnZSBmaWVsZHNgLCBmaWVsZCk7XG4gIH1cbn1cbmZ1bmN0aW9uIGVuc3VyZU1ldGFkYXRhRmllbGRzKG1lc3NhZ2UpIHtcbiAgY29uc3QgbWVzc2FnZUtleXMgPSBPYmplY3Qua2V5cyhtZXNzYWdlKS5zb3J0KCk7XG4gIGNvbnN0IGV4dHJhRmllbGRzID0gbWVzc2FnZUtleXMuZmlsdGVyKChrZXkpID0+ICFSRVFVSVJFRF9GSUVMRFMuaW5jbHVkZXMoa2V5KSk7XG4gIGNvbnN0IG1pc3NpbmdGaWVsZHMgPSBSRVFVSVJFRF9GSUVMRFMuZmlsdGVyKChrZXkpID0+ICFtZXNzYWdlS2V5cy5pbmNsdWRlcyhrZXkpKTtcbiAgaWYgKGV4dHJhRmllbGRzLmxlbmd0aCA+IDAgfHwgbWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgbGV0IGV4dHJhRmllbGRzU3RyID0gZXh0cmFGaWVsZHMubGVuZ3RoID4gMCA/IGBleHRyYSgke2V4dHJhRmllbGRzLmpvaW4oXCIsIFwiKX0pYCA6IFwiXCI7XG4gICAgY29uc3QgbWlzc2luZ0ZpZWxkc1N0ciA9IG1pc3NpbmdGaWVsZHMubGVuZ3RoID4gMCA/IGBtaXNzaW5nKCR7bWlzc2luZ0ZpZWxkcy5qb2luKFwiLCBcIil9KWAgOiBcIlwiO1xuICAgIGV4dHJhRmllbGRzU3RyID0gZXh0cmFGaWVsZHNTdHIubGVuZ3RoID4gMCAmJiBtaXNzaW5nRmllbGRzU3RyLmxlbmd0aCA+IDAgPyBgJHtleHRyYUZpZWxkc1N0cn0sIGAgOiBleHRyYUZpZWxkc1N0cjtcbiAgICB0aHJvdyBuZXcgRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvcihcbiAgICAgIGBQdWJsaWNNZXNzYWdlIG1ldGFkYXRhIGZpZWxkcyBkbyBub3QgY29uZm9ybSB0byBzcGVjOiAke2V4dHJhRmllbGRzU3RyfSR7bWlzc2luZ0ZpZWxkc1N0cn1gLFxuICAgICAgXCJfbWV0YWRhdGFcIlxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplVHJhbnNwb3J0RW52ZWxvcGUodHJhbnNwb3J0RW52ZWxvcGUpIHtcbiAgY29uc3QgcHVibGljTWVzc2FnZSA9IEpTT04ucGFyc2UodHJhbnNwb3J0RW52ZWxvcGUuc2VyaWFsaXplZFB1YmxpY01lc3NhZ2UpO1xuICByZXR1cm4ge1xuICAgIC4uLnRyYW5zcG9ydEVudmVsb3BlLFxuICAgIHB1YmxpY01lc3NhZ2VcbiAgfTtcbn1cbmZ1bmN0aW9uIGVuY3J5cHRBbmRTaWduRW52ZWxvcGUoc2VuZGVyRWQyNTUxOVNlY3JldEtleSwgc2VuZGVyRWQyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5UHVibGljS2V5LCBzZXF1ZW5jZSwgcHVibGljTWVzc2FnZSwgcHJpdmF0ZU1lc3NhZ2UpIHtcbiAgY29uc3Qgc2VuZGVyRXBoZW1lcmFsWDI1NTE5S2V5UGFpciA9IGNyZWF0ZVgyNTUxOUtleVBhaXIoKTtcbiAgY29uc3QgbWV0YWRhdGEgPSBjb25zdHJ1Y3RNZXRhZGF0YShcbiAgICBzZW5kZXJFZDI1NTE5UHVibGljS2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBzZXF1ZW5jZSxcbiAgICBzZW5kZXJFcGhlbWVyYWxYMjU1MTlLZXlQYWlyLnB1YmxpY0tleVxuICApO1xuICBlbnN1cmVNZXRhZGF0YUZpZWxkcyhtZXRhZGF0YSk7XG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludChwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSk7XG4gIHJldHVybiBkYW5nZXJvdXNseUVuY3J5cHRBbmRTaWduRW52ZWxvcGVVbnZhbGlkYXRlZChcbiAgICBzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSxcbiAgICBtZXRhZGF0YSxcbiAgICBwcml2YXRlTWVzc2FnZSxcbiAgICBwdWJsaWNNZXNzYWdlLFxuICAgIHNlbmRlckVwaGVtZXJhbFgyNTUxOUtleVBhaXJcbiAgKTtcbn1cbmZ1bmN0aW9uIGNvbnN0cnVjdE1ldGFkYXRhKHNlbmRlckVkMjU1MTlQdWJsaWNLZXksIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleSwgc2VxdWVuY2UsIHNlbmRlckVwaGVtZXJhbFgyNTUxOVB1YmxpY0tleSkge1xuICByZXR1cm4ge1xuICAgIHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleUI2NDogZW5jb2RlQmFzZTY0KHJlY2VpdmVyRWQyNTUxOVB1YmxpY0tleS5rZXkpLFxuICAgIHNlbmRlckVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NChzZW5kZXJFZDI1NTE5UHVibGljS2V5LmtleSksXG4gICAgc2VuZGVyWDI1NTE5UHVibGljS2V5QjY0OiBlbmNvZGVCYXNlNjQoc2VuZGVyRXBoZW1lcmFsWDI1NTE5UHVibGljS2V5LmtleSksXG4gICAgc2VxdWVuY2UsXG4gICAgdGltZXN0YW1wTWlsbGlzOiBEYXRlLm5vdygpXG4gIH07XG59XG5mdW5jdGlvbiBkYW5nZXJvdXNseUVuY3J5cHRBbmRTaWduRW52ZWxvcGVVbnZhbGlkYXRlZChzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LCByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksIG1ldGFkYXRhLCBwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSwgc2VuZGVyRXBoZW1lcmFsWDI1NTE5S2V5UGFpcikge1xuICBjb25zdCBlbmNyeXB0aW9uUmVzdWx0ID0gZW5jcnlwdE9iamVjdChcbiAgICBzZW5kZXJFcGhlbWVyYWxYMjU1MTlLZXlQYWlyLnNlY3JldEtleSxcbiAgICByZWNlaXZlckVkMjU1MTlQdWJsaWNLZXksXG4gICAgcHJpdmF0ZU1lc3NhZ2VcbiAgKTtcbiAgY29uc3QgZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UgPSBzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0KGVuY3J5cHRpb25SZXN1bHQpO1xuICBjb25zdCBlbmNyeXB0ZWRQcml2YXRlTWVzc2FnZUJ5dGVzID0gZGVjb2RlQmFzZTY0KGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLnNlY3VyZWRCNjQpO1xuICBjb25zdCBzZXJpYWxpemVkUHVibGljTWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KHsgLi4ucHVibGljTWVzc2FnZSwgX21ldGFkYXRhOiBtZXRhZGF0YSB9KTtcbiAgY29uc3QgcHVibGljTWVzc2FnZUJ5dGVzID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlKTtcbiAgY29uc3QgbWVzc2FnZVNpZ25hdHVyZSA9IHNpZ25FbnZlbG9wZShwdWJsaWNNZXNzYWdlQnl0ZXMsIGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlQnl0ZXMsIHNlbmRlckVkMjU1MTlTZWNyZXRLZXkpO1xuICByZXR1cm4ge1xuICAgIGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLFxuICAgIG1lc3NhZ2VTaWduYXR1cmUsXG4gICAgc2VyaWFsaXplZFB1YmxpY01lc3NhZ2VcbiAgfTtcbn1cbmZ1bmN0aW9uIGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpIHtcbiAgY29uc3QgcHVibGljTWVzc2FnZUJ5dGVzSGFzaCA9IHNoYTNfMjU2MihwdWJsaWNNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBwcml2YXRlTWVzc2FnZUJ5dGVzSGFzaCA9IHNoYTNfMjU2Mihwcml2YXRlTWVzc2FnZUJ5dGVzKTtcbiAgY29uc3QgY29tYmluZWRIYXNoID0gbmV3IFVpbnQ4QXJyYXkocHVibGljTWVzc2FnZUJ5dGVzSGFzaC5sZW5ndGggKyBwcml2YXRlTWVzc2FnZUJ5dGVzSGFzaC5sZW5ndGgpO1xuICBjb21iaW5lZEhhc2guc2V0KHB1YmxpY01lc3NhZ2VCeXRlc0hhc2gpO1xuICBjb21iaW5lZEhhc2guc2V0KHByaXZhdGVNZXNzYWdlQnl0ZXNIYXNoLCBwdWJsaWNNZXNzYWdlQnl0ZXNIYXNoLmxlbmd0aCk7XG4gIHJldHVybiBzaGEzXzI1NjIoY29tYmluZWRIYXNoKTtcbn1cbmZ1bmN0aW9uIHNpZ25FbnZlbG9wZShwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMsIHNlbmRlckVkMjU1MTlTZWNyZXRLZXkpIHtcbiAgY29uc3QgbWVzc2FnZUhhc2hCeXRlcyA9IGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShtZXNzYWdlSGFzaEJ5dGVzLCBzZW5kZXJFZDI1NTE5U2VjcmV0S2V5LCBcIlNFQ1VSRURfRU5WRUxPUEVcIik7XG4gIHJldHVybiBIZXguZnJvbUhleElucHV0KHNpZ25hdHVyZUJ5dGVzKS50b1N0cmluZygpO1xufVxuZnVuY3Rpb24gdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUocHVibGljTWVzc2FnZUJ5dGVzLCBwcml2YXRlTWVzc2FnZUJ5dGVzLCBtZXNzYWdlU2lnbmF0dXJlSW5wdXQsIHNlbmRlckVkMjU1MTlQdWJsaWNLZXkpIHtcbiAgY29uc3QgbWVzc2FnZVNpZ25hdHVyZSA9IG5ldyBFZDI1NTE5U2lnbmF0dXJlMihIZXguZnJvbUhleElucHV0KG1lc3NhZ2VTaWduYXR1cmVJbnB1dCkudG9VaW50OEFycmF5KCkpO1xuICBjb25zdCBzZW5kZXJQdWJsaWNLZXkgPSBuZXcgQXB0b3NFZDI1NTE5UHVibGljS2V5KHNlbmRlckVkMjU1MTlQdWJsaWNLZXkua2V5KTtcbiAgY29uc3QgbWVzc2FnZUhhc2hCeXRlcyA9IGNvbWJpbmVIYXNoZWRFbnZlbG9wZU1lc3NhZ2VCeXRlcyhwdWJsaWNNZXNzYWdlQnl0ZXMsIHByaXZhdGVNZXNzYWdlQnl0ZXMpO1xuICBjb25zdCBtZXNzYWdlVmVyaWZpZWQgPSB2ZXJpZnlTaWduYXR1cmUobWVzc2FnZUhhc2hCeXRlcywgbWVzc2FnZVNpZ25hdHVyZSwgc2VuZGVyUHVibGljS2V5LCBcIlNFQ1VSRURfRU5WRUxPUEVcIik7XG4gIGlmICghbWVzc2FnZVZlcmlmaWVkKSB7XG4gICAgdGhyb3cgbmV3IEVudmVsb3BlTWVzc2FnZU1pc21hdGNoRXJyb3IoXCJDb3VsZCBub3QgdmVyaWZ5IFNlY3VyZWRFbnZlbG9wZSBzaWduYXR1cmVcIiwgXCJtZXNzYWdlU2lnbmF0dXJlXCIpO1xuICB9XG59XG5mdW5jdGlvbiBkZWNyeXB0RW52ZWxvcGUoc2VuZGVyRWQyNTUxOVB1YmxpY0tleSwgcmVjZWl2ZXJFZDI1NTE5U2VjcmV0S2V5LCBtZXNzYWdlKSB7XG4gIGNvbnN0IHsgZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UsIG1lc3NhZ2VTaWduYXR1cmUsIHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlIH0gPSBtZXNzYWdlO1xuICBjb25zdCBwdWJsaWNNZXNzYWdlID0gSlNPTi5wYXJzZShzZXJpYWxpemVkUHVibGljTWVzc2FnZSk7XG4gIGNvbnN0IHJhd1ByaXZhdGVNZXNzYWdlID0gZGVjb2RlQmFzZTY0KGVuY3J5cHRlZFByaXZhdGVNZXNzYWdlLnNlY3VyZWRCNjQpO1xuICBjb25zdCByYXdQdWJsaWNNZXNzYWdlID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKHNlcmlhbGl6ZWRQdWJsaWNNZXNzYWdlKTtcbiAgdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUocmF3UHVibGljTWVzc2FnZSwgcmF3UHJpdmF0ZU1lc3NhZ2UsIG1lc3NhZ2VTaWduYXR1cmUsIHNlbmRlckVkMjU1MTlQdWJsaWNLZXkpO1xuICBjb25zdCBzZW5kZXJFZDI1NTE5UHVibGljS2V5QjY0ID0gZW5jb2RlQmFzZTY0KHNlbmRlckVkMjU1MTlQdWJsaWNLZXkua2V5KTtcbiAgY29uc3QgZXhwZWN0ZWRQdWJsaWNLZXlCNjQgPSBwdWJsaWNNZXNzYWdlLl9tZXRhZGF0YS5zZW5kZXJFZDI1NTE5UHVibGljS2V5QjY0O1xuICBpZiAoc2VuZGVyRWQyNTUxOVB1YmxpY0tleUI2NCAhPT0gZXhwZWN0ZWRQdWJsaWNLZXlCNjQpIHtcbiAgICB0aHJvdyBuZXcgRW52ZWxvcGVNZXNzYWdlTWlzbWF0Y2hFcnJvcihcbiAgICAgIFwic2VuZGVyRWQyNTUxOVB1YmxpY0tleSBpbiBlbnZlbG9wZSBkb2VzIG5vdCBtYXRjaCBwcm92aWRlZCByZWNlaXZlckVkMjU1MTlTZWNyZXRLZXlcIixcbiAgICAgIFwic2VuZGVyUHVibGljS2V5XCJcbiAgICApO1xuICB9XG4gIGNvbnN0IHNlbmRlclgyNTUxOVB1YmxpY0tleUJ5dGVzID0gZGVjb2RlQmFzZTY0KHB1YmxpY01lc3NhZ2UuX21ldGFkYXRhLnNlbmRlclgyNTUxOVB1YmxpY0tleUI2NCk7XG4gIGNvbnN0IHNlbmRlclgyNTUxOVB1YmxpY0tleSA9IHRvS2V5KHNlbmRlclgyNTUxOVB1YmxpY0tleUJ5dGVzLCBcIlgyNTUxOVB1YmxpY0tleVwiIC8qIFgyNTUxOVB1YmxpY0tleSAqLyk7XG4gIGNvbnN0IGVuY3J5cHRpb25SZXN1bHQgPSBkZXNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQoZW5jcnlwdGVkUHJpdmF0ZU1lc3NhZ2UpO1xuICBjb25zdCBwcml2YXRlTWVzc2FnZSA9IGRlY3J5cHRPYmplY3QoXG4gICAgc2VuZGVyWDI1NTE5UHVibGljS2V5LFxuICAgIHJlY2VpdmVyRWQyNTUxOVNlY3JldEtleSxcbiAgICBlbmNyeXB0aW9uUmVzdWx0LnNlY3VyZWQsXG4gICAgZW5jcnlwdGlvblJlc3VsdC5ub25jZVxuICApO1xuICBlbnN1cmVNZXRhZGF0YUZpZWxkcyhwdWJsaWNNZXNzYWdlLl9tZXRhZGF0YSk7XG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludChwcml2YXRlTWVzc2FnZSwgcHVibGljTWVzc2FnZSk7XG4gIHJldHVybiB7XG4gICAgbWVzc2FnZVNpZ25hdHVyZSxcbiAgICBwcml2YXRlTWVzc2FnZSxcbiAgICBwdWJsaWNNZXNzYWdlXG4gIH07XG59XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uLnRzXG5pbXBvcnQge1xuICBiYXNlNjRUb0J5dGVzLFxuICBieXRlc1RvQmFzZTY0LFxuICBkZXNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgZGVzZXJpYWxpemVTaWduYXR1cmUsXG4gIHNlcmlhbGl6ZVB1YmxpY0tleSxcbiAgc2VyaWFsaXplU2lnbmF0dXJlXG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5pbXBvcnQge1xuICBEZXNlcmlhbGl6ZXIsXG4gIEVkMjU1MTlQdWJsaWNLZXkgYXMgQXB0b3NFZDI1NTE5UHVibGljS2V5MixcbiAgRWQyNTUxOVNpZ25hdHVyZSBhcyBFZDI1NTE5U2lnbmF0dXJlMyxcbiAgSGV4IGFzIEhleDIsXG4gIFNlcmlhbGl6ZXJcbn0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSkge1xuICBjb25zdCBzZXJpYWxpemVyID0gbmV3IFNlcmlhbGl6ZXIoKTtcbiAgc2VyaWFsaXplUHVibGljS2V5KHNlcmlhbGl6ZXIsIHB1YmxpY0tleSk7XG4gIHJldHVybiBieXRlc1RvQmFzZTY0KHNlcmlhbGl6ZXIudG9VaW50OEFycmF5KCkpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVQdWJsaWNLZXlCNjQocHVibGljS2V5QjY0KSB7XG4gIGNvbnN0IHNlcmlhbGl6ZWRQdWJsaWNLZXkgPSBiYXNlNjRUb0J5dGVzKHB1YmxpY0tleUI2NCk7XG4gIGNvbnN0IGRlc2VyaWFsaXplciA9IG5ldyBEZXNlcmlhbGl6ZXIoc2VyaWFsaXplZFB1YmxpY0tleSk7XG4gIHJldHVybiBkZXNlcmlhbGl6ZVB1YmxpY0tleShkZXNlcmlhbGl6ZXIpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpIHtcbiAgcmV0dXJuIG5ldyBBcHRvc0VkMjU1MTlQdWJsaWNLZXkyKGRlY29kZUJhc2U2NChlZDI1NTE5UHVibGljS2V5QjY0KSk7XG59XG5mdW5jdGlvbiBzZXJpYWxpemVTaWduYXR1cmVCNjQoc2lnbmF0dXJlKSB7XG4gIGNvbnN0IHNlcmlhbGl6ZXIgPSBuZXcgU2VyaWFsaXplcigpO1xuICBzZXJpYWxpemVTaWduYXR1cmUoc2VyaWFsaXplciwgc2lnbmF0dXJlKTtcbiAgcmV0dXJuIGJ5dGVzVG9CYXNlNjQoc2VyaWFsaXplci50b1VpbnQ4QXJyYXkoKSk7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNpZ25hdHVyZUI2NChzaWduYXR1cmVCNjQpIHtcbiAgY29uc3Qgc2VyaWFsaXplZFNpZ25hdHVyZSA9IGJhc2U2NFRvQnl0ZXMoc2lnbmF0dXJlQjY0KTtcbiAgY29uc3QgZGVzZXJpYWxpemVyID0gbmV3IERlc2VyaWFsaXplcihzZXJpYWxpemVkU2lnbmF0dXJlKTtcbiAgcmV0dXJuIGRlc2VyaWFsaXplU2lnbmF0dXJlKGRlc2VyaWFsaXplcik7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUVkMjU1MTlTaWduYXR1cmVCNjQoZWQyNTUxOVNpZ25hdHVyZUI2NCkge1xuICBjb25zdCBzaWduYXR1cmVCeXRlcyA9IEhleDIuZnJvbUhleElucHV0KGVkMjU1MTlTaWduYXR1cmVCNjQpLnRvVWludDhBcnJheSgpO1xuICByZXR1cm4gbmV3IEVkMjU1MTlTaWduYXR1cmUzKHNpZ25hdHVyZUJ5dGVzKTtcbn1cbmZ1bmN0aW9uIHB1YmxpY0tleUI2NEZyb21FZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpIHtcbiAgY29uc3QgcHVibGljS2V5ID0gZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0KGVkMjU1MTlQdWJsaWNLZXlCNjQpO1xuICByZXR1cm4gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSk7XG59XG5cbi8vIHNyYy93YWxsZXRBY2NvdW50cy50c1xuaW1wb3J0IHsgUHVibGljS2V5IGFzIEFwdG9zUHVibGljS2V5IH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuaW1wb3J0IHsgc2hhM18yNTYgYXMgc2hhM18yNTYzIH0gZnJvbSBcIkBub2JsZS9oYXNoZXMvc2hhM1wiO1xudmFyIEFjY291bnRDb25uZWN0aW9uQWN0aW9uID0gLyogQF9fUFVSRV9fICovICgoQWNjb3VudENvbm5lY3Rpb25BY3Rpb24yKSA9PiB7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uMltcIkFERFwiXSA9IFwiYWRkXCI7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uMltcIlJFTU9WRVwiXSA9IFwicmVtb3ZlXCI7XG4gIHJldHVybiBBY2NvdW50Q29ubmVjdGlvbkFjdGlvbjI7XG59KShBY2NvdW50Q29ubmVjdGlvbkFjdGlvbiB8fCB7fSk7XG5mdW5jdGlvbiBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIoZWQyNTUxOVNlY3JldEtleU9yU2lnbkNhbGxiYWNrLCBwdWJsaWNLZXkpIHtcbiAgY29uc3QgcHVibGljS2V5Qnl0ZXMgPSBwdWJsaWNLZXkgaW5zdGFuY2VvZiBBcHRvc1B1YmxpY0tleSA/IHB1YmxpY0tleS50b1VpbnQ4QXJyYXkoKSA6IHB1YmxpY0tleS5rZXk7XG4gIGlmIChlZDI1NTE5U2VjcmV0S2V5T3JTaWduQ2FsbGJhY2sgaW5zdGFuY2VvZiBGdW5jdGlvbikge1xuICAgIGNvbnN0IHNlZWRHZW5lcmF0b3JCeXRlcyA9IG1lc3NhZ2VIYXNoKHB1YmxpY0tleUJ5dGVzLCBcIlRSQU5TUE9SVF9LRVlQQUlSXCIpO1xuICAgIGNvbnN0IHNpZ25hdHVyZSA9IGVkMjU1MTlTZWNyZXRLZXlPclNpZ25DYWxsYmFjayhzZWVkR2VuZXJhdG9yQnl0ZXMpO1xuICAgIGlmIChzaWduYXR1cmUgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICByZXR1cm4gc2lnbmF0dXJlLnRoZW4oKHZhbHVlKSA9PiBlZDI1NTE5S2V5cGFpckZyb21TZWNyZXQodmFsdWUudG9VaW50OEFycmF5KCkpKTtcbiAgICB9XG4gICAgcmV0dXJuIGVkMjU1MTlLZXlwYWlyRnJvbVNlY3JldChzaWduYXR1cmUudG9VaW50OEFycmF5KCkpO1xuICB9XG4gIGNvbnN0IHNlZWRCeXRlcyA9IHNpZ25XaXRoRWQyNTUxOVNlY3JldEtleShwdWJsaWNLZXlCeXRlcywgZWQyNTUxOVNlY3JldEtleU9yU2lnbkNhbGxiYWNrLCBcIlRSQU5TUE9SVF9LRVlQQUlSXCIpO1xuICByZXR1cm4gZWQyNTUxOUtleXBhaXJGcm9tU2VjcmV0KHNlZWRCeXRlcyk7XG59XG5mdW5jdGlvbiBjcmVhdGVTZXJpYWxpemVkQWNjb3VudEluZm8oLi4uW1xuICBzaWduQ2FsbGJhY2ssXG4gIHB1YmxpY0tleSxcbiAgdHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleSxcbiAgYWN0aW9uLFxuICBpbnRlbnRJZCxcbiAgYWNjb3VudEFkZHJlc3Ncbl0pIHtcbiAgY29uc3QgYXV0aEtleSA9IHB1YmxpY0tleS5hdXRoS2V5KCk7XG4gIGNvbnN0IGZpbmFsQWNjb3VudEFkZHJlc3MgPSBhY2NvdW50QWRkcmVzcyB8fCBhdXRoS2V5LmRlcml2ZWRBZGRyZXNzKCkudG9TdHJpbmcoKTtcbiAgY29uc3QgcHVibGljS2V5QjY0ID0gc2VyaWFsaXplUHVibGljS2V5QjY0KHB1YmxpY0tleSk7XG4gIGNvbnN0IGFjY291bnRJbmZvID0ge1xuICAgIGFjY291bnRBZGRyZXNzOiBmaW5hbEFjY291bnRBZGRyZXNzLFxuICAgIGFjdGlvbixcbiAgICBpbnRlbnRJZCxcbiAgICBwdWJsaWNLZXlCNjQsXG4gICAgdGltZXN0YW1wTWlsbGlzOiBEYXRlLm5vdygpLFxuICAgIHRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NCh0cmFuc3BvcnRFZDI1NTE5UHVibGljS2V5LmtleSlcbiAgfTtcbiAgY29uc3QgYWNjb3VudEluZm9TZXJpYWxpemVkID0gSlNPTi5zdHJpbmdpZnkoYWNjb3VudEluZm8pO1xuICBjb25zdCBhY2NvdW50SW5mb0J5dGVzID0gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGFjY291bnRJbmZvU2VyaWFsaXplZCk7XG4gIGNvbnN0IGFjY291bnRJbmZvSGFzaCA9IHNoYTNfMjU2MyhhY2NvdW50SW5mb0J5dGVzKTtcbiAgY29uc3Qgc2lnbmF0dXJlID0gc2lnbkNhbGxiYWNrKG1lc3NhZ2VIYXNoKGFjY291bnRJbmZvSGFzaCwgXCJBQ0NPVU5UX0lORk9cIikpO1xuICBpZiAoc2lnbmF0dXJlIGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgIHJldHVybiBzaWduYXR1cmUudGhlbigodmFsdWUpID0+ICh7XG4gICAgICBhY2NvdW50SW5mb1NlcmlhbGl6ZWQsXG4gICAgICBzaWduYXR1cmVCNjQ6IHNlcmlhbGl6ZVNpZ25hdHVyZUI2NCh2YWx1ZSlcbiAgICB9KSk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBhY2NvdW50SW5mb1NlcmlhbGl6ZWQsXG4gICAgc2lnbmF0dXJlQjY0OiBzZXJpYWxpemVTaWduYXR1cmVCNjQoc2lnbmF0dXJlKVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gYXB0b3NBY2NvdW50VG9TZXJpYWxpemVkSW5mbyhhY2NvdW50LCBpbnRlbnRJZCkge1xuICBjb25zdCBzaWduQ2FsbGJhY2sgPSBhc3luYyAoZGF0YSkgPT4gYWNjb3VudC5zaWduKGRhdGEpO1xuICBjb25zdCB0cmFuc3BvcnRLZXkgPSBhd2FpdCBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIoc2lnbkNhbGxiYWNrLCBhY2NvdW50LnB1YmxpY0tleSk7XG4gIHJldHVybiBjcmVhdGVTZXJpYWxpemVkQWNjb3VudEluZm8oXG4gICAgc2lnbkNhbGxiYWNrLFxuICAgIGFjY291bnQucHVibGljS2V5LFxuICAgIHRyYW5zcG9ydEtleS5wdWJsaWNLZXksXG4gICAgXCJhZGRcIiAvKiBBREQgKi8sXG4gICAgaW50ZW50SWRcbiAgKTtcbn1cbmV4cG9ydCB7XG4gIEFjY291bnRDb25uZWN0aW9uQWN0aW9uLFxuICBEZWNyeXB0aW9uRXJyb3IsXG4gIEVuY3J5cHRpb25FbnZlbG9wZUVycm9yLFxuICBFbnZlbG9wZU1lc3NhZ2VNaXNtYXRjaEVycm9yLFxuICBLZXlUeXBlcyxcbiAgUkVRVUlSRURfRklFTERTLFxuICBTSUdOQVRVUkVfUFJFRklYLFxuICBhcHRvc0FjY291bnRUb0VkMjU1MTlLZXlwYWlyLFxuICBhcHRvc0FjY291bnRUb1NlcmlhbGl6ZWRJbmZvLFxuICBjb25jYXRVaW50OGFycmF5LFxuICBjb25zdHJ1Y3RNZXRhZGF0YSxcbiAgY29udmVydEVkMjU1MTlQdWJsaWNLZXlUb1gyNTUxOVB1YmxpY0tleSxcbiAgY29udmVydEVkMjU1MTlTZWNyZXRLZXlUb1gyNTUxOVNlY3JldEtleSxcbiAgY3JlYXRlRWQyNTUxOUtleVBhaXIsXG4gIGNyZWF0ZVNlcmlhbGl6ZWRBY2NvdW50SW5mbyxcbiAgY3JlYXRlWDI1NTE5S2V5UGFpcixcbiAgZGFuZ2Vyb3VzbHlFbmNyeXB0QW5kU2lnbkVudmVsb3BlVW52YWxpZGF0ZWQsXG4gIGRlY29kZUJhc2U2NCxcbiAgZGVjcnlwdEVudmVsb3BlLFxuICBkZWNyeXB0TWVzc2FnZSxcbiAgZGVjcnlwdE1lc3NhZ2VEaXJlY3QsXG4gIGRlY3J5cHRPYmplY3QsXG4gIGRlY3J5cHRPYmplY3REaXJlY3QsXG4gIGRlY3J5cHRTZXJpYWxpemVkRW5jcnlwdGlvblJlc3VsdCxcbiAgZGVjcnlwdFNlcmlhbGl6ZWRFbmNyeXB0aW9uUmVzdWx0RGlyZWN0LFxuICBkZXJpdmVBY2NvdW50VHJhbnNwb3J0RWQyNTUxOUtleXBhaXIsXG4gIGRlc2VyaWFsaXplRWQyNTUxOVB1YmxpY0tleUI2NCxcbiAgZGVzZXJpYWxpemVFZDI1NTE5U2lnbmF0dXJlQjY0LFxuICBkZXNlcmlhbGl6ZUVuY3J5cHRpb25SZXN1bHQsXG4gIGRlc2VyaWFsaXplUHVibGljS2V5QjY0LFxuICBkZXNlcmlhbGl6ZVNpZ25hdHVyZUI2NCxcbiAgZGVzZXJpYWxpemVUcmFuc3BvcnRFbnZlbG9wZSxcbiAgZWQyNTUxOUtleXBhaXJGcm9tU2VjcmV0LFxuICBlbmNvZGVCYXNlNjQsXG4gIGVuY3J5cHRBbmRTaWduRW52ZWxvcGUsXG4gIGVuY3J5cHRNZXNzYWdlLFxuICBlbmNyeXB0TWVzc2FnZURpcmVjdCxcbiAgZW5jcnlwdE9iamVjdCxcbiAgZW5jcnlwdE9iamVjdERpcmVjdCxcbiAgZW5zdXJlTWV0YWRhdGFGaWVsZHMsXG4gIGVuc3VyZVByaXZhdGVQdWJsaWNGaWVsZHNEaXNqb2ludCxcbiAgaGFzaEFuZFZlcmlmeVNpZ25hdHVyZSxcbiAga2V5cGFpclRvRWQyNTUxOSxcbiAga2V5cGFpclRvWDI1NTE5LFxuICBtYWtlRWQyNTUxOVNlY3JldEtleVNpZ25DYWxsYmFja05vRG9tYWluU2VwYXJhdGlvbixcbiAgbWVzc2FnZUhhc2gsXG4gIHB1YmxpY0tleUI2NEZyb21FZDI1NTE5UHVibGljS2V5QjY0LFxuICBzZXJpYWxpemVFbmNyeXB0aW9uUmVzdWx0LFxuICBzZXJpYWxpemVQdWJsaWNLZXlCNjQsXG4gIHNlcmlhbGl6ZVNpZ25hdHVyZUI2NCxcbiAgc2lnbldpdGhFZDI1NTE5U2VjcmV0S2V5LFxuICB0b0tleSxcbiAgdmVyaWZ5RW52ZWxvcGVTaWduYXR1cmUsXG4gIHZlcmlmeVNpZ25hdHVyZVxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/crypto/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/dist/index.mjs":
/*!******************************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/dist/index.mjs ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ACDappClient: () => (/* binding */ ACDappClient),\n/* harmony export */   ACKeylessClient: () => (/* binding */ ACKeylessClient),\n/* harmony export */   DAPP_PAIRINGS_WINDOW_STORAGE_KEY: () => (/* binding */ DAPP_PAIRINGS_WINDOW_STORAGE_KEY),\n/* harmony export */   ICDappClient: () => (/* binding */ ICDappClient),\n/* harmony export */   windowStateAccessors: () => (/* binding */ windowStateAccessors)\n/* harmony export */ });\n/* harmony import */ var _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-connect/wallet-api */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@aptos-connect/wallet-api/dist/index.mjs\");\n/* harmony import */ var _aptos_connect_web_transport__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aptos-connect/web-transport */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/node_modules/@aptos-connect/web-transport/dist/index.mjs\");\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @identity-connect/api */ \"(ssr)/./node_modules/@identity-connect/api/dist/index.mjs\");\n/* harmony import */ var _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @identity-connect/crypto */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/crypto/dist/index.mjs\");\n/* harmony import */ var _identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @identity-connect/wallet-api */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/node_modules/@identity-connect/wallet-api/dist/index.mjs\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! axios */ \"(ssr)/./node_modules/axios/lib/axios.js\");\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! axios */ \"(ssr)/./node_modules/axios/index.js\");\n// src/ACDappClient.ts\n\n\n\n\n\n\n// src/constants.ts\nvar DEFAULT_FRONTEND_URL = \"https://aptosconnect.app\";\n\n// src/conversion.ts\n\nfunction convertToSerializableArgument(argument) {\n  if (argument === void 0 || argument === null) {\n    return argument;\n  }\n  if (Array.isArray(argument)) {\n    return argument.map((subArgument) => convertToSerializableArgument(subArgument));\n  }\n  if (typeof argument === \"string\" || typeof argument === \"number\" || typeof argument === \"boolean\" || argument instanceof Uint8Array) {\n    return argument;\n  }\n  if (typeof argument === \"bigint\") {\n    return argument.toString();\n  }\n  if (argument instanceof ArrayBuffer) {\n    return new Uint8Array(argument);\n  }\n  if (\"values\" in argument) {\n    return argument.values.map((subArgument) => convertToSerializableArgument(subArgument));\n  }\n  if (\"data\" in argument) {\n    return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(argument.data).toString();\n  }\n  if (argument.value === void 0) {\n    return void 0;\n  }\n  if (typeof argument.value === \"string\" || typeof argument.value === \"number\" || typeof argument.value === \"boolean\" || argument.value instanceof Uint8Array) {\n    return argument.value;\n  }\n  if (typeof argument.value === \"bigint\") {\n    return argument.value.toString();\n  }\n  throw new Error(\"Unexpected argument\");\n}\nfunction normalizePayloadForIC(payload, aptosConfig) {\n  if (\"bcsToBytes\" in payload) {\n    return payload;\n  }\n  if (\"bytecode\" in payload) {\n    return (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateTransactionPayload)(payload);\n  }\n  if (aptosConfig) {\n    return payload.abi !== void 0 ? (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateTransactionPayloadWithABI)({ ...payload, abi: payload.abi }) : (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateTransactionPayload)({ aptosConfig, ...payload });\n  }\n  const entryFunctionPayload = {\n    arguments: payload.functionArguments.map(convertToSerializableArgument),\n    function: payload.function,\n    type: \"entry_function_payload\",\n    type_arguments: (payload.typeArguments ?? []).map((ta) => ta.toString())\n  };\n  return \"multisigAddress\" in payload ? {\n    multisig_address: _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(payload.multisigAddress).toString(),\n    transaction_payload: entryFunctionPayload,\n    type: \"multisig_payload\"\n  } : entryFunctionPayload;\n}\n\n// src/PairingClient.ts\n\n\n\n\n\n\n// src/errors.ts\nvar SignatureRequestError = class _SignatureRequestError extends Error {\n  constructor(status) {\n    super(status);\n    this.name = \"SignatureRequestError\";\n    Object.setPrototypeOf(this, _SignatureRequestError.prototype);\n  }\n};\nvar UnexpectedSignatureResponseError = class _UnexpectedSignatureResponseError extends Error {\n  constructor(missingFields) {\n    const message = `Missing the following fields: ${missingFields.join(\", \")}`;\n    super(message);\n    this.name = \"UnexpectedSignatureResponseError\";\n    Object.setPrototypeOf(this, _UnexpectedSignatureResponseError.prototype);\n  }\n};\nvar PairingExpiredError = class _PairingExpiredError extends Error {\n  constructor() {\n    super();\n    this.name = \"PairingExpiredError\";\n    Object.setPrototypeOf(this, _PairingExpiredError.prototype);\n  }\n};\nvar UnregisteredDappError = class _UnregisteredDappError extends Error {\n  constructor() {\n    super(\"Dapp ID is invalid or not associated with a registered Dapp.\");\n    this.name = \"UnregisteredDappError\";\n    Object.setPrototypeOf(this, _UnregisteredDappError.prototype);\n  }\n};\n\n// src/state.ts\nvar DAPP_PAIRINGS_WINDOW_STORAGE_KEY = \"icDappPairings\";\nvar windowStateAccessors = {\n  async get(address) {\n    const pairings = await this.getAll();\n    return pairings[address];\n  },\n  async getAll() {\n    const serialized = window.localStorage.getItem(DAPP_PAIRINGS_WINDOW_STORAGE_KEY);\n    return serialized ? JSON.parse(serialized) : {};\n  },\n  async update(address, pairing) {\n    const pairings = await this.getAll();\n    if (pairing === void 0) {\n      delete pairings[address];\n    } else {\n      pairings[address] = pairing;\n    }\n    const newSerialized = JSON.stringify(pairings);\n    window.localStorage.setItem(DAPP_PAIRINGS_WINDOW_STORAGE_KEY, newSerialized);\n  }\n};\n\n// src/utils.ts\nvar SIGN_MESSAGE_RESPONSE_REQUIRED_FIELDS = [\n  \"address\",\n  \"application\",\n  \"chainId\",\n  \"fullMessage\",\n  \"message\",\n  \"nonce\",\n  \"prefix\",\n  \"signature\"\n];\nfunction validateSignMessageResponse(response) {\n  const providedFields = new Set(Object.keys(response));\n  const missingFields = SIGN_MESSAGE_RESPONSE_REQUIRED_FIELDS.filter((field) => !providedFields.has(field));\n  if (missingFields.length > 0) {\n    throw new UnexpectedSignatureResponseError(missingFields);\n  }\n}\nvar SIGN_AND_SUBMIT_TRANSACTION_RESPONSE_REQUIRED_FIELDS = [\"hash\"];\nfunction validateSignAndSubmitTransactionResponse(response) {\n  const providedFields = new Set(Object.keys(response));\n  const missingFields = SIGN_AND_SUBMIT_TRANSACTION_RESPONSE_REQUIRED_FIELDS.filter(\n    (field) => !providedFields.has(field)\n  );\n  if (missingFields.length > 0) {\n    throw new UnexpectedSignatureResponseError(missingFields);\n  }\n}\n\n// src/PairingClient.ts\nvar API_VERSION = \"0.2.0\";\nvar SIGNING_REQUEST_POLLING_INTERVAL = 2500;\nvar SEQUENCE_NUMBER_MISMATCH_PATTERN = /^Sequence number mismatch, expected (?:\\S+ to be )?(\\d+)/;\nasync function waitFor(milliseconds) {\n  return new Promise((resolve) => {\n    setTimeout(resolve, milliseconds);\n  });\n}\nasync function withRetries(requestFn, onError, retries = 1) {\n  for (let i = 0; i < retries; i += 1) {\n    try {\n      return await requestFn();\n    } catch (err) {\n      onError(err);\n    }\n  }\n  return requestFn();\n}\nvar ACPairingClient = class {\n  constructor({\n    accessors = windowStateAccessors,\n    axiosConfig,\n    defaultNetworkName = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.NetworkName.MAINNET\n  } = {}) {\n    // endregion\n    this.onDisconnectListeners = /* @__PURE__ */ new Set();\n    this.accessors = accessors;\n    this.defaultNetworkName = defaultNetworkName;\n    this.axiosInstance = axios__WEBPACK_IMPORTED_MODULE_6__[\"default\"].create({\n      baseURL: DEFAULT_FRONTEND_URL,\n      ...axiosConfig\n    });\n    const isClientSideRendering = typeof window !== \"undefined\";\n    this.initPromise = isClientSideRendering ? this.syncFirstPairing() : void 0;\n  }\n  async getPairing(id) {\n    const response = await this.axiosInstance.get(`v1/pairing/${id}/`);\n    return response.data.data.pairing;\n  }\n  async syncFirstPairing() {\n    const pairings = await this.accessors.getAll();\n    const firstPairing = Object.values(pairings)[0];\n    if (firstPairing === void 0) {\n      return;\n    }\n    try {\n      const { dappSpecificWallet, maxDappSequenceNumber } = await this.getPairing(firstPairing.pairingId);\n      await this.accessors.update(firstPairing.accountAddress, {\n        ...firstPairing,\n        currSequenceNumber: maxDappSequenceNumber,\n        dappWalletId: dappSpecificWallet?.id\n      });\n    } catch (err) {\n      await this.accessors.update(firstPairing.accountAddress, void 0);\n    }\n  }\n  async createSigningRequest(pairing, type, networkName, requestBody) {\n    const dappEd25519SecretKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519PublicKeyB64);\n    const accountTransportEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.accountTransportEd25519PublicKeyB64);\n    let sequenceNumber = pairing.currSequenceNumber + 1;\n    return withRetries(\n      async () => {\n        const requestEnvelope = await (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encryptAndSignEnvelope)(\n          (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519SecretKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n          (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n          (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(accountTransportEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n          sequenceNumber,\n          { apiVersion: API_VERSION, networkName, requestType: type },\n          requestBody\n        );\n        const response = await this.axiosInstance.post(\n          `v1/pairing/${pairing.pairingId}/signing-request/`,\n          requestEnvelope\n        );\n        await this.accessors.update(pairing.accountAddress, {\n          ...pairing,\n          currSequenceNumber: sequenceNumber\n        });\n        return response.data.data.signingRequest;\n      },\n      (err) => {\n        if ((0,axios__WEBPACK_IMPORTED_MODULE_7__.isAxiosError)(err)) {\n          const errorMessage = err.response?.data?.message;\n          const expectedSequenceNumber = errorMessage?.match(SEQUENCE_NUMBER_MISMATCH_PATTERN)?.[1];\n          if (expectedSequenceNumber !== void 0) {\n            sequenceNumber = Number(expectedSequenceNumber);\n            return;\n          }\n        }\n        throw err;\n      }\n    );\n  }\n  async getSigningRequest(id) {\n    const response = await this.axiosInstance.get(\n      `v1/signing-request/${id}/`,\n      {\n        validateStatus: (status) => status === 200 || status === 404\n      }\n    );\n    return response.data?.data?.signingRequest;\n  }\n  async deletePairing(pairingId, secretKey, publicKey) {\n    const requestEnvelope = await (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encryptAndSignEnvelope)(\n      secretKey,\n      publicKey,\n      publicKey,\n      0,\n      // ignored\n      {},\n      {}\n    );\n    await this.axiosInstance.post(\n      `v1/pairing/${pairingId}/delete/`,\n      requestEnvelope,\n      { validateStatus: (status) => status === 204 || status === 404 }\n    );\n  }\n  async cancelSigningRequest(pairing, id) {\n    const sequenceNumber = pairing.currSequenceNumber;\n    const dappEd25519SecretKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519PublicKeyB64);\n    const accountTransportEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.accountTransportEd25519PublicKeyB64);\n    const requestEnvelope = await (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encryptAndSignEnvelope)(\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519SecretKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(accountTransportEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n      sequenceNumber + 1,\n      {},\n      {}\n    );\n    const response = await this.axiosInstance.patch(\n      `v1/signing-request/${id}/cancel/`,\n      requestEnvelope\n    );\n    await this.accessors.update(pairing.accountAddress, {\n      ...pairing,\n      currSequenceNumber: sequenceNumber + 1\n    });\n    return response.data.data.signingRequest;\n  }\n  async signRequest(address, type, requestBody, { cancelToken, networkName } = {}) {\n    await this.initPromise;\n    const pairing = await this.accessors.get(address);\n    if (pairing === void 0) {\n      throw new Error(\"The requested account is not paired\");\n    }\n    let signingRequest;\n    try {\n      signingRequest = await this.createSigningRequest(\n        pairing,\n        type,\n        networkName || this.defaultNetworkName,\n        requestBody\n      );\n      while (signingRequest.status === \"PENDING\") {\n        await waitFor(SIGNING_REQUEST_POLLING_INTERVAL);\n        if (cancelToken?.cancelled) {\n          signingRequest.status = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestStatus.CANCELLED;\n          break;\n        }\n        signingRequest = await this.getSigningRequest(signingRequest.id) ?? signingRequest;\n      }\n    } catch (err) {\n      if ((0,axios__WEBPACK_IMPORTED_MODULE_7__.isAxiosError)(err) && err.code === \"404\") {\n        await this.accessors.update(address, void 0);\n        for (const listener of this.onDisconnectListeners) {\n          listener(address);\n        }\n        throw new PairingExpiredError();\n      }\n      throw err;\n    }\n    if (signingRequest.status !== \"APPROVED\") {\n      throw new SignatureRequestError(signingRequest.status);\n    }\n    const decrypted = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decryptEnvelope)(\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)((0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.accountTransportEd25519PublicKeyB64), _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)((0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64), _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n      signingRequest.responseEnvelope\n    );\n    return decrypted.privateMessage;\n  }\n  // region Public API\n  /**\n   * Requests a connection to an account (internally known as pairing).\n   * @returns either the address of the connected account, or undefined if the\n   * connection was cancelled.\n   */\n  async addPairing({ publicKey, secretKey }, finalizedPairing) {\n    await this.accessors.update(finalizedPairing.account.accountAddress, {\n      accountAddress: finalizedPairing.account.accountAddress,\n      accountAlias: finalizedPairing.account.userSubmittedAlias ?? void 0,\n      accountPublicKeyB64: finalizedPairing.account.publicKeyB64,\n      accountTransportEd25519PublicKeyB64: finalizedPairing.account.transportEd25519PublicKeyB64,\n      currSequenceNumber: finalizedPairing.maxDappSequenceNumber,\n      dappEd25519PublicKeyB64: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(publicKey.key),\n      dappEd25519SecretKeyB64: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(secretKey.key),\n      dappWalletId: finalizedPairing.dappSpecificWalletId,\n      pairingId: finalizedPairing.id\n    });\n  }\n  async disconnect(address) {\n    const pairing = await this.accessors.get(address);\n    if (pairing === void 0) {\n      throw new Error(\"The specified account is not paired\");\n    }\n    const dappEd25519SecretKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519SecretKeyB64);\n    const dappEd25519PublicKey = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.decodeBase64)(pairing.dappEd25519PublicKeyB64);\n    await this.deletePairing(\n      pairing.pairingId,\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519SecretKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519SecretKey),\n      (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.toKey)(dappEd25519PublicKey, _identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.KeyTypes.Ed25519PublicKey)\n    );\n    await this.accessors.update(address, void 0);\n    for (const listener of this.onDisconnectListeners) {\n      listener(address);\n    }\n  }\n  async signMessage(address, args, options) {\n    const response = await this.signRequest(\n      address,\n      _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestTypes.SIGN_MESSAGE,\n      args,\n      options\n    );\n    validateSignMessageResponse(response);\n    return response;\n  }\n  async signTransaction(address, args, options) {\n    const serializedRequestArgs = (0,_identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__.serializeSignTransactionRequestArgs)(args);\n    const serializedResponseArgs = await this.signRequest(address, _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestTypes.SIGN_TRANSACTION, serializedRequestArgs, options);\n    return (0,_identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__.deserializeSignTransactionResponseArgs)(serializedResponseArgs);\n  }\n  // endregion\n  async signAndSubmitTransaction(address, args, options) {\n    const serializedRequestArgs = (0,_identity_connect_wallet_api__WEBPACK_IMPORTED_MODULE_5__.serializeSignAndSubmitTransactionRequestArgs)(args);\n    try {\n      const responseArgs = await this.signRequest(address, _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.SigningRequestTypes.SIGN_AND_SUBMIT_TRANSACTION, serializedRequestArgs, options);\n      validateSignAndSubmitTransactionResponse(responseArgs);\n      return responseArgs;\n    } catch (e) {\n      if (e instanceof axios__WEBPACK_IMPORTED_MODULE_7__.AxiosError && e.response?.data?.message) {\n        throw new Error(e.response?.data?.message);\n      }\n      throw e;\n    }\n  }\n  async getConnectedAccounts() {\n    await this.initPromise;\n    const pairings = await this.accessors.getAll();\n    return Object.values(pairings).map(\n      ({ accountAddress, accountEd25519PublicKeyB64, accountPublicKeyB64 }) => ({\n        address: _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(accountAddress),\n        publicKey: accountPublicKeyB64 !== void 0 ? (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.deserializePublicKeyB64)(accountPublicKeyB64) : (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.deserializeEd25519PublicKeyB64)(accountEd25519PublicKeyB64)\n      })\n    );\n  }\n  onDisconnect(listener) {\n    this.onDisconnectListeners.add(listener);\n    return () => this.onDisconnectListeners.delete(listener);\n  }\n};\n\n// src/ACDappClient.ts\nvar ACDappClient = class {\n  constructor({\n    backendBaseURL,\n    dappId,\n    dappImageURI,\n    dappName,\n    defaultNetworkName = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.NetworkName.MAINNET,\n    frontendBaseURL = DEFAULT_FRONTEND_URL\n  } = {}) {\n    this.defaultNetworkName = defaultNetworkName;\n    this.dappInfo = {\n      domain: window.location.origin,\n      imageURI: dappImageURI,\n      name: dappName ?? document.title\n    };\n    this.transport = new _aptos_connect_web_transport__WEBPACK_IMPORTED_MODULE_1__.WebWalletTransport(frontendBaseURL);\n    this.dappId = dappId;\n    this.pairingClient = new ACPairingClient({\n      axiosConfig: {\n        baseURL: backendBaseURL ?? frontendBaseURL\n      },\n      defaultNetworkName\n    });\n  }\n  // region Public API\n  async getKeylessAccounts() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async getIcAccounts() {\n    return this.pairingClient.getConnectedAccounts() ?? [];\n  }\n  async isIcAccount(address) {\n    const icAccounts = await this.getIcAccounts();\n    return icAccounts.find((account) => account.address.equals(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(address))) !== void 0;\n  }\n  async getConnectedAccounts() {\n    const keylessAccounts = await this.getKeylessAccounts();\n    const icAccounts = await this.getIcAccounts();\n    return [...keylessAccounts, ...icAccounts];\n  }\n  async disconnect(address) {\n    if (await this.isIcAccount(address)) {\n      const stringAddress = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AccountAddress.from(address).toString();\n      await this.pairingClient.disconnect(stringAddress);\n    } else {\n      const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectRequest.serialize(this.dappInfo);\n      await this.transport.sendRequest(serializedRequest);\n    }\n  }\n  async connect({ preferredWalletName } = {}) {\n    const dappKeypair = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.createEd25519KeyPair)();\n    const injectedPreferredWalletName = typeof window !== \"undefined\" ? window.AC_PREFERRED_WALLET_NAME : void 0;\n    const requestArgs = {\n      dappEd25519PublicKeyB64: (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(dappKeypair.publicKey.key),\n      dappId: this.dappId,\n      preferredWalletName: preferredWalletName ?? injectedPreferredWalletName\n    };\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectRequest.serialize(this.dappInfo, requestArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.deserialize(serializedResponse);\n    if (response.args.status === \"approved\") {\n      const { account, pairing } = response.args.args;\n      if (pairing) {\n        await this.pairingClient.addPairing(dappKeypair, pairing);\n      }\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({ account });\n    }\n    return response.args;\n  }\n  async signMessage(args) {\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const { chainId } = args;\n      const network = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.chainIdToNetwork)(chainId);\n      let message;\n      let nonce;\n      try {\n        message = new TextDecoder().decode(args.message);\n        nonce = new TextDecoder().decode(args.nonce);\n      } catch (err) {\n        throw new Error(\"Only UTF-8 encoded text is supported when using IC\");\n      }\n      const { fullMessage, signature: hexSignature } = await this.pairingClient.signMessage(\n        signerAddress.toString(),\n        {\n          address: true,\n          application: true,\n          chainId: true,\n          message,\n          nonce\n        },\n        { networkName: network }\n      );\n      const signatureBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Hex.fromHexInput(hexSignature).toUint8Array();\n      const signature = signatureBytes.length === _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Ed25519Signature.LENGTH ? new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Ed25519Signature(signatureBytes) : _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AnySignature.deserialize(new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.Deserializer(signatureBytes));\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({\n        fullMessage,\n        signature\n      });\n    }\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signTransaction(args) {\n    const normalizedArgs = \"transaction\" in args ? _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.normalizeArgs(args) : args;\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const {\n        expirationSecondsFromNow,\n        expirationTimestamp,\n        feePayer,\n        gasUnitPrice,\n        maxGasAmount,\n        network,\n        payload,\n        secondarySigners,\n        sender,\n        sequenceNumber\n      } = normalizedArgs;\n      if (feePayer !== void 0) {\n        throw new Error(\"Sponsored transaction not currently supported\");\n      }\n      if (secondarySigners && secondarySigners.length > 0) {\n        throw new Error(\"Multi-agent transactions not currently supported\");\n      }\n      if (!(\"bcsToBytes\" in payload)) {\n        throw new Error(\"Payload input format is only supported with Keyless accounts.\");\n      }\n      const responseArgs = await this.pairingClient.signTransaction(\n        signerAddress.toString(),\n        {\n          options: {\n            expirationSecondsFromNow,\n            expirationTimestamp,\n            gasUnitPrice,\n            maxGasAmount,\n            sender: sender?.address.toString(),\n            sequenceNumber: sequenceNumber !== void 0 ? Number(sequenceNumber) : void 0\n          },\n          payload\n        },\n        {\n          networkName: network\n        }\n      );\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({\n        authenticator: responseArgs.accountAuthenticator,\n        rawTransaction: responseArgs.rawTxn\n      });\n    }\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.serialize(this.dappInfo, normalizedArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signAndSubmitTransaction(args) {\n    const { signerAddress } = args;\n    if (await this.isIcAccount(signerAddress)) {\n      const { expirationTimestamp, feePayer, gasUnitPrice, maxGasAmount, network } = args;\n      const aptosConfig = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.AptosConfig({ network });\n      let convertedArgs;\n      if (feePayer !== void 0) {\n        const payload = await normalizePayloadForIC(args.payload, aptosConfig);\n        const rawTxn = await (0,_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.generateRawTransaction)({\n          aptosConfig,\n          feePayerAddress: feePayer.address,\n          options: {\n            gasUnitPrice,\n            maxGasAmount\n          },\n          payload,\n          sender: signerAddress\n        });\n        convertedArgs = {\n          feePayerAuthenticator: feePayer.authenticator,\n          rawTxn: new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_2__.FeePayerRawTransaction(rawTxn, [], feePayer.address)\n        };\n      } else {\n        const payload = normalizePayloadForIC(args.payload);\n        convertedArgs = {\n          options: {\n            expirationTimestamp,\n            gasUnitPrice,\n            maxGasAmount\n          },\n          payload\n        };\n      }\n      const { hash } = await this.pairingClient.signAndSubmitTransaction(signerAddress.toString(), convertedArgs, {\n        networkName: network\n      });\n      return (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makeUserApproval)({ txnHash: hash });\n    }\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  // endregion\n};\n\n// src/ICDappClient.ts\n\n\n\n// src/prompt.ts\nvar DEFAULT_PROMPT_SIZE = { height: 695, width: 465 };\nvar PROMPT_POLLER_INTERVAL = 500;\nfunction openPrompt(url, size = DEFAULT_PROMPT_SIZE) {\n  const { height, width } = size;\n  const options = {\n    height,\n    left: window.screenLeft + Math.round((window.outerWidth - width) / 2),\n    popup: true,\n    top: window.screenTop + Math.round((window.outerHeight - height) / 2),\n    width\n  };\n  const strOptions = Object.entries(options).map(([key, value]) => `${key}=${JSON.stringify(value)}`).reduce((acc, entry) => `${acc}, ${entry}`);\n  const href = url instanceof URL ? url.href : url;\n  const promptWindow = window.open(href, void 0, strOptions);\n  if (promptWindow === null) {\n    throw new Error(\"Couldn't open prompt\");\n  }\n  return promptWindow;\n}\nasync function waitForPromptResponse(promptWindow) {\n  return new Promise((resolve) => {\n    const listeners = {\n      onMessage: (message) => {\n        if (message.source !== promptWindow) {\n          return;\n        }\n        window.removeEventListener(\"message\", listeners.onMessage);\n        clearTimeout(listeners.promptPollerId);\n        resolve({\n          args: message.data,\n          status: \"approved\"\n        });\n      },\n      promptPollerId: setInterval(() => {\n        if (promptWindow.closed) {\n          window.removeEventListener(\"message\", listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve({\n            status: \"dismissed\"\n          });\n        }\n      }, PROMPT_POLLER_INTERVAL)\n    };\n    window.addEventListener(\"message\", listeners.onMessage);\n  });\n}\n\n// src/ICDappClient.ts\nvar ICDappClient = class extends ACPairingClient {\n  constructor(dappId, { frontendBaseURL = DEFAULT_FRONTEND_URL, ...pairingClientConfig } = {}) {\n    super(pairingClientConfig);\n    this.dappId = dappId;\n    this.frontendBaseURL = frontendBaseURL;\n  }\n  async createPairingRequest(dappEd25519PublicKeyB64) {\n    try {\n      const response = await this.axiosInstance.post(\"v1/pairing/\", {\n        dappEd25519PublicKeyB64,\n        dappId: this.dappId\n      });\n      return response.data.data.pairing;\n    } catch (err) {\n      if ((0,axios__WEBPACK_IMPORTED_MODULE_7__.isAxiosError)(err) && err.response?.data?.message === \"Dapp not found\") {\n        throw new UnregisteredDappError();\n      }\n      throw err;\n    }\n  }\n  // region Public API\n  /**\n   * Requests a connection to an account (internally known as pairing).\n   * @returns either the address of the connected account, or undefined if the\n   * connection was cancelled.\n   */\n  async connect() {\n    const { publicKey, secretKey } = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.createEd25519KeyPair)();\n    const dappEd25519PublicKeyB64 = (0,_identity_connect_crypto__WEBPACK_IMPORTED_MODULE_4__.encodeBase64)(publicKey.key);\n    const url = new URL(`${this.frontendBaseURL}/pairing`);\n    const promptWindow = await openPrompt(url.href);\n    let pairingId;\n    try {\n      const pendingPairing = await this.createPairingRequest(dappEd25519PublicKeyB64);\n      pairingId = pendingPairing.id;\n    } catch (err) {\n      promptWindow.close();\n      throw err;\n    }\n    url.searchParams.set(\"pairingId\", pairingId);\n    promptWindow.location.href = url.href;\n    const promptResponse = await waitForPromptResponse(promptWindow);\n    if (promptResponse.status === \"dismissed\") {\n      void this.deletePairing(pairingId, secretKey, publicKey);\n      return void 0;\n    }\n    const finalizedPairing = promptResponse.args;\n    await this.addPairing({ publicKey, secretKey }, finalizedPairing);\n    return finalizedPairing.account.accountAddress;\n  }\n  async offboard(address) {\n    const pairing = await this.accessors.get(address);\n    if (pairing === void 0) {\n      throw new Error(\"This account is not paired\");\n    }\n    const walletId = pairing.dappWalletId;\n    if (walletId === void 0) {\n      throw new Error(\"This account cannot be offboarded\");\n    }\n    const url = new URL(`${this.frontendBaseURL}/offboarding?walletId=${walletId}`);\n    const promptWindow = openPrompt(url);\n    const response = await waitForPromptResponse(promptWindow);\n    if (response.status === \"approved\" && response.args.offboarded) {\n      this.disconnect(address);\n      return true;\n    }\n    return false;\n  }\n  // endregion\n};\n\n// src/KeylessClient.ts\n\n\n\nvar ACKeylessClient = class {\n  constructor({\n    dappImageURI,\n    dappName,\n    defaultNetworkName = _identity_connect_api__WEBPACK_IMPORTED_MODULE_3__.NetworkName.MAINNET,\n    frontendBaseURL = DEFAULT_FRONTEND_URL\n  } = {}) {\n    this.defaultNetworkName = defaultNetworkName;\n    this.dappInfo = {\n      domain: window.location.origin,\n      imageURI: dappImageURI,\n      name: dappName ?? document.title\n    };\n    this.transport = new _aptos_connect_web_transport__WEBPACK_IMPORTED_MODULE_1__.WebWalletTransport(frontendBaseURL);\n  }\n  // region Public API\n  async isConnected() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async getConnectedAccounts() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async disconnect() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectRequest.serialize(this.dappInfo);\n    await this.transport.sendRequest(serializedRequest);\n  }\n  async connect() {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectRequest.serialize(this.dappInfo);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signMessage(args) {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signTransaction(args) {\n    const normalizedArgs = \"transaction\" in args ? _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.normalizeArgs(args) : args;\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.serialize(this.dappInfo, normalizedArgs);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  async signAndSubmitTransaction(args) {\n    const serializedRequest = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionRequest.serialize(this.dappInfo, args);\n    const serializedResponse = await this.transport.sendRequest(serializedRequest);\n    const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionResponse.deserialize(serializedResponse);\n    return response.args;\n  }\n  // endregion\n};\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC9kYXBwLXNkay9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFlbUM7QUFDK0I7QUFVdEM7QUFDd0M7QUFDMkI7O0FBRS9GO0FBQ0E7O0FBRUE7QUFLNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsOERBQWM7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsOEVBQTBCO0FBQ3JDO0FBQ0E7QUFDQSxvQ0FBb0MscUZBQWlDLEdBQUcsOEJBQThCLElBQUksOEVBQTBCLEdBQUcseUJBQXlCO0FBQ2hLO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsOERBQWM7QUFDcEM7QUFDQTtBQUNBLElBQUk7QUFDSjs7QUFFQTtBQUN1RTtBQUt4QztBQVVHO0FBS0k7QUFDa0I7O0FBRXhEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscURBQXFELHlCQUF5QjtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0Esa0JBQWtCLGFBQWE7QUFDL0I7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsOERBQVc7QUFDcEMsSUFBSSxJQUFJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsNkNBQUs7QUFDOUI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdFQUFnRSxHQUFHO0FBQ25FO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNENBQTRDO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxzRUFBWTtBQUM3QyxpQ0FBaUMsc0VBQVk7QUFDN0MsNkNBQTZDLHNFQUFZO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxnRkFBc0I7QUFDNUQsVUFBVSwrREFBSyx1QkFBdUIsOERBQVE7QUFDOUMsVUFBVSwrREFBSyx1QkFBdUIsOERBQVE7QUFDOUMsVUFBVSwrREFBSyxtQ0FBbUMsOERBQVE7QUFDMUQ7QUFDQSxZQUFZLHlEQUF5RDtBQUNyRTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0Isa0JBQWtCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQSxZQUFZLG1EQUFZO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLEdBQUc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZ0ZBQXNCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLFVBQVU7QUFDOUI7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQ0FBaUMsc0VBQVk7QUFDN0MsaUNBQWlDLHNFQUFZO0FBQzdDLDZDQUE2QyxzRUFBWTtBQUN6RCxrQ0FBa0MsZ0ZBQXNCO0FBQ3hELE1BQU0sK0RBQUssdUJBQXVCLDhEQUFRO0FBQzFDLE1BQU0sK0RBQUssdUJBQXVCLDhEQUFRO0FBQzFDLE1BQU0sK0RBQUssbUNBQW1DLDhEQUFRO0FBQ3REO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QixHQUFHO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGtEQUFrRCwyQkFBMkIsSUFBSTtBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyx1RUFBb0I7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNO0FBQ04sVUFBVSxtREFBWTtBQUN0QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHlFQUFlO0FBQ3JDLE1BQU0sK0RBQUssQ0FBQyxzRUFBWSwrQ0FBK0MsOERBQVE7QUFDL0UsTUFBTSwrREFBSyxDQUFDLHNFQUFZLG1DQUFtQyw4REFBUTtBQUNuRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixzQkFBc0I7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLHNFQUFZO0FBQzNDLCtCQUErQixzRUFBWTtBQUMzQztBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxzRUFBWTtBQUM3QyxpQ0FBaUMsc0VBQVk7QUFDN0M7QUFDQTtBQUNBLE1BQU0sK0RBQUssdUJBQXVCLDhEQUFRO0FBQzFDLE1BQU0sK0RBQUssdUJBQXVCLDhEQUFRO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sc0VBQW1CO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLGlHQUFtQztBQUNyRSxtRUFBbUUsc0VBQW1CO0FBQ3RGLFdBQVcsb0dBQXNDO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywwR0FBNEM7QUFDOUU7QUFDQSwyREFBMkQsc0VBQW1CO0FBQzlFO0FBQ0E7QUFDQSxNQUFNO0FBQ04sdUJBQXVCLDZDQUFVO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVMsaUVBQWlFO0FBQzFFLGlCQUFpQiw4REFBZTtBQUNoQyxvREFBb0QsaUZBQXVCLHdCQUF3Qix3RkFBOEI7QUFDakksT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDhEQUFZO0FBQ3JDO0FBQ0EsSUFBSSxJQUFJO0FBQ1I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLDRFQUFrQjtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsa0ZBQTJCO0FBQ3pEO0FBQ0EscUJBQXFCLG1GQUE0QjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtEQUErRCw4REFBZTtBQUM5RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDhEQUFlO0FBQzNDO0FBQ0EsTUFBTTtBQUNOLGdDQUFnQyx3RUFBaUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHNCQUFzQixJQUFJO0FBQzVDLHdCQUF3Qiw4RUFBb0I7QUFDNUM7QUFDQTtBQUNBLCtCQUErQixzRUFBYTtBQUM1QztBQUNBO0FBQ0E7QUFDQSw4QkFBOEIscUVBQWM7QUFDNUM7QUFDQSxxQkFBcUIsc0VBQWU7QUFDcEM7QUFDQSxjQUFjLG1CQUFtQjtBQUNqQztBQUNBO0FBQ0E7QUFDQSxhQUFhLDJFQUFnQixHQUFHLFNBQVM7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLGdCQUFnQjtBQUM1QjtBQUNBLGNBQWMsVUFBVTtBQUN4QixzQkFBc0IsMkVBQWdCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1I7QUFDQTtBQUNBLGNBQWMsdUNBQXVDO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNULFVBQVU7QUFDVjtBQUNBLDZCQUE2QixtREFBRztBQUNoQyxrREFBa0QsZ0VBQWdCLGNBQWMsZ0VBQWdCLG1CQUFtQiw0REFBWSxpQkFBaUIsNERBQVk7QUFDNUosYUFBYSwyRUFBZ0I7QUFDN0I7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLDhCQUE4Qix5RUFBa0I7QUFDaEQ7QUFDQSxxQkFBcUIsMEVBQW1CO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCw2RUFBc0I7QUFDekUsWUFBWSxnQkFBZ0I7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYSwyRUFBZ0I7QUFDN0I7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLDhCQUE4Qiw2RUFBc0I7QUFDcEQ7QUFDQSxxQkFBcUIsOEVBQXVCO0FBQzVDO0FBQ0E7QUFDQTtBQUNBLFlBQVksZ0JBQWdCO0FBQzVCO0FBQ0EsY0FBYyxxRUFBcUU7QUFDbkYsOEJBQThCLDJEQUFZLEdBQUcsU0FBUztBQUN0RDtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsMEVBQXNCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0Esc0JBQXNCLHNFQUFzQjtBQUM1QztBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0EsY0FBYyxPQUFPO0FBQ3JCO0FBQ0EsT0FBTztBQUNQLGFBQWEsMkVBQWdCLEdBQUcsZUFBZTtBQUMvQztBQUNBLDhCQUE4QixzRkFBK0I7QUFDN0Q7QUFDQSxxQkFBcUIsdUZBQWdDO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ3dIO0FBQ2xFOztBQUV0RDtBQUNBLDRCQUE0QjtBQUM1QjtBQUNBO0FBQ0EsVUFBVSxnQkFBZ0I7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsSUFBSSxHQUFHLHNCQUFzQiw2QkFBNkIsSUFBSSxJQUFJLE1BQU07QUFDOUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0EsR0FBRztBQUNIOztBQUVBO0FBQ0E7QUFDQSx3QkFBd0IsaUVBQWlFLElBQUk7QUFDN0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsTUFBTTtBQUNOLFVBQVUsbURBQWE7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx1QkFBdUIsRUFBRSw4RUFBcUI7QUFDMUQsb0NBQW9DLHNFQUFhO0FBQ2pELDJCQUEyQixxQkFBcUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHNCQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHFCQUFxQix3QkFBd0IsU0FBUztBQUNqRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQWVtQztBQUNzRDtBQUNyQjtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qiw4REFBWTtBQUNyQztBQUNBLElBQUksSUFBSTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5Qiw0RUFBbUI7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHlFQUFrQjtBQUNoRDtBQUNBLHFCQUFxQiwwRUFBbUI7QUFDeEM7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGtGQUE0QjtBQUMxRDtBQUNBLHFCQUFxQixtRkFBNkI7QUFDbEQ7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHdFQUFrQjtBQUNoRDtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIscUVBQWU7QUFDN0M7QUFDQSxxQkFBcUIsc0VBQWdCO0FBQ3JDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qix5RUFBbUI7QUFDakQ7QUFDQSxxQkFBcUIsMEVBQW9CO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCw2RUFBdUI7QUFDMUUsOEJBQThCLDZFQUF1QjtBQUNyRDtBQUNBLHFCQUFxQiw4RUFBd0I7QUFDN0M7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLHNGQUFnQztBQUM5RDtBQUNBLHFCQUFxQix1RkFBaUM7QUFDdEQ7QUFDQTtBQUNBO0FBQ0E7QUFPRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGpzLWJvaWxlcnBsYXRlLXRlbXBsYXRlLy4vbm9kZV9tb2R1bGVzL0BhcHRvcy1jb25uZWN0L3dhbGxldC1hZGFwdGVyLXBsdWdpbi9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3QvZGFwcC1zZGsvZGlzdC9pbmRleC5tanM/ZGNiMCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvQUNEYXBwQ2xpZW50LnRzXG5pbXBvcnQge1xuICBjaGFpbklkVG9OZXR3b3JrLFxuICBDb25uZWN0UmVxdWVzdCxcbiAgQ29ubmVjdFJlc3BvbnNlLFxuICBEaXNjb25uZWN0UmVxdWVzdCxcbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0LFxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1Jlc3BvbnNlLFxuICBtYWtlVXNlckFwcHJvdmFsLFxuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0LFxuICBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXNwb25zZSxcbiAgU2lnbk1lc3NhZ2VSZXF1ZXN0LFxuICBTaWduTWVzc2FnZVJlc3BvbnNlLFxuICBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0LFxuICBTaWduVHJhbnNhY3Rpb25SZXNwb25zZVxufSBmcm9tIFwiQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFwaVwiO1xuaW1wb3J0IHsgV2ViV2FsbGV0VHJhbnNwb3J0IH0gZnJvbSBcIkBhcHRvcy1jb25uZWN0L3dlYi10cmFuc3BvcnRcIjtcbmltcG9ydCB7XG4gIEFjY291bnRBZGRyZXNzIGFzIEFjY291bnRBZGRyZXNzMyxcbiAgQW55U2lnbmF0dXJlLFxuICBBcHRvc0NvbmZpZyBhcyBBcHRvc0NvbmZpZzIsXG4gIERlc2VyaWFsaXplcixcbiAgRWQyNTUxOVNpZ25hdHVyZSxcbiAgRmVlUGF5ZXJSYXdUcmFuc2FjdGlvbixcbiAgZ2VuZXJhdGVSYXdUcmFuc2FjdGlvbixcbiAgSGV4XG59IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmltcG9ydCB7IE5ldHdvcmtOYW1lIGFzIE5ldHdvcmtOYW1lMiB9IGZyb20gXCJAaWRlbnRpdHktY29ubmVjdC9hcGlcIjtcbmltcG9ydCB7IGNyZWF0ZUVkMjU1MTlLZXlQYWlyLCBlbmNvZGVCYXNlNjQgYXMgZW5jb2RlQmFzZTY0MiB9IGZyb20gXCJAaWRlbnRpdHktY29ubmVjdC9jcnlwdG9cIjtcblxuLy8gc3JjL2NvbnN0YW50cy50c1xudmFyIERFRkFVTFRfRlJPTlRFTkRfVVJMID0gXCJodHRwczovL2FwdG9zY29ubmVjdC5hcHBcIjtcblxuLy8gc3JjL2NvbnZlcnNpb24udHNcbmltcG9ydCB7XG4gIEFjY291bnRBZGRyZXNzLFxuICBnZW5lcmF0ZVRyYW5zYWN0aW9uUGF5bG9hZCxcbiAgZ2VuZXJhdGVUcmFuc2FjdGlvblBheWxvYWRXaXRoQUJJXG59IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmZ1bmN0aW9uIGNvbnZlcnRUb1NlcmlhbGl6YWJsZUFyZ3VtZW50KGFyZ3VtZW50KSB7XG4gIGlmIChhcmd1bWVudCA9PT0gdm9pZCAwIHx8IGFyZ3VtZW50ID09PSBudWxsKSB7XG4gICAgcmV0dXJuIGFyZ3VtZW50O1xuICB9XG4gIGlmIChBcnJheS5pc0FycmF5KGFyZ3VtZW50KSkge1xuICAgIHJldHVybiBhcmd1bWVudC5tYXAoKHN1YkFyZ3VtZW50KSA9PiBjb252ZXJ0VG9TZXJpYWxpemFibGVBcmd1bWVudChzdWJBcmd1bWVudCkpO1xuICB9XG4gIGlmICh0eXBlb2YgYXJndW1lbnQgPT09IFwic3RyaW5nXCIgfHwgdHlwZW9mIGFyZ3VtZW50ID09PSBcIm51bWJlclwiIHx8IHR5cGVvZiBhcmd1bWVudCA9PT0gXCJib29sZWFuXCIgfHwgYXJndW1lbnQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgcmV0dXJuIGFyZ3VtZW50O1xuICB9XG4gIGlmICh0eXBlb2YgYXJndW1lbnQgPT09IFwiYmlnaW50XCIpIHtcbiAgICByZXR1cm4gYXJndW1lbnQudG9TdHJpbmcoKTtcbiAgfVxuICBpZiAoYXJndW1lbnQgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcikge1xuICAgIHJldHVybiBuZXcgVWludDhBcnJheShhcmd1bWVudCk7XG4gIH1cbiAgaWYgKFwidmFsdWVzXCIgaW4gYXJndW1lbnQpIHtcbiAgICByZXR1cm4gYXJndW1lbnQudmFsdWVzLm1hcCgoc3ViQXJndW1lbnQpID0+IGNvbnZlcnRUb1NlcmlhbGl6YWJsZUFyZ3VtZW50KHN1YkFyZ3VtZW50KSk7XG4gIH1cbiAgaWYgKFwiZGF0YVwiIGluIGFyZ3VtZW50KSB7XG4gICAgcmV0dXJuIEFjY291bnRBZGRyZXNzLmZyb20oYXJndW1lbnQuZGF0YSkudG9TdHJpbmcoKTtcbiAgfVxuICBpZiAoYXJndW1lbnQudmFsdWUgPT09IHZvaWQgMCkge1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbiAgaWYgKHR5cGVvZiBhcmd1bWVudC52YWx1ZSA9PT0gXCJzdHJpbmdcIiB8fCB0eXBlb2YgYXJndW1lbnQudmFsdWUgPT09IFwibnVtYmVyXCIgfHwgdHlwZW9mIGFyZ3VtZW50LnZhbHVlID09PSBcImJvb2xlYW5cIiB8fCBhcmd1bWVudC52YWx1ZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICByZXR1cm4gYXJndW1lbnQudmFsdWU7XG4gIH1cbiAgaWYgKHR5cGVvZiBhcmd1bWVudC52YWx1ZSA9PT0gXCJiaWdpbnRcIikge1xuICAgIHJldHVybiBhcmd1bWVudC52YWx1ZS50b1N0cmluZygpO1xuICB9XG4gIHRocm93IG5ldyBFcnJvcihcIlVuZXhwZWN0ZWQgYXJndW1lbnRcIik7XG59XG5mdW5jdGlvbiBub3JtYWxpemVQYXlsb2FkRm9ySUMocGF5bG9hZCwgYXB0b3NDb25maWcpIHtcbiAgaWYgKFwiYmNzVG9CeXRlc1wiIGluIHBheWxvYWQpIHtcbiAgICByZXR1cm4gcGF5bG9hZDtcbiAgfVxuICBpZiAoXCJieXRlY29kZVwiIGluIHBheWxvYWQpIHtcbiAgICByZXR1cm4gZ2VuZXJhdGVUcmFuc2FjdGlvblBheWxvYWQocGF5bG9hZCk7XG4gIH1cbiAgaWYgKGFwdG9zQ29uZmlnKSB7XG4gICAgcmV0dXJuIHBheWxvYWQuYWJpICE9PSB2b2lkIDAgPyBnZW5lcmF0ZVRyYW5zYWN0aW9uUGF5bG9hZFdpdGhBQkkoeyAuLi5wYXlsb2FkLCBhYmk6IHBheWxvYWQuYWJpIH0pIDogZ2VuZXJhdGVUcmFuc2FjdGlvblBheWxvYWQoeyBhcHRvc0NvbmZpZywgLi4ucGF5bG9hZCB9KTtcbiAgfVxuICBjb25zdCBlbnRyeUZ1bmN0aW9uUGF5bG9hZCA9IHtcbiAgICBhcmd1bWVudHM6IHBheWxvYWQuZnVuY3Rpb25Bcmd1bWVudHMubWFwKGNvbnZlcnRUb1NlcmlhbGl6YWJsZUFyZ3VtZW50KSxcbiAgICBmdW5jdGlvbjogcGF5bG9hZC5mdW5jdGlvbixcbiAgICB0eXBlOiBcImVudHJ5X2Z1bmN0aW9uX3BheWxvYWRcIixcbiAgICB0eXBlX2FyZ3VtZW50czogKHBheWxvYWQudHlwZUFyZ3VtZW50cyA/PyBbXSkubWFwKCh0YSkgPT4gdGEudG9TdHJpbmcoKSlcbiAgfTtcbiAgcmV0dXJuIFwibXVsdGlzaWdBZGRyZXNzXCIgaW4gcGF5bG9hZCA/IHtcbiAgICBtdWx0aXNpZ19hZGRyZXNzOiBBY2NvdW50QWRkcmVzcy5mcm9tKHBheWxvYWQubXVsdGlzaWdBZGRyZXNzKS50b1N0cmluZygpLFxuICAgIHRyYW5zYWN0aW9uX3BheWxvYWQ6IGVudHJ5RnVuY3Rpb25QYXlsb2FkLFxuICAgIHR5cGU6IFwibXVsdGlzaWdfcGF5bG9hZFwiXG4gIH0gOiBlbnRyeUZ1bmN0aW9uUGF5bG9hZDtcbn1cblxuLy8gc3JjL1BhaXJpbmdDbGllbnQudHNcbmltcG9ydCB7IEFjY291bnRBZGRyZXNzIGFzIEFjY291bnRBZGRyZXNzMiB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmltcG9ydCB7XG4gIE5ldHdvcmtOYW1lLFxuICBTaWduaW5nUmVxdWVzdFN0YXR1cyxcbiAgU2lnbmluZ1JlcXVlc3RUeXBlc1xufSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvYXBpXCI7XG5pbXBvcnQge1xuICBkZWNvZGVCYXNlNjQsXG4gIGRlY3J5cHRFbnZlbG9wZSxcbiAgZGVzZXJpYWxpemVFZDI1NTE5UHVibGljS2V5QjY0LFxuICBkZXNlcmlhbGl6ZVB1YmxpY0tleUI2NCxcbiAgZW5jb2RlQmFzZTY0LFxuICBlbmNyeXB0QW5kU2lnbkVudmVsb3BlLFxuICBLZXlUeXBlcyxcbiAgdG9LZXlcbn0gZnJvbSBcIkBpZGVudGl0eS1jb25uZWN0L2NyeXB0b1wiO1xuaW1wb3J0IHtcbiAgZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3MsXG4gIHNlcmlhbGl6ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzLFxuICBzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXF1ZXN0QXJnc1xufSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3Qvd2FsbGV0LWFwaVwiO1xuaW1wb3J0IGF4aW9zLCB7IEF4aW9zRXJyb3IsIGlzQXhpb3NFcnJvciB9IGZyb20gXCJheGlvc1wiO1xuXG4vLyBzcmMvZXJyb3JzLnRzXG52YXIgU2lnbmF0dXJlUmVxdWVzdEVycm9yID0gY2xhc3MgX1NpZ25hdHVyZVJlcXVlc3RFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3Ioc3RhdHVzKSB7XG4gICAgc3VwZXIoc3RhdHVzKTtcbiAgICB0aGlzLm5hbWUgPSBcIlNpZ25hdHVyZVJlcXVlc3RFcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfU2lnbmF0dXJlUmVxdWVzdEVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG52YXIgVW5leHBlY3RlZFNpZ25hdHVyZVJlc3BvbnNlRXJyb3IgPSBjbGFzcyBfVW5leHBlY3RlZFNpZ25hdHVyZVJlc3BvbnNlRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1pc3NpbmdGaWVsZHMpIHtcbiAgICBjb25zdCBtZXNzYWdlID0gYE1pc3NpbmcgdGhlIGZvbGxvd2luZyBmaWVsZHM6ICR7bWlzc2luZ0ZpZWxkcy5qb2luKFwiLCBcIil9YDtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgICB0aGlzLm5hbWUgPSBcIlVuZXhwZWN0ZWRTaWduYXR1cmVSZXNwb25zZUVycm9yXCI7XG4gICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKHRoaXMsIF9VbmV4cGVjdGVkU2lnbmF0dXJlUmVzcG9uc2VFcnJvci5wcm90b3R5cGUpO1xuICB9XG59O1xudmFyIFBhaXJpbmdFeHBpcmVkRXJyb3IgPSBjbGFzcyBfUGFpcmluZ0V4cGlyZWRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLm5hbWUgPSBcIlBhaXJpbmdFeHBpcmVkRXJyb3JcIjtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgX1BhaXJpbmdFeHBpcmVkRXJyb3IucHJvdG90eXBlKTtcbiAgfVxufTtcbnZhciBVbnJlZ2lzdGVyZWREYXBwRXJyb3IgPSBjbGFzcyBfVW5yZWdpc3RlcmVkRGFwcEVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcihcIkRhcHAgSUQgaXMgaW52YWxpZCBvciBub3QgYXNzb2NpYXRlZCB3aXRoIGEgcmVnaXN0ZXJlZCBEYXBwLlwiKTtcbiAgICB0aGlzLm5hbWUgPSBcIlVucmVnaXN0ZXJlZERhcHBFcnJvclwiO1xuICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBfVW5yZWdpc3RlcmVkRGFwcEVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG5cbi8vIHNyYy9zdGF0ZS50c1xudmFyIERBUFBfUEFJUklOR1NfV0lORE9XX1NUT1JBR0VfS0VZID0gXCJpY0RhcHBQYWlyaW5nc1wiO1xudmFyIHdpbmRvd1N0YXRlQWNjZXNzb3JzID0ge1xuICBhc3luYyBnZXQoYWRkcmVzcykge1xuICAgIGNvbnN0IHBhaXJpbmdzID0gYXdhaXQgdGhpcy5nZXRBbGwoKTtcbiAgICByZXR1cm4gcGFpcmluZ3NbYWRkcmVzc107XG4gIH0sXG4gIGFzeW5jIGdldEFsbCgpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKERBUFBfUEFJUklOR1NfV0lORE9XX1NUT1JBR0VfS0VZKTtcbiAgICByZXR1cm4gc2VyaWFsaXplZCA/IEpTT04ucGFyc2Uoc2VyaWFsaXplZCkgOiB7fTtcbiAgfSxcbiAgYXN5bmMgdXBkYXRlKGFkZHJlc3MsIHBhaXJpbmcpIHtcbiAgICBjb25zdCBwYWlyaW5ncyA9IGF3YWl0IHRoaXMuZ2V0QWxsKCk7XG4gICAgaWYgKHBhaXJpbmcgPT09IHZvaWQgMCkge1xuICAgICAgZGVsZXRlIHBhaXJpbmdzW2FkZHJlc3NdO1xuICAgIH0gZWxzZSB7XG4gICAgICBwYWlyaW5nc1thZGRyZXNzXSA9IHBhaXJpbmc7XG4gICAgfVxuICAgIGNvbnN0IG5ld1NlcmlhbGl6ZWQgPSBKU09OLnN0cmluZ2lmeShwYWlyaW5ncyk7XG4gICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKERBUFBfUEFJUklOR1NfV0lORE9XX1NUT1JBR0VfS0VZLCBuZXdTZXJpYWxpemVkKTtcbiAgfVxufTtcblxuLy8gc3JjL3V0aWxzLnRzXG52YXIgU0lHTl9NRVNTQUdFX1JFU1BPTlNFX1JFUVVJUkVEX0ZJRUxEUyA9IFtcbiAgXCJhZGRyZXNzXCIsXG4gIFwiYXBwbGljYXRpb25cIixcbiAgXCJjaGFpbklkXCIsXG4gIFwiZnVsbE1lc3NhZ2VcIixcbiAgXCJtZXNzYWdlXCIsXG4gIFwibm9uY2VcIixcbiAgXCJwcmVmaXhcIixcbiAgXCJzaWduYXR1cmVcIlxuXTtcbmZ1bmN0aW9uIHZhbGlkYXRlU2lnbk1lc3NhZ2VSZXNwb25zZShyZXNwb25zZSkge1xuICBjb25zdCBwcm92aWRlZEZpZWxkcyA9IG5ldyBTZXQoT2JqZWN0LmtleXMocmVzcG9uc2UpKTtcbiAgY29uc3QgbWlzc2luZ0ZpZWxkcyA9IFNJR05fTUVTU0FHRV9SRVNQT05TRV9SRVFVSVJFRF9GSUVMRFMuZmlsdGVyKChmaWVsZCkgPT4gIXByb3ZpZGVkRmllbGRzLmhhcyhmaWVsZCkpO1xuICBpZiAobWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRTaWduYXR1cmVSZXNwb25zZUVycm9yKG1pc3NpbmdGaWVsZHMpO1xuICB9XG59XG52YXIgU0lHTl9BTkRfU1VCTUlUX1RSQU5TQUNUSU9OX1JFU1BPTlNFX1JFUVVJUkVEX0ZJRUxEUyA9IFtcImhhc2hcIl07XG5mdW5jdGlvbiB2YWxpZGF0ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlKHJlc3BvbnNlKSB7XG4gIGNvbnN0IHByb3ZpZGVkRmllbGRzID0gbmV3IFNldChPYmplY3Qua2V5cyhyZXNwb25zZSkpO1xuICBjb25zdCBtaXNzaW5nRmllbGRzID0gU0lHTl9BTkRfU1VCTUlUX1RSQU5TQUNUSU9OX1JFU1BPTlNFX1JFUVVJUkVEX0ZJRUxEUy5maWx0ZXIoXG4gICAgKGZpZWxkKSA9PiAhcHJvdmlkZWRGaWVsZHMuaGFzKGZpZWxkKVxuICApO1xuICBpZiAobWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwKSB7XG4gICAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRTaWduYXR1cmVSZXNwb25zZUVycm9yKG1pc3NpbmdGaWVsZHMpO1xuICB9XG59XG5cbi8vIHNyYy9QYWlyaW5nQ2xpZW50LnRzXG52YXIgQVBJX1ZFUlNJT04gPSBcIjAuMi4wXCI7XG52YXIgU0lHTklOR19SRVFVRVNUX1BPTExJTkdfSU5URVJWQUwgPSAyNTAwO1xudmFyIFNFUVVFTkNFX05VTUJFUl9NSVNNQVRDSF9QQVRURVJOID0gL15TZXF1ZW5jZSBudW1iZXIgbWlzbWF0Y2gsIGV4cGVjdGVkICg/OlxcUysgdG8gYmUgKT8oXFxkKykvO1xuYXN5bmMgZnVuY3Rpb24gd2FpdEZvcihtaWxsaXNlY29uZHMpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgc2V0VGltZW91dChyZXNvbHZlLCBtaWxsaXNlY29uZHMpO1xuICB9KTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHdpdGhSZXRyaWVzKHJlcXVlc3RGbiwgb25FcnJvciwgcmV0cmllcyA9IDEpIHtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXRyaWVzOyBpICs9IDEpIHtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGF3YWl0IHJlcXVlc3RGbigpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgb25FcnJvcihlcnIpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcmVxdWVzdEZuKCk7XG59XG52YXIgQUNQYWlyaW5nQ2xpZW50ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgYWNjZXNzb3JzID0gd2luZG93U3RhdGVBY2Nlc3NvcnMsXG4gICAgYXhpb3NDb25maWcsXG4gICAgZGVmYXVsdE5ldHdvcmtOYW1lID0gTmV0d29ya05hbWUuTUFJTk5FVFxuICB9ID0ge30pIHtcbiAgICAvLyBlbmRyZWdpb25cbiAgICB0aGlzLm9uRGlzY29ubmVjdExpc3RlbmVycyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgU2V0KCk7XG4gICAgdGhpcy5hY2Nlc3NvcnMgPSBhY2Nlc3NvcnM7XG4gICAgdGhpcy5kZWZhdWx0TmV0d29ya05hbWUgPSBkZWZhdWx0TmV0d29ya05hbWU7XG4gICAgdGhpcy5heGlvc0luc3RhbmNlID0gYXhpb3MuY3JlYXRlKHtcbiAgICAgIGJhc2VVUkw6IERFRkFVTFRfRlJPTlRFTkRfVVJMLFxuICAgICAgLi4uYXhpb3NDb25maWdcbiAgICB9KTtcbiAgICBjb25zdCBpc0NsaWVudFNpZGVSZW5kZXJpbmcgPSB0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiO1xuICAgIHRoaXMuaW5pdFByb21pc2UgPSBpc0NsaWVudFNpZGVSZW5kZXJpbmcgPyB0aGlzLnN5bmNGaXJzdFBhaXJpbmcoKSA6IHZvaWQgMDtcbiAgfVxuICBhc3luYyBnZXRQYWlyaW5nKGlkKSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmF4aW9zSW5zdGFuY2UuZ2V0KGB2MS9wYWlyaW5nLyR7aWR9L2ApO1xuICAgIHJldHVybiByZXNwb25zZS5kYXRhLmRhdGEucGFpcmluZztcbiAgfVxuICBhc3luYyBzeW5jRmlyc3RQYWlyaW5nKCkge1xuICAgIGNvbnN0IHBhaXJpbmdzID0gYXdhaXQgdGhpcy5hY2Nlc3NvcnMuZ2V0QWxsKCk7XG4gICAgY29uc3QgZmlyc3RQYWlyaW5nID0gT2JqZWN0LnZhbHVlcyhwYWlyaW5ncylbMF07XG4gICAgaWYgKGZpcnN0UGFpcmluZyA9PT0gdm9pZCAwKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGRhcHBTcGVjaWZpY1dhbGxldCwgbWF4RGFwcFNlcXVlbmNlTnVtYmVyIH0gPSBhd2FpdCB0aGlzLmdldFBhaXJpbmcoZmlyc3RQYWlyaW5nLnBhaXJpbmdJZCk7XG4gICAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUoZmlyc3RQYWlyaW5nLmFjY291bnRBZGRyZXNzLCB7XG4gICAgICAgIC4uLmZpcnN0UGFpcmluZyxcbiAgICAgICAgY3VyclNlcXVlbmNlTnVtYmVyOiBtYXhEYXBwU2VxdWVuY2VOdW1iZXIsXG4gICAgICAgIGRhcHBXYWxsZXRJZDogZGFwcFNwZWNpZmljV2FsbGV0Py5pZFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUoZmlyc3RQYWlyaW5nLmFjY291bnRBZGRyZXNzLCB2b2lkIDApO1xuICAgIH1cbiAgfVxuICBhc3luYyBjcmVhdGVTaWduaW5nUmVxdWVzdChwYWlyaW5nLCB0eXBlLCBuZXR3b3JrTmFtZSwgcmVxdWVzdEJvZHkpIHtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVNlY3JldEtleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5U2VjcmV0S2V5QjY0KTtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVB1YmxpY0tleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBjb25zdCBhY2NvdW50VHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmFjY291bnRUcmFuc3BvcnRFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBsZXQgc2VxdWVuY2VOdW1iZXIgPSBwYWlyaW5nLmN1cnJTZXF1ZW5jZU51bWJlciArIDE7XG4gICAgcmV0dXJuIHdpdGhSZXRyaWVzKFxuICAgICAgYXN5bmMgKCkgPT4ge1xuICAgICAgICBjb25zdCByZXF1ZXN0RW52ZWxvcGUgPSBhd2FpdCBlbmNyeXB0QW5kU2lnbkVudmVsb3BlKFxuICAgICAgICAgIHRvS2V5KGRhcHBFZDI1NTE5U2VjcmV0S2V5LCBLZXlUeXBlcy5FZDI1NTE5U2VjcmV0S2V5KSxcbiAgICAgICAgICB0b0tleShkYXBwRWQyNTUxOVB1YmxpY0tleSwgS2V5VHlwZXMuRWQyNTUxOVB1YmxpY0tleSksXG4gICAgICAgICAgdG9LZXkoYWNjb3VudFRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXksIEtleVR5cGVzLkVkMjU1MTlQdWJsaWNLZXkpLFxuICAgICAgICAgIHNlcXVlbmNlTnVtYmVyLFxuICAgICAgICAgIHsgYXBpVmVyc2lvbjogQVBJX1ZFUlNJT04sIG5ldHdvcmtOYW1lLCByZXF1ZXN0VHlwZTogdHlwZSB9LFxuICAgICAgICAgIHJlcXVlc3RCb2R5XG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLnBvc3QoXG4gICAgICAgICAgYHYxL3BhaXJpbmcvJHtwYWlyaW5nLnBhaXJpbmdJZH0vc2lnbmluZy1yZXF1ZXN0L2AsXG4gICAgICAgICAgcmVxdWVzdEVudmVsb3BlXG4gICAgICAgICk7XG4gICAgICAgIGF3YWl0IHRoaXMuYWNjZXNzb3JzLnVwZGF0ZShwYWlyaW5nLmFjY291bnRBZGRyZXNzLCB7XG4gICAgICAgICAgLi4ucGFpcmluZyxcbiAgICAgICAgICBjdXJyU2VxdWVuY2VOdW1iZXI6IHNlcXVlbmNlTnVtYmVyXG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzcG9uc2UuZGF0YS5kYXRhLnNpZ25pbmdSZXF1ZXN0O1xuICAgICAgfSxcbiAgICAgIChlcnIpID0+IHtcbiAgICAgICAgaWYgKGlzQXhpb3NFcnJvcihlcnIpKSB7XG4gICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlO1xuICAgICAgICAgIGNvbnN0IGV4cGVjdGVkU2VxdWVuY2VOdW1iZXIgPSBlcnJvck1lc3NhZ2U/Lm1hdGNoKFNFUVVFTkNFX05VTUJFUl9NSVNNQVRDSF9QQVRURVJOKT8uWzFdO1xuICAgICAgICAgIGlmIChleHBlY3RlZFNlcXVlbmNlTnVtYmVyICE9PSB2b2lkIDApIHtcbiAgICAgICAgICAgIHNlcXVlbmNlTnVtYmVyID0gTnVtYmVyKGV4cGVjdGVkU2VxdWVuY2VOdW1iZXIpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlcnI7XG4gICAgICB9XG4gICAgKTtcbiAgfVxuICBhc3luYyBnZXRTaWduaW5nUmVxdWVzdChpZCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLmdldChcbiAgICAgIGB2MS9zaWduaW5nLXJlcXVlc3QvJHtpZH0vYCxcbiAgICAgIHtcbiAgICAgICAgdmFsaWRhdGVTdGF0dXM6IChzdGF0dXMpID0+IHN0YXR1cyA9PT0gMjAwIHx8IHN0YXR1cyA9PT0gNDA0XG4gICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuZGF0YT8uZGF0YT8uc2lnbmluZ1JlcXVlc3Q7XG4gIH1cbiAgYXN5bmMgZGVsZXRlUGFpcmluZyhwYWlyaW5nSWQsIHNlY3JldEtleSwgcHVibGljS2V5KSB7XG4gICAgY29uc3QgcmVxdWVzdEVudmVsb3BlID0gYXdhaXQgZW5jcnlwdEFuZFNpZ25FbnZlbG9wZShcbiAgICAgIHNlY3JldEtleSxcbiAgICAgIHB1YmxpY0tleSxcbiAgICAgIHB1YmxpY0tleSxcbiAgICAgIDAsXG4gICAgICAvLyBpZ25vcmVkXG4gICAgICB7fSxcbiAgICAgIHt9XG4gICAgKTtcbiAgICBhd2FpdCB0aGlzLmF4aW9zSW5zdGFuY2UucG9zdChcbiAgICAgIGB2MS9wYWlyaW5nLyR7cGFpcmluZ0lkfS9kZWxldGUvYCxcbiAgICAgIHJlcXVlc3RFbnZlbG9wZSxcbiAgICAgIHsgdmFsaWRhdGVTdGF0dXM6IChzdGF0dXMpID0+IHN0YXR1cyA9PT0gMjA0IHx8IHN0YXR1cyA9PT0gNDA0IH1cbiAgICApO1xuICB9XG4gIGFzeW5jIGNhbmNlbFNpZ25pbmdSZXF1ZXN0KHBhaXJpbmcsIGlkKSB7XG4gICAgY29uc3Qgc2VxdWVuY2VOdW1iZXIgPSBwYWlyaW5nLmN1cnJTZXF1ZW5jZU51bWJlcjtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVNlY3JldEtleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5U2VjcmV0S2V5QjY0KTtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVB1YmxpY0tleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBjb25zdCBhY2NvdW50VHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleSA9IGRlY29kZUJhc2U2NChwYWlyaW5nLmFjY291bnRUcmFuc3BvcnRFZDI1NTE5UHVibGljS2V5QjY0KTtcbiAgICBjb25zdCByZXF1ZXN0RW52ZWxvcGUgPSBhd2FpdCBlbmNyeXB0QW5kU2lnbkVudmVsb3BlKFxuICAgICAgdG9LZXkoZGFwcEVkMjU1MTlTZWNyZXRLZXksIEtleVR5cGVzLkVkMjU1MTlTZWNyZXRLZXkpLFxuICAgICAgdG9LZXkoZGFwcEVkMjU1MTlQdWJsaWNLZXksIEtleVR5cGVzLkVkMjU1MTlQdWJsaWNLZXkpLFxuICAgICAgdG9LZXkoYWNjb3VudFRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXksIEtleVR5cGVzLkVkMjU1MTlQdWJsaWNLZXkpLFxuICAgICAgc2VxdWVuY2VOdW1iZXIgKyAxLFxuICAgICAge30sXG4gICAgICB7fVxuICAgICk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLmF4aW9zSW5zdGFuY2UucGF0Y2goXG4gICAgICBgdjEvc2lnbmluZy1yZXF1ZXN0LyR7aWR9L2NhbmNlbC9gLFxuICAgICAgcmVxdWVzdEVudmVsb3BlXG4gICAgKTtcbiAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUocGFpcmluZy5hY2NvdW50QWRkcmVzcywge1xuICAgICAgLi4ucGFpcmluZyxcbiAgICAgIGN1cnJTZXF1ZW5jZU51bWJlcjogc2VxdWVuY2VOdW1iZXIgKyAxXG4gICAgfSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmRhdGEuZGF0YS5zaWduaW5nUmVxdWVzdDtcbiAgfVxuICBhc3luYyBzaWduUmVxdWVzdChhZGRyZXNzLCB0eXBlLCByZXF1ZXN0Qm9keSwgeyBjYW5jZWxUb2tlbiwgbmV0d29ya05hbWUgfSA9IHt9KSB7XG4gICAgYXdhaXQgdGhpcy5pbml0UHJvbWlzZTtcbiAgICBjb25zdCBwYWlyaW5nID0gYXdhaXQgdGhpcy5hY2Nlc3NvcnMuZ2V0KGFkZHJlc3MpO1xuICAgIGlmIChwYWlyaW5nID09PSB2b2lkIDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoZSByZXF1ZXN0ZWQgYWNjb3VudCBpcyBub3QgcGFpcmVkXCIpO1xuICAgIH1cbiAgICBsZXQgc2lnbmluZ1JlcXVlc3Q7XG4gICAgdHJ5IHtcbiAgICAgIHNpZ25pbmdSZXF1ZXN0ID0gYXdhaXQgdGhpcy5jcmVhdGVTaWduaW5nUmVxdWVzdChcbiAgICAgICAgcGFpcmluZyxcbiAgICAgICAgdHlwZSxcbiAgICAgICAgbmV0d29ya05hbWUgfHwgdGhpcy5kZWZhdWx0TmV0d29ya05hbWUsXG4gICAgICAgIHJlcXVlc3RCb2R5XG4gICAgICApO1xuICAgICAgd2hpbGUgKHNpZ25pbmdSZXF1ZXN0LnN0YXR1cyA9PT0gXCJQRU5ESU5HXCIpIHtcbiAgICAgICAgYXdhaXQgd2FpdEZvcihTSUdOSU5HX1JFUVVFU1RfUE9MTElOR19JTlRFUlZBTCk7XG4gICAgICAgIGlmIChjYW5jZWxUb2tlbj8uY2FuY2VsbGVkKSB7XG4gICAgICAgICAgc2lnbmluZ1JlcXVlc3Quc3RhdHVzID0gU2lnbmluZ1JlcXVlc3RTdGF0dXMuQ0FOQ0VMTEVEO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIHNpZ25pbmdSZXF1ZXN0ID0gYXdhaXQgdGhpcy5nZXRTaWduaW5nUmVxdWVzdChzaWduaW5nUmVxdWVzdC5pZCkgPz8gc2lnbmluZ1JlcXVlc3Q7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBpZiAoaXNBeGlvc0Vycm9yKGVycikgJiYgZXJyLmNvZGUgPT09IFwiNDA0XCIpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5hY2Nlc3NvcnMudXBkYXRlKGFkZHJlc3MsIHZvaWQgMCk7XG4gICAgICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgdGhpcy5vbkRpc2Nvbm5lY3RMaXN0ZW5lcnMpIHtcbiAgICAgICAgICBsaXN0ZW5lcihhZGRyZXNzKTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBuZXcgUGFpcmluZ0V4cGlyZWRFcnJvcigpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICBpZiAoc2lnbmluZ1JlcXVlc3Quc3RhdHVzICE9PSBcIkFQUFJPVkVEXCIpIHtcbiAgICAgIHRocm93IG5ldyBTaWduYXR1cmVSZXF1ZXN0RXJyb3Ioc2lnbmluZ1JlcXVlc3Quc3RhdHVzKTtcbiAgICB9XG4gICAgY29uc3QgZGVjcnlwdGVkID0gZGVjcnlwdEVudmVsb3BlKFxuICAgICAgdG9LZXkoZGVjb2RlQmFzZTY0KHBhaXJpbmcuYWNjb3VudFRyYW5zcG9ydEVkMjU1MTlQdWJsaWNLZXlCNjQpLCBLZXlUeXBlcy5FZDI1NTE5UHVibGljS2V5KSxcbiAgICAgIHRvS2V5KGRlY29kZUJhc2U2NChwYWlyaW5nLmRhcHBFZDI1NTE5U2VjcmV0S2V5QjY0KSwgS2V5VHlwZXMuRWQyNTUxOVNlY3JldEtleSksXG4gICAgICBzaWduaW5nUmVxdWVzdC5yZXNwb25zZUVudmVsb3BlXG4gICAgKTtcbiAgICByZXR1cm4gZGVjcnlwdGVkLnByaXZhdGVNZXNzYWdlO1xuICB9XG4gIC8vIHJlZ2lvbiBQdWJsaWMgQVBJXG4gIC8qKlxuICAgKiBSZXF1ZXN0cyBhIGNvbm5lY3Rpb24gdG8gYW4gYWNjb3VudCAoaW50ZXJuYWxseSBrbm93biBhcyBwYWlyaW5nKS5cbiAgICogQHJldHVybnMgZWl0aGVyIHRoZSBhZGRyZXNzIG9mIHRoZSBjb25uZWN0ZWQgYWNjb3VudCwgb3IgdW5kZWZpbmVkIGlmIHRoZVxuICAgKiBjb25uZWN0aW9uIHdhcyBjYW5jZWxsZWQuXG4gICAqL1xuICBhc3luYyBhZGRQYWlyaW5nKHsgcHVibGljS2V5LCBzZWNyZXRLZXkgfSwgZmluYWxpemVkUGFpcmluZykge1xuICAgIGF3YWl0IHRoaXMuYWNjZXNzb3JzLnVwZGF0ZShmaW5hbGl6ZWRQYWlyaW5nLmFjY291bnQuYWNjb3VudEFkZHJlc3MsIHtcbiAgICAgIGFjY291bnRBZGRyZXNzOiBmaW5hbGl6ZWRQYWlyaW5nLmFjY291bnQuYWNjb3VudEFkZHJlc3MsXG4gICAgICBhY2NvdW50QWxpYXM6IGZpbmFsaXplZFBhaXJpbmcuYWNjb3VudC51c2VyU3VibWl0dGVkQWxpYXMgPz8gdm9pZCAwLFxuICAgICAgYWNjb3VudFB1YmxpY0tleUI2NDogZmluYWxpemVkUGFpcmluZy5hY2NvdW50LnB1YmxpY0tleUI2NCxcbiAgICAgIGFjY291bnRUcmFuc3BvcnRFZDI1NTE5UHVibGljS2V5QjY0OiBmaW5hbGl6ZWRQYWlyaW5nLmFjY291bnQudHJhbnNwb3J0RWQyNTUxOVB1YmxpY0tleUI2NCxcbiAgICAgIGN1cnJTZXF1ZW5jZU51bWJlcjogZmluYWxpemVkUGFpcmluZy5tYXhEYXBwU2VxdWVuY2VOdW1iZXIsXG4gICAgICBkYXBwRWQyNTUxOVB1YmxpY0tleUI2NDogZW5jb2RlQmFzZTY0KHB1YmxpY0tleS5rZXkpLFxuICAgICAgZGFwcEVkMjU1MTlTZWNyZXRLZXlCNjQ6IGVuY29kZUJhc2U2NChzZWNyZXRLZXkua2V5KSxcbiAgICAgIGRhcHBXYWxsZXRJZDogZmluYWxpemVkUGFpcmluZy5kYXBwU3BlY2lmaWNXYWxsZXRJZCxcbiAgICAgIHBhaXJpbmdJZDogZmluYWxpemVkUGFpcmluZy5pZFxuICAgIH0pO1xuICB9XG4gIGFzeW5jIGRpc2Nvbm5lY3QoYWRkcmVzcykge1xuICAgIGNvbnN0IHBhaXJpbmcgPSBhd2FpdCB0aGlzLmFjY2Vzc29ycy5nZXQoYWRkcmVzcyk7XG4gICAgaWYgKHBhaXJpbmcgPT09IHZvaWQgMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhlIHNwZWNpZmllZCBhY2NvdW50IGlzIG5vdCBwYWlyZWRcIik7XG4gICAgfVxuICAgIGNvbnN0IGRhcHBFZDI1NTE5U2VjcmV0S2V5ID0gZGVjb2RlQmFzZTY0KHBhaXJpbmcuZGFwcEVkMjU1MTlTZWNyZXRLZXlCNjQpO1xuICAgIGNvbnN0IGRhcHBFZDI1NTE5UHVibGljS2V5ID0gZGVjb2RlQmFzZTY0KHBhaXJpbmcuZGFwcEVkMjU1MTlQdWJsaWNLZXlCNjQpO1xuICAgIGF3YWl0IHRoaXMuZGVsZXRlUGFpcmluZyhcbiAgICAgIHBhaXJpbmcucGFpcmluZ0lkLFxuICAgICAgdG9LZXkoZGFwcEVkMjU1MTlTZWNyZXRLZXksIEtleVR5cGVzLkVkMjU1MTlTZWNyZXRLZXkpLFxuICAgICAgdG9LZXkoZGFwcEVkMjU1MTlQdWJsaWNLZXksIEtleVR5cGVzLkVkMjU1MTlQdWJsaWNLZXkpXG4gICAgKTtcbiAgICBhd2FpdCB0aGlzLmFjY2Vzc29ycy51cGRhdGUoYWRkcmVzcywgdm9pZCAwKTtcbiAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIHRoaXMub25EaXNjb25uZWN0TGlzdGVuZXJzKSB7XG4gICAgICBsaXN0ZW5lcihhZGRyZXNzKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgc2lnbk1lc3NhZ2UoYWRkcmVzcywgYXJncywgb3B0aW9ucykge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5zaWduUmVxdWVzdChcbiAgICAgIGFkZHJlc3MsXG4gICAgICBTaWduaW5nUmVxdWVzdFR5cGVzLlNJR05fTUVTU0FHRSxcbiAgICAgIGFyZ3MsXG4gICAgICBvcHRpb25zXG4gICAgKTtcbiAgICB2YWxpZGF0ZVNpZ25NZXNzYWdlUmVzcG9uc2UocmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZTtcbiAgfVxuICBhc3luYyBzaWduVHJhbnNhY3Rpb24oYWRkcmVzcywgYXJncywgb3B0aW9ucykge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0QXJncyA9IHNlcmlhbGl6ZVNpZ25UcmFuc2FjdGlvblJlcXVlc3RBcmdzKGFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZUFyZ3MgPSBhd2FpdCB0aGlzLnNpZ25SZXF1ZXN0KGFkZHJlc3MsIFNpZ25pbmdSZXF1ZXN0VHlwZXMuU0lHTl9UUkFOU0FDVElPTiwgc2VyaWFsaXplZFJlcXVlc3RBcmdzLCBvcHRpb25zKTtcbiAgICByZXR1cm4gZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3Moc2VyaWFsaXplZFJlc3BvbnNlQXJncyk7XG4gIH1cbiAgLy8gZW5kcmVnaW9uXG4gIGFzeW5jIHNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvbihhZGRyZXNzLCBhcmdzLCBvcHRpb25zKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3RBcmdzID0gc2VyaWFsaXplU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MoYXJncyk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlQXJncyA9IGF3YWl0IHRoaXMuc2lnblJlcXVlc3QoYWRkcmVzcywgU2lnbmluZ1JlcXVlc3RUeXBlcy5TSUdOX0FORF9TVUJNSVRfVFJBTlNBQ1RJT04sIHNlcmlhbGl6ZWRSZXF1ZXN0QXJncywgb3B0aW9ucyk7XG4gICAgICB2YWxpZGF0ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlc3BvbnNlKHJlc3BvbnNlQXJncyk7XG4gICAgICByZXR1cm4gcmVzcG9uc2VBcmdzO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgQXhpb3NFcnJvciAmJiBlLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihlLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlKTtcbiAgICAgIH1cbiAgICAgIHRocm93IGU7XG4gICAgfVxuICB9XG4gIGFzeW5jIGdldENvbm5lY3RlZEFjY291bnRzKCkge1xuICAgIGF3YWl0IHRoaXMuaW5pdFByb21pc2U7XG4gICAgY29uc3QgcGFpcmluZ3MgPSBhd2FpdCB0aGlzLmFjY2Vzc29ycy5nZXRBbGwoKTtcbiAgICByZXR1cm4gT2JqZWN0LnZhbHVlcyhwYWlyaW5ncykubWFwKFxuICAgICAgKHsgYWNjb3VudEFkZHJlc3MsIGFjY291bnRFZDI1NTE5UHVibGljS2V5QjY0LCBhY2NvdW50UHVibGljS2V5QjY0IH0pID0+ICh7XG4gICAgICAgIGFkZHJlc3M6IEFjY291bnRBZGRyZXNzMi5mcm9tKGFjY291bnRBZGRyZXNzKSxcbiAgICAgICAgcHVibGljS2V5OiBhY2NvdW50UHVibGljS2V5QjY0ICE9PSB2b2lkIDAgPyBkZXNlcmlhbGl6ZVB1YmxpY0tleUI2NChhY2NvdW50UHVibGljS2V5QjY0KSA6IGRlc2VyaWFsaXplRWQyNTUxOVB1YmxpY0tleUI2NChhY2NvdW50RWQyNTUxOVB1YmxpY0tleUI2NClcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuICBvbkRpc2Nvbm5lY3QobGlzdGVuZXIpIHtcbiAgICB0aGlzLm9uRGlzY29ubmVjdExpc3RlbmVycy5hZGQobGlzdGVuZXIpO1xuICAgIHJldHVybiAoKSA9PiB0aGlzLm9uRGlzY29ubmVjdExpc3RlbmVycy5kZWxldGUobGlzdGVuZXIpO1xuICB9XG59O1xuXG4vLyBzcmMvQUNEYXBwQ2xpZW50LnRzXG52YXIgQUNEYXBwQ2xpZW50ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgYmFja2VuZEJhc2VVUkwsXG4gICAgZGFwcElkLFxuICAgIGRhcHBJbWFnZVVSSSxcbiAgICBkYXBwTmFtZSxcbiAgICBkZWZhdWx0TmV0d29ya05hbWUgPSBOZXR3b3JrTmFtZTIuTUFJTk5FVCxcbiAgICBmcm9udGVuZEJhc2VVUkwgPSBERUZBVUxUX0ZST05URU5EX1VSTFxuICB9ID0ge30pIHtcbiAgICB0aGlzLmRlZmF1bHROZXR3b3JrTmFtZSA9IGRlZmF1bHROZXR3b3JrTmFtZTtcbiAgICB0aGlzLmRhcHBJbmZvID0ge1xuICAgICAgZG9tYWluOiB3aW5kb3cubG9jYXRpb24ub3JpZ2luLFxuICAgICAgaW1hZ2VVUkk6IGRhcHBJbWFnZVVSSSxcbiAgICAgIG5hbWU6IGRhcHBOYW1lID8/IGRvY3VtZW50LnRpdGxlXG4gICAgfTtcbiAgICB0aGlzLnRyYW5zcG9ydCA9IG5ldyBXZWJXYWxsZXRUcmFuc3BvcnQoZnJvbnRlbmRCYXNlVVJMKTtcbiAgICB0aGlzLmRhcHBJZCA9IGRhcHBJZDtcbiAgICB0aGlzLnBhaXJpbmdDbGllbnQgPSBuZXcgQUNQYWlyaW5nQ2xpZW50KHtcbiAgICAgIGF4aW9zQ29uZmlnOiB7XG4gICAgICAgIGJhc2VVUkw6IGJhY2tlbmRCYXNlVVJMID8/IGZyb250ZW5kQmFzZVVSTFxuICAgICAgfSxcbiAgICAgIGRlZmF1bHROZXR3b3JrTmFtZVxuICAgIH0pO1xuICB9XG4gIC8vIHJlZ2lvbiBQdWJsaWMgQVBJXG4gIGFzeW5jIGdldEtleWxlc3NBY2NvdW50cygpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZS5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIGdldEljQWNjb3VudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFpcmluZ0NsaWVudC5nZXRDb25uZWN0ZWRBY2NvdW50cygpID8/IFtdO1xuICB9XG4gIGFzeW5jIGlzSWNBY2NvdW50KGFkZHJlc3MpIHtcbiAgICBjb25zdCBpY0FjY291bnRzID0gYXdhaXQgdGhpcy5nZXRJY0FjY291bnRzKCk7XG4gICAgcmV0dXJuIGljQWNjb3VudHMuZmluZCgoYWNjb3VudCkgPT4gYWNjb3VudC5hZGRyZXNzLmVxdWFscyhBY2NvdW50QWRkcmVzczMuZnJvbShhZGRyZXNzKSkpICE9PSB2b2lkIDA7XG4gIH1cbiAgYXN5bmMgZ2V0Q29ubmVjdGVkQWNjb3VudHMoKSB7XG4gICAgY29uc3Qga2V5bGVzc0FjY291bnRzID0gYXdhaXQgdGhpcy5nZXRLZXlsZXNzQWNjb3VudHMoKTtcbiAgICBjb25zdCBpY0FjY291bnRzID0gYXdhaXQgdGhpcy5nZXRJY0FjY291bnRzKCk7XG4gICAgcmV0dXJuIFsuLi5rZXlsZXNzQWNjb3VudHMsIC4uLmljQWNjb3VudHNdO1xuICB9XG4gIGFzeW5jIGRpc2Nvbm5lY3QoYWRkcmVzcykge1xuICAgIGlmIChhd2FpdCB0aGlzLmlzSWNBY2NvdW50KGFkZHJlc3MpKSB7XG4gICAgICBjb25zdCBzdHJpbmdBZGRyZXNzID0gQWNjb3VudEFkZHJlc3MzLmZyb20oYWRkcmVzcykudG9TdHJpbmcoKTtcbiAgICAgIGF3YWl0IHRoaXMucGFpcmluZ0NsaWVudC5kaXNjb25uZWN0KHN0cmluZ0FkZHJlc3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IERpc2Nvbm5lY3RSZXF1ZXN0LnNlcmlhbGl6ZSh0aGlzLmRhcHBJbmZvKTtcbiAgICAgIGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgY29ubmVjdCh7IHByZWZlcnJlZFdhbGxldE5hbWUgfSA9IHt9KSB7XG4gICAgY29uc3QgZGFwcEtleXBhaXIgPSBjcmVhdGVFZDI1NTE5S2V5UGFpcigpO1xuICAgIGNvbnN0IGluamVjdGVkUHJlZmVycmVkV2FsbGV0TmFtZSA9IHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgPyB3aW5kb3cuQUNfUFJFRkVSUkVEX1dBTExFVF9OQU1FIDogdm9pZCAwO1xuICAgIGNvbnN0IHJlcXVlc3RBcmdzID0ge1xuICAgICAgZGFwcEVkMjU1MTlQdWJsaWNLZXlCNjQ6IGVuY29kZUJhc2U2NDIoZGFwcEtleXBhaXIucHVibGljS2V5LmtleSksXG4gICAgICBkYXBwSWQ6IHRoaXMuZGFwcElkLFxuICAgICAgcHJlZmVycmVkV2FsbGV0TmFtZTogcHJlZmVycmVkV2FsbGV0TmFtZSA/PyBpbmplY3RlZFByZWZlcnJlZFdhbGxldE5hbWVcbiAgICB9O1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gQ29ubmVjdFJlcXVlc3Quc2VyaWFsaXplKHRoaXMuZGFwcEluZm8sIHJlcXVlc3RBcmdzKTtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zcG9ydC5zZW5kUmVxdWVzdChzZXJpYWxpemVkUmVxdWVzdCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBDb25uZWN0UmVzcG9uc2UuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICBpZiAocmVzcG9uc2UuYXJncy5zdGF0dXMgPT09IFwiYXBwcm92ZWRcIikge1xuICAgICAgY29uc3QgeyBhY2NvdW50LCBwYWlyaW5nIH0gPSByZXNwb25zZS5hcmdzLmFyZ3M7XG4gICAgICBpZiAocGFpcmluZykge1xuICAgICAgICBhd2FpdCB0aGlzLnBhaXJpbmdDbGllbnQuYWRkUGFpcmluZyhkYXBwS2V5cGFpciwgcGFpcmluZyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbWFrZVVzZXJBcHByb3ZhbCh7IGFjY291bnQgfSk7XG4gICAgfVxuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIHNpZ25NZXNzYWdlKGFyZ3MpIHtcbiAgICBjb25zdCB7IHNpZ25lckFkZHJlc3MgfSA9IGFyZ3M7XG4gICAgaWYgKGF3YWl0IHRoaXMuaXNJY0FjY291bnQoc2lnbmVyQWRkcmVzcykpIHtcbiAgICAgIGNvbnN0IHsgY2hhaW5JZCB9ID0gYXJncztcbiAgICAgIGNvbnN0IG5ldHdvcmsgPSBjaGFpbklkVG9OZXR3b3JrKGNoYWluSWQpO1xuICAgICAgbGV0IG1lc3NhZ2U7XG4gICAgICBsZXQgbm9uY2U7XG4gICAgICB0cnkge1xuICAgICAgICBtZXNzYWdlID0gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGFyZ3MubWVzc2FnZSk7XG4gICAgICAgIG5vbmNlID0gbmV3IFRleHREZWNvZGVyKCkuZGVjb2RlKGFyZ3Mubm9uY2UpO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIk9ubHkgVVRGLTggZW5jb2RlZCB0ZXh0IGlzIHN1cHBvcnRlZCB3aGVuIHVzaW5nIElDXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBmdWxsTWVzc2FnZSwgc2lnbmF0dXJlOiBoZXhTaWduYXR1cmUgfSA9IGF3YWl0IHRoaXMucGFpcmluZ0NsaWVudC5zaWduTWVzc2FnZShcbiAgICAgICAgc2lnbmVyQWRkcmVzcy50b1N0cmluZygpLFxuICAgICAgICB7XG4gICAgICAgICAgYWRkcmVzczogdHJ1ZSxcbiAgICAgICAgICBhcHBsaWNhdGlvbjogdHJ1ZSxcbiAgICAgICAgICBjaGFpbklkOiB0cnVlLFxuICAgICAgICAgIG1lc3NhZ2UsXG4gICAgICAgICAgbm9uY2VcbiAgICAgICAgfSxcbiAgICAgICAgeyBuZXR3b3JrTmFtZTogbmV0d29yayB9XG4gICAgICApO1xuICAgICAgY29uc3Qgc2lnbmF0dXJlQnl0ZXMgPSBIZXguZnJvbUhleElucHV0KGhleFNpZ25hdHVyZSkudG9VaW50OEFycmF5KCk7XG4gICAgICBjb25zdCBzaWduYXR1cmUgPSBzaWduYXR1cmVCeXRlcy5sZW5ndGggPT09IEVkMjU1MTlTaWduYXR1cmUuTEVOR1RIID8gbmV3IEVkMjU1MTlTaWduYXR1cmUoc2lnbmF0dXJlQnl0ZXMpIDogQW55U2lnbmF0dXJlLmRlc2VyaWFsaXplKG5ldyBEZXNlcmlhbGl6ZXIoc2lnbmF0dXJlQnl0ZXMpKTtcbiAgICAgIHJldHVybiBtYWtlVXNlckFwcHJvdmFsKHtcbiAgICAgICAgZnVsbE1lc3NhZ2UsXG4gICAgICAgIHNpZ25hdHVyZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gU2lnbk1lc3NhZ2VSZXF1ZXN0LnNlcmlhbGl6ZSh0aGlzLmRhcHBJbmZvLCBhcmdzKTtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zcG9ydC5zZW5kUmVxdWVzdChzZXJpYWxpemVkUmVxdWVzdCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBTaWduTWVzc2FnZVJlc3BvbnNlLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgYXN5bmMgc2lnblRyYW5zYWN0aW9uKGFyZ3MpIHtcbiAgICBjb25zdCBub3JtYWxpemVkQXJncyA9IFwidHJhbnNhY3Rpb25cIiBpbiBhcmdzID8gU2lnblRyYW5zYWN0aW9uUmVxdWVzdC5ub3JtYWxpemVBcmdzKGFyZ3MpIDogYXJncztcbiAgICBjb25zdCB7IHNpZ25lckFkZHJlc3MgfSA9IGFyZ3M7XG4gICAgaWYgKGF3YWl0IHRoaXMuaXNJY0FjY291bnQoc2lnbmVyQWRkcmVzcykpIHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZXhwaXJhdGlvblNlY29uZHNGcm9tTm93LFxuICAgICAgICBleHBpcmF0aW9uVGltZXN0YW1wLFxuICAgICAgICBmZWVQYXllcixcbiAgICAgICAgZ2FzVW5pdFByaWNlLFxuICAgICAgICBtYXhHYXNBbW91bnQsXG4gICAgICAgIG5ldHdvcmssXG4gICAgICAgIHBheWxvYWQsXG4gICAgICAgIHNlY29uZGFyeVNpZ25lcnMsXG4gICAgICAgIHNlbmRlcixcbiAgICAgICAgc2VxdWVuY2VOdW1iZXJcbiAgICAgIH0gPSBub3JtYWxpemVkQXJncztcbiAgICAgIGlmIChmZWVQYXllciAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlNwb25zb3JlZCB0cmFuc2FjdGlvbiBub3QgY3VycmVudGx5IHN1cHBvcnRlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChzZWNvbmRhcnlTaWduZXJzICYmIHNlY29uZGFyeVNpZ25lcnMubGVuZ3RoID4gMCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJNdWx0aS1hZ2VudCB0cmFuc2FjdGlvbnMgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoIShcImJjc1RvQnl0ZXNcIiBpbiBwYXlsb2FkKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJQYXlsb2FkIGlucHV0IGZvcm1hdCBpcyBvbmx5IHN1cHBvcnRlZCB3aXRoIEtleWxlc3MgYWNjb3VudHMuXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgcmVzcG9uc2VBcmdzID0gYXdhaXQgdGhpcy5wYWlyaW5nQ2xpZW50LnNpZ25UcmFuc2FjdGlvbihcbiAgICAgICAgc2lnbmVyQWRkcmVzcy50b1N0cmluZygpLFxuICAgICAgICB7XG4gICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgZXhwaXJhdGlvblNlY29uZHNGcm9tTm93LFxuICAgICAgICAgICAgZXhwaXJhdGlvblRpbWVzdGFtcCxcbiAgICAgICAgICAgIGdhc1VuaXRQcmljZSxcbiAgICAgICAgICAgIG1heEdhc0Ftb3VudCxcbiAgICAgICAgICAgIHNlbmRlcjogc2VuZGVyPy5hZGRyZXNzLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBzZXF1ZW5jZU51bWJlcjogc2VxdWVuY2VOdW1iZXIgIT09IHZvaWQgMCA/IE51bWJlcihzZXF1ZW5jZU51bWJlcikgOiB2b2lkIDBcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBheWxvYWRcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIG5ldHdvcmtOYW1lOiBuZXR3b3JrXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gbWFrZVVzZXJBcHByb3ZhbCh7XG4gICAgICAgIGF1dGhlbnRpY2F0b3I6IHJlc3BvbnNlQXJncy5hY2NvdW50QXV0aGVudGljYXRvcixcbiAgICAgICAgcmF3VHJhbnNhY3Rpb246IHJlc3BvbnNlQXJncy5yYXdUeG5cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IFNpZ25UcmFuc2FjdGlvblJlcXVlc3Quc2VyaWFsaXplKHRoaXMuZGFwcEluZm8sIG5vcm1hbGl6ZWRBcmdzKTtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVzcG9uc2UgPSBhd2FpdCB0aGlzLnRyYW5zcG9ydC5zZW5kUmVxdWVzdChzZXJpYWxpemVkUmVxdWVzdCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBTaWduVHJhbnNhY3Rpb25SZXNwb25zZS5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIHNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvbihhcmdzKSB7XG4gICAgY29uc3QgeyBzaWduZXJBZGRyZXNzIH0gPSBhcmdzO1xuICAgIGlmIChhd2FpdCB0aGlzLmlzSWNBY2NvdW50KHNpZ25lckFkZHJlc3MpKSB7XG4gICAgICBjb25zdCB7IGV4cGlyYXRpb25UaW1lc3RhbXAsIGZlZVBheWVyLCBnYXNVbml0UHJpY2UsIG1heEdhc0Ftb3VudCwgbmV0d29yayB9ID0gYXJncztcbiAgICAgIGNvbnN0IGFwdG9zQ29uZmlnID0gbmV3IEFwdG9zQ29uZmlnMih7IG5ldHdvcmsgfSk7XG4gICAgICBsZXQgY29udmVydGVkQXJncztcbiAgICAgIGlmIChmZWVQYXllciAhPT0gdm9pZCAwKSB7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBhd2FpdCBub3JtYWxpemVQYXlsb2FkRm9ySUMoYXJncy5wYXlsb2FkLCBhcHRvc0NvbmZpZyk7XG4gICAgICAgIGNvbnN0IHJhd1R4biA9IGF3YWl0IGdlbmVyYXRlUmF3VHJhbnNhY3Rpb24oe1xuICAgICAgICAgIGFwdG9zQ29uZmlnLFxuICAgICAgICAgIGZlZVBheWVyQWRkcmVzczogZmVlUGF5ZXIuYWRkcmVzcyxcbiAgICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgICBnYXNVbml0UHJpY2UsXG4gICAgICAgICAgICBtYXhHYXNBbW91bnRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHBheWxvYWQsXG4gICAgICAgICAgc2VuZGVyOiBzaWduZXJBZGRyZXNzXG4gICAgICAgIH0pO1xuICAgICAgICBjb252ZXJ0ZWRBcmdzID0ge1xuICAgICAgICAgIGZlZVBheWVyQXV0aGVudGljYXRvcjogZmVlUGF5ZXIuYXV0aGVudGljYXRvcixcbiAgICAgICAgICByYXdUeG46IG5ldyBGZWVQYXllclJhd1RyYW5zYWN0aW9uKHJhd1R4biwgW10sIGZlZVBheWVyLmFkZHJlc3MpXG4gICAgICAgIH07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBwYXlsb2FkID0gbm9ybWFsaXplUGF5bG9hZEZvcklDKGFyZ3MucGF5bG9hZCk7XG4gICAgICAgIGNvbnZlcnRlZEFyZ3MgPSB7XG4gICAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgICAgZXhwaXJhdGlvblRpbWVzdGFtcCxcbiAgICAgICAgICAgIGdhc1VuaXRQcmljZSxcbiAgICAgICAgICAgIG1heEdhc0Ftb3VudFxuICAgICAgICAgIH0sXG4gICAgICAgICAgcGF5bG9hZFxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgY29uc3QgeyBoYXNoIH0gPSBhd2FpdCB0aGlzLnBhaXJpbmdDbGllbnQuc2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uKHNpZ25lckFkZHJlc3MudG9TdHJpbmcoKSwgY29udmVydGVkQXJncywge1xuICAgICAgICBuZXR3b3JrTmFtZTogbmV0d29ya1xuICAgICAgfSk7XG4gICAgICByZXR1cm4gbWFrZVVzZXJBcHByb3ZhbCh7IHR4bkhhc2g6IGhhc2ggfSk7XG4gICAgfVxuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgYXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICAvLyBlbmRyZWdpb25cbn07XG5cbi8vIHNyYy9JQ0RhcHBDbGllbnQudHNcbmltcG9ydCB7IGNyZWF0ZUVkMjU1MTlLZXlQYWlyIGFzIGNyZWF0ZUVkMjU1MTlLZXlQYWlyMiwgZW5jb2RlQmFzZTY0IGFzIGVuY29kZUJhc2U2NDMgfSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvY3J5cHRvXCI7XG5pbXBvcnQgeyBpc0F4aW9zRXJyb3IgYXMgaXNBeGlvc0Vycm9yMiB9IGZyb20gXCJheGlvc1wiO1xuXG4vLyBzcmMvcHJvbXB0LnRzXG52YXIgREVGQVVMVF9QUk9NUFRfU0laRSA9IHsgaGVpZ2h0OiA2OTUsIHdpZHRoOiA0NjUgfTtcbnZhciBQUk9NUFRfUE9MTEVSX0lOVEVSVkFMID0gNTAwO1xuZnVuY3Rpb24gb3BlblByb21wdCh1cmwsIHNpemUgPSBERUZBVUxUX1BST01QVF9TSVpFKSB7XG4gIGNvbnN0IHsgaGVpZ2h0LCB3aWR0aCB9ID0gc2l6ZTtcbiAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICBoZWlnaHQsXG4gICAgbGVmdDogd2luZG93LnNjcmVlbkxlZnQgKyBNYXRoLnJvdW5kKCh3aW5kb3cub3V0ZXJXaWR0aCAtIHdpZHRoKSAvIDIpLFxuICAgIHBvcHVwOiB0cnVlLFxuICAgIHRvcDogd2luZG93LnNjcmVlblRvcCArIE1hdGgucm91bmQoKHdpbmRvdy5vdXRlckhlaWdodCAtIGhlaWdodCkgLyAyKSxcbiAgICB3aWR0aFxuICB9O1xuICBjb25zdCBzdHJPcHRpb25zID0gT2JqZWN0LmVudHJpZXMob3B0aW9ucykubWFwKChba2V5LCB2YWx1ZV0pID0+IGAke2tleX09JHtKU09OLnN0cmluZ2lmeSh2YWx1ZSl9YCkucmVkdWNlKChhY2MsIGVudHJ5KSA9PiBgJHthY2N9LCAke2VudHJ5fWApO1xuICBjb25zdCBocmVmID0gdXJsIGluc3RhbmNlb2YgVVJMID8gdXJsLmhyZWYgOiB1cmw7XG4gIGNvbnN0IHByb21wdFdpbmRvdyA9IHdpbmRvdy5vcGVuKGhyZWYsIHZvaWQgMCwgc3RyT3B0aW9ucyk7XG4gIGlmIChwcm9tcHRXaW5kb3cgPT09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZG4ndCBvcGVuIHByb21wdFwiKTtcbiAgfVxuICByZXR1cm4gcHJvbXB0V2luZG93O1xufVxuYXN5bmMgZnVuY3Rpb24gd2FpdEZvclByb21wdFJlc3BvbnNlKHByb21wdFdpbmRvdykge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBjb25zdCBsaXN0ZW5lcnMgPSB7XG4gICAgICBvbk1lc3NhZ2U6IChtZXNzYWdlKSA9PiB7XG4gICAgICAgIGlmIChtZXNzYWdlLnNvdXJjZSAhPT0gcHJvbXB0V2luZG93KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsaXN0ZW5lcnMub25NZXNzYWdlKTtcbiAgICAgICAgY2xlYXJUaW1lb3V0KGxpc3RlbmVycy5wcm9tcHRQb2xsZXJJZCk7XG4gICAgICAgIHJlc29sdmUoe1xuICAgICAgICAgIGFyZ3M6IG1lc3NhZ2UuZGF0YSxcbiAgICAgICAgICBzdGF0dXM6IFwiYXBwcm92ZWRcIlxuICAgICAgICB9KTtcbiAgICAgIH0sXG4gICAgICBwcm9tcHRQb2xsZXJJZDogc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBpZiAocHJvbXB0V2luZG93LmNsb3NlZCkge1xuICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsaXN0ZW5lcnMub25NZXNzYWdlKTtcbiAgICAgICAgICBjbGVhclRpbWVvdXQobGlzdGVuZXJzLnByb21wdFBvbGxlcklkKTtcbiAgICAgICAgICByZXNvbHZlKHtcbiAgICAgICAgICAgIHN0YXR1czogXCJkaXNtaXNzZWRcIlxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9LCBQUk9NUFRfUE9MTEVSX0lOVEVSVkFMKVxuICAgIH07XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGxpc3RlbmVycy5vbk1lc3NhZ2UpO1xuICB9KTtcbn1cblxuLy8gc3JjL0lDRGFwcENsaWVudC50c1xudmFyIElDRGFwcENsaWVudCA9IGNsYXNzIGV4dGVuZHMgQUNQYWlyaW5nQ2xpZW50IHtcbiAgY29uc3RydWN0b3IoZGFwcElkLCB7IGZyb250ZW5kQmFzZVVSTCA9IERFRkFVTFRfRlJPTlRFTkRfVVJMLCAuLi5wYWlyaW5nQ2xpZW50Q29uZmlnIH0gPSB7fSkge1xuICAgIHN1cGVyKHBhaXJpbmdDbGllbnRDb25maWcpO1xuICAgIHRoaXMuZGFwcElkID0gZGFwcElkO1xuICAgIHRoaXMuZnJvbnRlbmRCYXNlVVJMID0gZnJvbnRlbmRCYXNlVVJMO1xuICB9XG4gIGFzeW5jIGNyZWF0ZVBhaXJpbmdSZXF1ZXN0KGRhcHBFZDI1NTE5UHVibGljS2V5QjY0KSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5heGlvc0luc3RhbmNlLnBvc3QoXCJ2MS9wYWlyaW5nL1wiLCB7XG4gICAgICAgIGRhcHBFZDI1NTE5UHVibGljS2V5QjY0LFxuICAgICAgICBkYXBwSWQ6IHRoaXMuZGFwcElkXG4gICAgICB9KTtcbiAgICAgIHJldHVybiByZXNwb25zZS5kYXRhLmRhdGEucGFpcmluZztcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGlmIChpc0F4aW9zRXJyb3IyKGVycikgJiYgZXJyLnJlc3BvbnNlPy5kYXRhPy5tZXNzYWdlID09PSBcIkRhcHAgbm90IGZvdW5kXCIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFVucmVnaXN0ZXJlZERhcHBFcnJvcigpO1xuICAgICAgfVxuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgfVxuICAvLyByZWdpb24gUHVibGljIEFQSVxuICAvKipcbiAgICogUmVxdWVzdHMgYSBjb25uZWN0aW9uIHRvIGFuIGFjY291bnQgKGludGVybmFsbHkga25vd24gYXMgcGFpcmluZykuXG4gICAqIEByZXR1cm5zIGVpdGhlciB0aGUgYWRkcmVzcyBvZiB0aGUgY29ubmVjdGVkIGFjY291bnQsIG9yIHVuZGVmaW5lZCBpZiB0aGVcbiAgICogY29ubmVjdGlvbiB3YXMgY2FuY2VsbGVkLlxuICAgKi9cbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBjb25zdCB7IHB1YmxpY0tleSwgc2VjcmV0S2V5IH0gPSBjcmVhdGVFZDI1NTE5S2V5UGFpcjIoKTtcbiAgICBjb25zdCBkYXBwRWQyNTUxOVB1YmxpY0tleUI2NCA9IGVuY29kZUJhc2U2NDMocHVibGljS2V5LmtleSk7XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChgJHt0aGlzLmZyb250ZW5kQmFzZVVSTH0vcGFpcmluZ2ApO1xuICAgIGNvbnN0IHByb21wdFdpbmRvdyA9IGF3YWl0IG9wZW5Qcm9tcHQodXJsLmhyZWYpO1xuICAgIGxldCBwYWlyaW5nSWQ7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBlbmRpbmdQYWlyaW5nID0gYXdhaXQgdGhpcy5jcmVhdGVQYWlyaW5nUmVxdWVzdChkYXBwRWQyNTUxOVB1YmxpY0tleUI2NCk7XG4gICAgICBwYWlyaW5nSWQgPSBwZW5kaW5nUGFpcmluZy5pZDtcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHByb21wdFdpbmRvdy5jbG9zZSgpO1xuICAgICAgdGhyb3cgZXJyO1xuICAgIH1cbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInBhaXJpbmdJZFwiLCBwYWlyaW5nSWQpO1xuICAgIHByb21wdFdpbmRvdy5sb2NhdGlvbi5ocmVmID0gdXJsLmhyZWY7XG4gICAgY29uc3QgcHJvbXB0UmVzcG9uc2UgPSBhd2FpdCB3YWl0Rm9yUHJvbXB0UmVzcG9uc2UocHJvbXB0V2luZG93KTtcbiAgICBpZiAocHJvbXB0UmVzcG9uc2Uuc3RhdHVzID09PSBcImRpc21pc3NlZFwiKSB7XG4gICAgICB2b2lkIHRoaXMuZGVsZXRlUGFpcmluZyhwYWlyaW5nSWQsIHNlY3JldEtleSwgcHVibGljS2V5KTtcbiAgICAgIHJldHVybiB2b2lkIDA7XG4gICAgfVxuICAgIGNvbnN0IGZpbmFsaXplZFBhaXJpbmcgPSBwcm9tcHRSZXNwb25zZS5hcmdzO1xuICAgIGF3YWl0IHRoaXMuYWRkUGFpcmluZyh7IHB1YmxpY0tleSwgc2VjcmV0S2V5IH0sIGZpbmFsaXplZFBhaXJpbmcpO1xuICAgIHJldHVybiBmaW5hbGl6ZWRQYWlyaW5nLmFjY291bnQuYWNjb3VudEFkZHJlc3M7XG4gIH1cbiAgYXN5bmMgb2ZmYm9hcmQoYWRkcmVzcykge1xuICAgIGNvbnN0IHBhaXJpbmcgPSBhd2FpdCB0aGlzLmFjY2Vzc29ycy5nZXQoYWRkcmVzcyk7XG4gICAgaWYgKHBhaXJpbmcgPT09IHZvaWQgMCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVGhpcyBhY2NvdW50IGlzIG5vdCBwYWlyZWRcIik7XG4gICAgfVxuICAgIGNvbnN0IHdhbGxldElkID0gcGFpcmluZy5kYXBwV2FsbGV0SWQ7XG4gICAgaWYgKHdhbGxldElkID09PSB2b2lkIDApIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlRoaXMgYWNjb3VudCBjYW5ub3QgYmUgb2ZmYm9hcmRlZFwiKTtcbiAgICB9XG4gICAgY29uc3QgdXJsID0gbmV3IFVSTChgJHt0aGlzLmZyb250ZW5kQmFzZVVSTH0vb2ZmYm9hcmRpbmc/d2FsbGV0SWQ9JHt3YWxsZXRJZH1gKTtcbiAgICBjb25zdCBwcm9tcHRXaW5kb3cgPSBvcGVuUHJvbXB0KHVybCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCB3YWl0Rm9yUHJvbXB0UmVzcG9uc2UocHJvbXB0V2luZG93KTtcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSBcImFwcHJvdmVkXCIgJiYgcmVzcG9uc2UuYXJncy5vZmZib2FyZGVkKSB7XG4gICAgICB0aGlzLmRpc2Nvbm5lY3QoYWRkcmVzcyk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIC8vIGVuZHJlZ2lvblxufTtcblxuLy8gc3JjL0tleWxlc3NDbGllbnQudHNcbmltcG9ydCB7XG4gIENvbm5lY3RSZXF1ZXN0IGFzIENvbm5lY3RSZXF1ZXN0MixcbiAgQ29ubmVjdFJlc3BvbnNlIGFzIENvbm5lY3RSZXNwb25zZTIsXG4gIERpc2Nvbm5lY3RSZXF1ZXN0IGFzIERpc2Nvbm5lY3RSZXF1ZXN0MixcbiAgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0IGFzIEdldENvbm5lY3RlZEFjY291bnRzUmVxdWVzdDIsXG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UgYXMgR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZTIsXG4gIElzQ29ubmVjdGVkUmVxdWVzdCxcbiAgSXNDb25uZWN0ZWRSZXNwb25zZSxcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdCBhcyBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0MixcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UgYXMgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UyLFxuICBTaWduTWVzc2FnZVJlcXVlc3QgYXMgU2lnbk1lc3NhZ2VSZXF1ZXN0MixcbiAgU2lnbk1lc3NhZ2VSZXNwb25zZSBhcyBTaWduTWVzc2FnZVJlc3BvbnNlMixcbiAgU2lnblRyYW5zYWN0aW9uUmVxdWVzdCBhcyBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0MixcbiAgU2lnblRyYW5zYWN0aW9uUmVzcG9uc2UgYXMgU2lnblRyYW5zYWN0aW9uUmVzcG9uc2UyXG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5pbXBvcnQgeyBXZWJXYWxsZXRUcmFuc3BvcnQgYXMgV2ViV2FsbGV0VHJhbnNwb3J0MiB9IGZyb20gXCJAYXB0b3MtY29ubmVjdC93ZWItdHJhbnNwb3J0XCI7XG5pbXBvcnQgeyBOZXR3b3JrTmFtZSBhcyBOZXR3b3JrTmFtZTMgfSBmcm9tIFwiQGlkZW50aXR5LWNvbm5lY3QvYXBpXCI7XG52YXIgQUNLZXlsZXNzQ2xpZW50ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcih7XG4gICAgZGFwcEltYWdlVVJJLFxuICAgIGRhcHBOYW1lLFxuICAgIGRlZmF1bHROZXR3b3JrTmFtZSA9IE5ldHdvcmtOYW1lMy5NQUlOTkVULFxuICAgIGZyb250ZW5kQmFzZVVSTCA9IERFRkFVTFRfRlJPTlRFTkRfVVJMXG4gIH0gPSB7fSkge1xuICAgIHRoaXMuZGVmYXVsdE5ldHdvcmtOYW1lID0gZGVmYXVsdE5ldHdvcmtOYW1lO1xuICAgIHRoaXMuZGFwcEluZm8gPSB7XG4gICAgICBkb21haW46IHdpbmRvdy5sb2NhdGlvbi5vcmlnaW4sXG4gICAgICBpbWFnZVVSSTogZGFwcEltYWdlVVJJLFxuICAgICAgbmFtZTogZGFwcE5hbWUgPz8gZG9jdW1lbnQudGl0bGVcbiAgICB9O1xuICAgIHRoaXMudHJhbnNwb3J0ID0gbmV3IFdlYldhbGxldFRyYW5zcG9ydDIoZnJvbnRlbmRCYXNlVVJMKTtcbiAgfVxuICAvLyByZWdpb24gUHVibGljIEFQSVxuICBhc3luYyBpc0Nvbm5lY3RlZCgpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IElzQ29ubmVjdGVkUmVxdWVzdC5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gSXNDb25uZWN0ZWRSZXNwb25zZS5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIGdldENvbm5lY3RlZEFjY291bnRzKCkge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gR2V0Q29ubmVjdGVkQWNjb3VudHNSZXNwb25zZTIuZGVzZXJpYWxpemUoc2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICByZXR1cm4gcmVzcG9uc2UuYXJncztcbiAgfVxuICBhc3luYyBkaXNjb25uZWN0KCkge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXF1ZXN0ID0gRGlzY29ubmVjdFJlcXVlc3QyLnNlcmlhbGl6ZSh0aGlzLmRhcHBJbmZvKTtcbiAgICBhd2FpdCB0aGlzLnRyYW5zcG9ydC5zZW5kUmVxdWVzdChzZXJpYWxpemVkUmVxdWVzdCk7XG4gIH1cbiAgYXN5bmMgY29ubmVjdCgpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IENvbm5lY3RSZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gQ29ubmVjdFJlc3BvbnNlMi5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIHNpZ25NZXNzYWdlKGFyZ3MpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmVxdWVzdCA9IFNpZ25NZXNzYWdlUmVxdWVzdDIuc2VyaWFsaXplKHRoaXMuZGFwcEluZm8sIGFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IFNpZ25NZXNzYWdlUmVzcG9uc2UyLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgYXN5bmMgc2lnblRyYW5zYWN0aW9uKGFyZ3MpIHtcbiAgICBjb25zdCBub3JtYWxpemVkQXJncyA9IFwidHJhbnNhY3Rpb25cIiBpbiBhcmdzID8gU2lnblRyYW5zYWN0aW9uUmVxdWVzdDIubm9ybWFsaXplQXJncyhhcmdzKSA6IGFyZ3M7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgbm9ybWFsaXplZEFyZ3MpO1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRSZXNwb25zZSA9IGF3YWl0IHRoaXMudHJhbnNwb3J0LnNlbmRSZXF1ZXN0KHNlcmlhbGl6ZWRSZXF1ZXN0KTtcbiAgICBjb25zdCByZXNwb25zZSA9IFNpZ25UcmFuc2FjdGlvblJlc3BvbnNlMi5kZXNlcmlhbGl6ZShzZXJpYWxpemVkUmVzcG9uc2UpO1xuICAgIHJldHVybiByZXNwb25zZS5hcmdzO1xuICB9XG4gIGFzeW5jIHNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvbihhcmdzKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlcXVlc3QgPSBTaWduQW5kU3VibWl0VHJhbnNhY3Rpb25SZXF1ZXN0Mi5zZXJpYWxpemUodGhpcy5kYXBwSW5mbywgYXJncyk7XG4gICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy50cmFuc3BvcnQuc2VuZFJlcXVlc3Qoc2VyaWFsaXplZFJlcXVlc3QpO1xuICAgIGNvbnN0IHJlc3BvbnNlID0gU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVzcG9uc2UyLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgcmV0dXJuIHJlc3BvbnNlLmFyZ3M7XG4gIH1cbiAgLy8gZW5kcmVnaW9uXG59O1xuZXhwb3J0IHtcbiAgQUNEYXBwQ2xpZW50LFxuICBBQ0tleWxlc3NDbGllbnQsXG4gIERBUFBfUEFJUklOR1NfV0lORE9XX1NUT1JBR0VfS0VZLFxuICBJQ0RhcHBDbGllbnQsXG4gIHdpbmRvd1N0YXRlQWNjZXNzb3JzXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/node_modules/@aptos-connect/web-transport/dist/index.mjs":
/*!************************************************************************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/node_modules/@aptos-connect/web-transport/dist/index.mjs ***!
  \************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   WebWalletTransport: () => (/* binding */ WebWalletTransport)\n/* harmony export */ });\n/* harmony import */ var _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-connect/wallet-api */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@aptos-connect/wallet-api/dist/index.mjs\");\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var _telegram_apps_bridge__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @telegram-apps/bridge */ \"(ssr)/./node_modules/@telegram-apps/bridge/dist/index.js\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uuid */ \"(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/uuid/dist/esm-node/v4.js\");\n// src/index.ts\n\n\n// src/prompt.ts\n\nvar DEFAULT_PROMPT_SIZE = { height: 695, width: 465 };\nvar PROMPT_POLLER_INTERVAL = 500;\nvar dismissalSerializedResponse = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.serialize({ status: \"dismissed\" });\nvar PromptUnauthorizedError = class extends Error {\n  constructor() {\n    super(\"Unauthorized\");\n  }\n};\nfunction openPrompt(url, size = DEFAULT_PROMPT_SIZE) {\n  const { height, width } = size;\n  const options = {\n    height,\n    left: window.screenLeft + Math.round((window.outerWidth - width) / 2),\n    popup: true,\n    top: window.screenTop + Math.round((window.outerHeight - height) / 2),\n    width\n  };\n  const strOptions = Object.entries(options).map(([key, value]) => `${key}=${JSON.stringify(value)}`).reduce((acc, entry) => `${acc}, ${entry}`);\n  const href = url instanceof URL ? url.href : url;\n  const promptWindow = window.open(href, void 0, strOptions);\n  if (promptWindow === null) {\n    throw new Error(\"Couldn't open prompt\");\n  }\n  return promptWindow;\n}\nasync function waitForPromptResponse(baseUrl, promptWindow) {\n  return new Promise((resolve, reject) => {\n    const listeners = {\n      onMessage: (message) => {\n        if (message.source !== promptWindow || message.origin !== baseUrl) {\n          return;\n        }\n        if ((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.isTypedMessage)(_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.PromptUnauthorizedErrorMessage, message.data)) {\n          window.removeEventListener(\"message\", listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          reject(new PromptUnauthorizedError());\n          return;\n        }\n        if ((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.isTypedMessage)(_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.PromptOpenerPingRequestMessage, message.data)) {\n          promptWindow.postMessage(new _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.PromptOpenerPingResponseMessage(), baseUrl);\n          return;\n        }\n        if ((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.isTypedMessage)(_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.PromptApprovalResponseMessage, message.data)) {\n          window.removeEventListener(\"message\", listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve(message.data.serializedValue);\n        }\n      },\n      promptPollerId: setInterval(() => {\n        if (promptWindow.closed) {\n          window.removeEventListener(\"message\", listeners.onMessage);\n          clearTimeout(listeners.promptPollerId);\n          resolve(dismissalSerializedResponse);\n        }\n      }, PROMPT_POLLER_INTERVAL)\n    };\n    window.addEventListener(\"message\", listeners.onMessage);\n  });\n}\n\n// src/state.ts\n\n\nvar localDappStateKey = \"@aptos-connect/dapp-local-state\";\nfunction serializeLocalDappState(state) {\n  const serializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Serializer();\n  serializer.serializeU32AsUleb128(state.connectedAccounts.length);\n  for (const account of state.connectedAccounts) {\n    (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.serializeAccountInfo)(serializer, account);\n  }\n  return serializer.toUint8Array();\n}\nfunction deserializeLocalDappState(serializedValue) {\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Deserializer(serializedValue);\n  const connectedAccountsLength = deserializer.deserializeUleb128AsU32();\n  const connectedAccounts = [];\n  for (let i = 0; i < connectedAccountsLength; i += 1) {\n    connectedAccounts.push((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.deserializeAccountInfo)(deserializer));\n  }\n  return { connectedAccounts };\n}\nfunction getState() {\n  const encodedValue = window.localStorage.getItem(localDappStateKey);\n  return encodedValue ? deserializeLocalDappState((0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.base64ToBytes)(encodedValue)) : { connectedAccounts: [] };\n}\nfunction setState(state) {\n  const serializedValue = serializeLocalDappState(state);\n  const encodedValue = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.bytesToBase64)(serializedValue);\n  window.localStorage.setItem(localDappStateKey, encodedValue);\n}\nfunction getConnectedAccounts() {\n  const state = getState();\n  return state.connectedAccounts;\n}\nfunction addConnectedAccount(account) {\n  const { connectedAccounts, ...state } = getState();\n  connectedAccounts.push(account);\n  setState({ ...state, connectedAccounts });\n}\nfunction removeConnectedAccount(address) {\n  const { connectedAccounts, ...state } = getState();\n  const index = connectedAccounts.findIndex((a) => a.address.equals(address));\n  if (index >= 0) {\n    connectedAccounts.splice(index, 1);\n  }\n  setState({ ...state, connectedAccounts });\n}\n\n// src/telegram/openTelegramPrompt.ts\n\n\n\n\n// src/telegram/createWalletRequest.ts\n\nasync function createWalletRequest(baseUrl, request) {\n  const encodedClientIdentityKey = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.bytesToBase64url)(request.clientIdentityKey.toUint8Array());\n  const response = await fetch(`${baseUrl}/v1/dapp/clients/${encodedClientIdentityKey}/requests/`, {\n    body: JSON.stringify({\n      body: (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.encodeWalletRequestBody)(request.body),\n      id: request.id,\n      signature: (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.bytesToBase64)(request.signature.toUint8Array()),\n      timestamp: request.timestamp\n    }),\n    headers: { Accept: \"application/json\", \"Content-Type\": \"application/json\" },\n    method: \"post\"\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed creating the wallet request\");\n  }\n}\n\n// src/telegram/getClientIdentityKey.ts\n\nvar identityKeyStorageKey = \"@aptos-connect/client-identity-key\";\nfunction getClientIdentityKey() {\n  const serialized = window.localStorage.getItem(identityKeyStorageKey);\n  if (serialized) {\n    return new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Ed25519PrivateKey(serialized);\n  }\n  const identityKey = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_1__.Ed25519PrivateKey.generate();\n  window.localStorage.setItem(identityKeyStorageKey, identityKey.toString());\n  return identityKey;\n}\n\n// src/telegram/getWalletResponse.ts\n\n\n// src/telegram/smartPolling.ts\nvar ON_RESUME_DELAY = 300;\nvar FG_RESPONSE_POLLING_INTERVAL = 2e3;\nvar BG_RESPONSE_POLLING_INTERVAL = 3e3;\nvar POLLING_TIMEOUT = 5 * 6e4;\nfunction waitFor(milliseconds) {\n  let timeoutId;\n  let cancel = () => {\n  };\n  const timer = new Promise((resolve) => {\n    timeoutId = setTimeout(resolve, milliseconds);\n    cancel = () => {\n      clearTimeout(timeoutId);\n      resolve();\n    };\n  });\n  timer.cancel = cancel;\n  return timer;\n}\nasync function smartPolling(callback) {\n  let timer;\n  let justResumed = false;\n  let pollingInterval = BG_RESPONSE_POLLING_INTERVAL;\n  const onWindowFocus = () => {\n    justResumed = true;\n    pollingInterval = FG_RESPONSE_POLLING_INTERVAL;\n    timer?.cancel();\n  };\n  const onWindowBlur = () => {\n    pollingInterval = BG_RESPONSE_POLLING_INTERVAL;\n  };\n  window.addEventListener(\"focus\", onWindowFocus);\n  window.addEventListener(\"blur\", onWindowBlur);\n  try {\n    const startTime = Date.now();\n    while (Date.now() - startTime < POLLING_TIMEOUT) {\n      timer = waitFor(pollingInterval);\n      await timer;\n      if (justResumed) {\n        timer = waitFor(ON_RESUME_DELAY);\n        await timer;\n      }\n      const response = await callback();\n      if (response.status === 200) {\n        return response;\n      }\n      justResumed = false;\n    }\n    throw new Error(\"Timeout\");\n  } finally {\n    window.removeEventListener(\"focus\", onWindowFocus);\n    window.removeEventListener(\"blur\", onWindowFocus);\n  }\n}\n\n// src/telegram/getWalletResponse.ts\nasync function getWalletResponse(baseUrl, clientIdentityKey, requestId) {\n  const encodedClientIdentityKey = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.bytesToBase64url)(clientIdentityKey.toUint8Array());\n  const url = new URL(`${baseUrl}/v1/dapp/clients/${encodedClientIdentityKey}/requests/${requestId}/response/`);\n  const response = await smartPolling(\n    () => fetch(url, {\n      headers: { Accept: \"application/json\" },\n      method: \"get\"\n    })\n  );\n  const responseBody = await response.json();\n  const data = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.base64ToBytes)(responseBody.data.body);\n  return { data };\n}\n\n// src/telegram/openTelegramPrompt.ts\nasync function openTelegramPrompt(baseUrl, request) {\n  const identityKey = getClientIdentityKey();\n  const clientIdentityKey = identityKey.publicKey();\n  const requestId = (0,uuid__WEBPACK_IMPORTED_MODULE_2__[\"default\"])();\n  const timestamp = Date.now();\n  const challenge = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.makePopupWalletRequestChallenge)({ body: request, id: requestId, timestamp });\n  const signature = identityKey.sign(challenge);\n  const signedWalletRequest = {\n    body: request,\n    clientIdentityKey,\n    id: requestId,\n    signature,\n    timestamp\n  };\n  let encodedRequest = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.encodePopupWalletRequest)(signedWalletRequest);\n  if (encodedRequest.length > 1024) {\n    void createWalletRequest(baseUrl, signedWalletRequest);\n    encodedRequest = (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.encodePopupWalletRequest)({\n      clientIdentityKey,\n      id: requestId,\n      signature,\n      timestamp\n    });\n  }\n  (0,_telegram_apps_bridge__WEBPACK_IMPORTED_MODULE_3__.postEvent)(\"web_app_open_tg_link\", {\n    path_full: `/AptosConnectBot/AptosConnect?startapp=${encodedRequest}`\n  });\n  return getWalletResponse(baseUrl, clientIdentityKey, requestId);\n}\n\n// src/telegram/index.ts\nfunction isTelegramMiniApp() {\n  return window.TelegramWebviewProxy !== void 0;\n}\n\n// src/index.ts\nvar WebWalletTransport = class {\n  constructor(baseUrl) {\n    this.baseUrl = baseUrl;\n    this.baseUrl = baseUrl;\n  }\n  async sendPromptRequest(request) {\n    if (isTelegramMiniApp()) {\n      return openTelegramPrompt(this.baseUrl, request);\n    }\n    const url = new URL(`${this.baseUrl}/prompt/`);\n    url.searchParams.set(\"request\", (0,_aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.urlEncodeWalletRequest)(request));\n    const prompt = openPrompt(url);\n    return waitForPromptResponse(this.baseUrl, prompt);\n  }\n  async sendRequest(request) {\n    switch (request.name) {\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedRequest.name: {\n        const connectedAccounts = getConnectedAccounts();\n        return _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.IsConnectedResponse.serialize(connectedAccounts.length > 0);\n      }\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsRequest.name: {\n        const connectedAccounts = getConnectedAccounts();\n        return _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.GetConnectedAccountsResponse.serialize(connectedAccounts);\n      }\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectRequest.name: {\n        const serializedResponse = await this.sendPromptRequest(request);\n        const response = _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.ConnectResponse.deserialize(serializedResponse);\n        if (response.args.status === \"approved\") {\n          const { account, pairing } = response.args.args;\n          if (pairing === void 0) {\n            addConnectedAccount(account);\n          }\n        }\n        return serializedResponse;\n      }\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectRequest.name: {\n        const [activeAccount] = getConnectedAccounts();\n        if (activeAccount) {\n          removeConnectedAccount(activeAccount.address);\n        }\n        return _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.DisconnectResponse.serialize({});\n      }\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignMessageRequest.name:\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignTransactionRequest.name:\n      case _aptos_connect_wallet_api__WEBPACK_IMPORTED_MODULE_0__.SignAndSubmitTransactionRequest.name: {\n        return this.sendPromptRequest(request);\n      }\n      default: {\n        throw new Error(\"Unexpected request\");\n      }\n    }\n  }\n};\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC9kYXBwLXNkay9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2ViLXRyYW5zcG9ydC9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBO0FBY21DOztBQUVuQztBQVFtQztBQUNuQyw0QkFBNEI7QUFDNUI7QUFDQSxrQ0FBa0Msc0VBQWUsYUFBYSxxQkFBcUI7QUFDbkY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxnQkFBZ0I7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0UsSUFBSSxHQUFHLHNCQUFzQiw2QkFBNkIsSUFBSSxJQUFJLE1BQU07QUFDOUk7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseUVBQWMsQ0FBQyxxRkFBOEI7QUFDekQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkseUVBQWMsQ0FBQyxxRkFBOEI7QUFDekQsdUNBQXVDLHNGQUErQjtBQUN0RTtBQUNBO0FBQ0EsWUFBWSx5RUFBYyxDQUFDLG9GQUE2QjtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFQTtBQU1tQztBQUMyQjtBQUM5RDtBQUNBO0FBQ0EseUJBQXlCLDBEQUFVO0FBQ25DO0FBQ0E7QUFDQSxJQUFJLCtFQUFvQjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJCQUEyQiw0REFBWTtBQUN2QztBQUNBO0FBQ0Esa0JBQWtCLDZCQUE2QjtBQUMvQywyQkFBMkIsaUZBQXNCO0FBQ2pEO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRCx3RUFBYSxvQkFBb0I7QUFDbkY7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLHdFQUFhO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSw4QkFBOEI7QUFDeEM7QUFDQSxhQUFhLDZCQUE2QjtBQUMxQztBQUNBO0FBQ0EsVUFBVSw4QkFBOEI7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLDZCQUE2QjtBQUMxQzs7QUFFQTtBQUltQztBQUNvQztBQUMvQjs7QUFFeEM7QUFLbUM7QUFDbkM7QUFDQSxtQ0FBbUMsMkVBQWdCO0FBQ25ELGtDQUFrQyxRQUFRLG1CQUFtQix5QkFBeUI7QUFDdEY7QUFDQSxZQUFZLGtGQUF1QjtBQUNuQztBQUNBLGlCQUFpQix3RUFBYztBQUMvQjtBQUNBLEtBQUs7QUFDTCxlQUFlLGdFQUFnRTtBQUMvRTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUN1RDtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsaUVBQWlCO0FBQ2hDO0FBQ0Esc0JBQXNCLGlFQUFpQjtBQUN2QztBQUNBO0FBQ0E7O0FBRUE7QUFDbUg7O0FBRW5IO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLG1DQUFtQywyRUFBaUI7QUFDcEQseUJBQXlCLFFBQVEsbUJBQW1CLHlCQUF5QixZQUFZLFVBQVU7QUFDbkc7QUFDQTtBQUNBLGlCQUFpQiw0QkFBNEI7QUFDN0M7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLGVBQWUsd0VBQWM7QUFDN0IsV0FBVztBQUNYOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGdEQUFVO0FBQzlCO0FBQ0Esb0JBQW9CLDBGQUErQixHQUFHLHlDQUF5QztBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUJBQXVCLG1GQUF3QjtBQUMvQztBQUNBO0FBQ0EscUJBQXFCLG1GQUF3QjtBQUM3QztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLEVBQUUsZ0VBQWlCO0FBQ25CLHlEQUF5RCxlQUFlO0FBQ3hFLEdBQUc7QUFDSDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLGFBQWE7QUFDeEMsb0NBQW9DLGlGQUFzQjtBQUMxRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx5RUFBa0I7QUFDN0I7QUFDQSxlQUFlLDBFQUFtQjtBQUNsQztBQUNBLFdBQVcsa0ZBQTJCO0FBQ3RDO0FBQ0EsZUFBZSxtRkFBNEI7QUFDM0M7QUFDQSxXQUFXLHFFQUFjO0FBQ3pCO0FBQ0EseUJBQXlCLHNFQUFnQjtBQUN6QztBQUNBLGtCQUFrQixtQkFBbUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyx3RUFBaUI7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUFlLHlFQUFrQixhQUFhO0FBQzlDO0FBQ0EsV0FBVyx5RUFBa0I7QUFDN0IsV0FBVyw2RUFBc0I7QUFDakMsV0FBVyxzRkFBK0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdFO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uZXh0anMtYm9pbGVycGxhdGUtdGVtcGxhdGUvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC9kYXBwLXNkay9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2ViLXRyYW5zcG9ydC9kaXN0L2luZGV4Lm1qcz9lMDkxIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIHNyYy9pbmRleC50c1xuaW1wb3J0IHtcbiAgQ29ubmVjdFJlcXVlc3QsXG4gIENvbm5lY3RSZXNwb25zZSBhcyBDb25uZWN0UmVzcG9uc2UyLFxuICBEaXNjb25uZWN0UmVxdWVzdCxcbiAgRGlzY29ubmVjdFJlc3BvbnNlLFxuICBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QsXG4gIEdldENvbm5lY3RlZEFjY291bnRzUmVzcG9uc2UsXG4gIElzQ29ubmVjdGVkUmVxdWVzdCxcbiAgSXNDb25uZWN0ZWRSZXNwb25zZSxcbiAgU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdCxcbiAgU2lnbk1lc3NhZ2VSZXF1ZXN0LFxuICBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0LFxuICB1cmxFbmNvZGVXYWxsZXRSZXF1ZXN0XG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5cbi8vIHNyYy9wcm9tcHQudHNcbmltcG9ydCB7XG4gIENvbm5lY3RSZXNwb25zZSxcbiAgaXNUeXBlZE1lc3NhZ2UsXG4gIFByb21wdEFwcHJvdmFsUmVzcG9uc2VNZXNzYWdlLFxuICBQcm9tcHRPcGVuZXJQaW5nUmVxdWVzdE1lc3NhZ2UsXG4gIFByb21wdE9wZW5lclBpbmdSZXNwb25zZU1lc3NhZ2UsXG4gIFByb21wdFVuYXV0aG9yaXplZEVycm9yTWVzc2FnZVxufSBmcm9tIFwiQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFwaVwiO1xudmFyIERFRkFVTFRfUFJPTVBUX1NJWkUgPSB7IGhlaWdodDogNjk1LCB3aWR0aDogNDY1IH07XG52YXIgUFJPTVBUX1BPTExFUl9JTlRFUlZBTCA9IDUwMDtcbnZhciBkaXNtaXNzYWxTZXJpYWxpemVkUmVzcG9uc2UgPSBDb25uZWN0UmVzcG9uc2Uuc2VyaWFsaXplKHsgc3RhdHVzOiBcImRpc21pc3NlZFwiIH0pO1xudmFyIFByb21wdFVuYXV0aG9yaXplZEVycm9yID0gY2xhc3MgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHN1cGVyKFwiVW5hdXRob3JpemVkXCIpO1xuICB9XG59O1xuZnVuY3Rpb24gb3BlblByb21wdCh1cmwsIHNpemUgPSBERUZBVUxUX1BST01QVF9TSVpFKSB7XG4gIGNvbnN0IHsgaGVpZ2h0LCB3aWR0aCB9ID0gc2l6ZTtcbiAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICBoZWlnaHQsXG4gICAgbGVmdDogd2luZG93LnNjcmVlbkxlZnQgKyBNYXRoLnJvdW5kKCh3aW5kb3cub3V0ZXJXaWR0aCAtIHdpZHRoKSAvIDIpLFxuICAgIHBvcHVwOiB0cnVlLFxuICAgIHRvcDogd2luZG93LnNjcmVlblRvcCArIE1hdGgucm91bmQoKHdpbmRvdy5vdXRlckhlaWdodCAtIGhlaWdodCkgLyAyKSxcbiAgICB3aWR0aFxuICB9O1xuICBjb25zdCBzdHJPcHRpb25zID0gT2JqZWN0LmVudHJpZXMob3B0aW9ucykubWFwKChba2V5LCB2YWx1ZV0pID0+IGAke2tleX09JHtKU09OLnN0cmluZ2lmeSh2YWx1ZSl9YCkucmVkdWNlKChhY2MsIGVudHJ5KSA9PiBgJHthY2N9LCAke2VudHJ5fWApO1xuICBjb25zdCBocmVmID0gdXJsIGluc3RhbmNlb2YgVVJMID8gdXJsLmhyZWYgOiB1cmw7XG4gIGNvbnN0IHByb21wdFdpbmRvdyA9IHdpbmRvdy5vcGVuKGhyZWYsIHZvaWQgMCwgc3RyT3B0aW9ucyk7XG4gIGlmIChwcm9tcHRXaW5kb3cgPT09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJDb3VsZG4ndCBvcGVuIHByb21wdFwiKTtcbiAgfVxuICByZXR1cm4gcHJvbXB0V2luZG93O1xufVxuYXN5bmMgZnVuY3Rpb24gd2FpdEZvclByb21wdFJlc3BvbnNlKGJhc2VVcmwsIHByb21wdFdpbmRvdykge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvbnN0IGxpc3RlbmVycyA9IHtcbiAgICAgIG9uTWVzc2FnZTogKG1lc3NhZ2UpID0+IHtcbiAgICAgICAgaWYgKG1lc3NhZ2Uuc291cmNlICE9PSBwcm9tcHRXaW5kb3cgfHwgbWVzc2FnZS5vcmlnaW4gIT09IGJhc2VVcmwpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGlzVHlwZWRNZXNzYWdlKFByb21wdFVuYXV0aG9yaXplZEVycm9yTWVzc2FnZSwgbWVzc2FnZS5kYXRhKSkge1xuICAgICAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsaXN0ZW5lcnMub25NZXNzYWdlKTtcbiAgICAgICAgICBjbGVhclRpbWVvdXQobGlzdGVuZXJzLnByb21wdFBvbGxlcklkKTtcbiAgICAgICAgICByZWplY3QobmV3IFByb21wdFVuYXV0aG9yaXplZEVycm9yKCkpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNUeXBlZE1lc3NhZ2UoUHJvbXB0T3BlbmVyUGluZ1JlcXVlc3RNZXNzYWdlLCBtZXNzYWdlLmRhdGEpKSB7XG4gICAgICAgICAgcHJvbXB0V2luZG93LnBvc3RNZXNzYWdlKG5ldyBQcm9tcHRPcGVuZXJQaW5nUmVzcG9uc2VNZXNzYWdlKCksIGJhc2VVcmwpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaXNUeXBlZE1lc3NhZ2UoUHJvbXB0QXBwcm92YWxSZXNwb25zZU1lc3NhZ2UsIG1lc3NhZ2UuZGF0YSkpIHtcbiAgICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1lc3NhZ2VcIiwgbGlzdGVuZXJzLm9uTWVzc2FnZSk7XG4gICAgICAgICAgY2xlYXJUaW1lb3V0KGxpc3RlbmVycy5wcm9tcHRQb2xsZXJJZCk7XG4gICAgICAgICAgcmVzb2x2ZShtZXNzYWdlLmRhdGEuc2VyaWFsaXplZFZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHByb21wdFBvbGxlcklkOiBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICAgIGlmIChwcm9tcHRXaW5kb3cuY2xvc2VkKSB7XG4gICAgICAgICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtZXNzYWdlXCIsIGxpc3RlbmVycy5vbk1lc3NhZ2UpO1xuICAgICAgICAgIGNsZWFyVGltZW91dChsaXN0ZW5lcnMucHJvbXB0UG9sbGVySWQpO1xuICAgICAgICAgIHJlc29sdmUoZGlzbWlzc2FsU2VyaWFsaXplZFJlc3BvbnNlKTtcbiAgICAgICAgfVxuICAgICAgfSwgUFJPTVBUX1BPTExFUl9JTlRFUlZBTClcbiAgICB9O1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLCBsaXN0ZW5lcnMub25NZXNzYWdlKTtcbiAgfSk7XG59XG5cbi8vIHNyYy9zdGF0ZS50c1xuaW1wb3J0IHtcbiAgYmFzZTY0VG9CeXRlcyxcbiAgYnl0ZXNUb0Jhc2U2NCxcbiAgZGVzZXJpYWxpemVBY2NvdW50SW5mbyxcbiAgc2VyaWFsaXplQWNjb3VudEluZm9cbn0gZnJvbSBcIkBhcHRvcy1jb25uZWN0L3dhbGxldC1hcGlcIjtcbmltcG9ydCB7IERlc2VyaWFsaXplciwgU2VyaWFsaXplciB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbnZhciBsb2NhbERhcHBTdGF0ZUtleSA9IFwiQGFwdG9zLWNvbm5lY3QvZGFwcC1sb2NhbC1zdGF0ZVwiO1xuZnVuY3Rpb24gc2VyaWFsaXplTG9jYWxEYXBwU3RhdGUoc3RhdGUpIHtcbiAgY29uc3Qgc2VyaWFsaXplciA9IG5ldyBTZXJpYWxpemVyKCk7XG4gIHNlcmlhbGl6ZXIuc2VyaWFsaXplVTMyQXNVbGViMTI4KHN0YXRlLmNvbm5lY3RlZEFjY291bnRzLmxlbmd0aCk7XG4gIGZvciAoY29uc3QgYWNjb3VudCBvZiBzdGF0ZS5jb25uZWN0ZWRBY2NvdW50cykge1xuICAgIHNlcmlhbGl6ZUFjY291bnRJbmZvKHNlcmlhbGl6ZXIsIGFjY291bnQpO1xuICB9XG4gIHJldHVybiBzZXJpYWxpemVyLnRvVWludDhBcnJheSgpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVMb2NhbERhcHBTdGF0ZShzZXJpYWxpemVkVmFsdWUpIHtcbiAgY29uc3QgZGVzZXJpYWxpemVyID0gbmV3IERlc2VyaWFsaXplcihzZXJpYWxpemVkVmFsdWUpO1xuICBjb25zdCBjb25uZWN0ZWRBY2NvdW50c0xlbmd0aCA9IGRlc2VyaWFsaXplci5kZXNlcmlhbGl6ZVVsZWIxMjhBc1UzMigpO1xuICBjb25zdCBjb25uZWN0ZWRBY2NvdW50cyA9IFtdO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGNvbm5lY3RlZEFjY291bnRzTGVuZ3RoOyBpICs9IDEpIHtcbiAgICBjb25uZWN0ZWRBY2NvdW50cy5wdXNoKGRlc2VyaWFsaXplQWNjb3VudEluZm8oZGVzZXJpYWxpemVyKSk7XG4gIH1cbiAgcmV0dXJuIHsgY29ubmVjdGVkQWNjb3VudHMgfTtcbn1cbmZ1bmN0aW9uIGdldFN0YXRlKCkge1xuICBjb25zdCBlbmNvZGVkVmFsdWUgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0obG9jYWxEYXBwU3RhdGVLZXkpO1xuICByZXR1cm4gZW5jb2RlZFZhbHVlID8gZGVzZXJpYWxpemVMb2NhbERhcHBTdGF0ZShiYXNlNjRUb0J5dGVzKGVuY29kZWRWYWx1ZSkpIDogeyBjb25uZWN0ZWRBY2NvdW50czogW10gfTtcbn1cbmZ1bmN0aW9uIHNldFN0YXRlKHN0YXRlKSB7XG4gIGNvbnN0IHNlcmlhbGl6ZWRWYWx1ZSA9IHNlcmlhbGl6ZUxvY2FsRGFwcFN0YXRlKHN0YXRlKTtcbiAgY29uc3QgZW5jb2RlZFZhbHVlID0gYnl0ZXNUb0Jhc2U2NChzZXJpYWxpemVkVmFsdWUpO1xuICB3aW5kb3cubG9jYWxTdG9yYWdlLnNldEl0ZW0obG9jYWxEYXBwU3RhdGVLZXksIGVuY29kZWRWYWx1ZSk7XG59XG5mdW5jdGlvbiBnZXRDb25uZWN0ZWRBY2NvdW50cygpIHtcbiAgY29uc3Qgc3RhdGUgPSBnZXRTdGF0ZSgpO1xuICByZXR1cm4gc3RhdGUuY29ubmVjdGVkQWNjb3VudHM7XG59XG5mdW5jdGlvbiBhZGRDb25uZWN0ZWRBY2NvdW50KGFjY291bnQpIHtcbiAgY29uc3QgeyBjb25uZWN0ZWRBY2NvdW50cywgLi4uc3RhdGUgfSA9IGdldFN0YXRlKCk7XG4gIGNvbm5lY3RlZEFjY291bnRzLnB1c2goYWNjb3VudCk7XG4gIHNldFN0YXRlKHsgLi4uc3RhdGUsIGNvbm5lY3RlZEFjY291bnRzIH0pO1xufVxuZnVuY3Rpb24gcmVtb3ZlQ29ubmVjdGVkQWNjb3VudChhZGRyZXNzKSB7XG4gIGNvbnN0IHsgY29ubmVjdGVkQWNjb3VudHMsIC4uLnN0YXRlIH0gPSBnZXRTdGF0ZSgpO1xuICBjb25zdCBpbmRleCA9IGNvbm5lY3RlZEFjY291bnRzLmZpbmRJbmRleCgoYSkgPT4gYS5hZGRyZXNzLmVxdWFscyhhZGRyZXNzKSk7XG4gIGlmIChpbmRleCA+PSAwKSB7XG4gICAgY29ubmVjdGVkQWNjb3VudHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgfVxuICBzZXRTdGF0ZSh7IC4uLnN0YXRlLCBjb25uZWN0ZWRBY2NvdW50cyB9KTtcbn1cblxuLy8gc3JjL3RlbGVncmFtL29wZW5UZWxlZ3JhbVByb21wdC50c1xuaW1wb3J0IHtcbiAgZW5jb2RlUG9wdXBXYWxsZXRSZXF1ZXN0LFxuICBtYWtlUG9wdXBXYWxsZXRSZXF1ZXN0Q2hhbGxlbmdlXG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5pbXBvcnQgeyBwb3N0RXZlbnQgYXMgcG9zdFRlbGVncmFtRXZlbnQgfSBmcm9tIFwiQHRlbGVncmFtLWFwcHMvYnJpZGdlXCI7XG5pbXBvcnQgeyB2NCBhcyByYW5kb21VVUlEIH0gZnJvbSBcInV1aWRcIjtcblxuLy8gc3JjL3RlbGVncmFtL2NyZWF0ZVdhbGxldFJlcXVlc3QudHNcbmltcG9ydCB7XG4gIGJ5dGVzVG9CYXNlNjQgYXMgYnl0ZXNUb0Jhc2U2NDIsXG4gIGJ5dGVzVG9CYXNlNjR1cmwsXG4gIGVuY29kZVdhbGxldFJlcXVlc3RCb2R5XG59IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5hc3luYyBmdW5jdGlvbiBjcmVhdGVXYWxsZXRSZXF1ZXN0KGJhc2VVcmwsIHJlcXVlc3QpIHtcbiAgY29uc3QgZW5jb2RlZENsaWVudElkZW50aXR5S2V5ID0gYnl0ZXNUb0Jhc2U2NHVybChyZXF1ZXN0LmNsaWVudElkZW50aXR5S2V5LnRvVWludDhBcnJheSgpKTtcbiAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHtiYXNlVXJsfS92MS9kYXBwL2NsaWVudHMvJHtlbmNvZGVkQ2xpZW50SWRlbnRpdHlLZXl9L3JlcXVlc3RzL2AsIHtcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBib2R5OiBlbmNvZGVXYWxsZXRSZXF1ZXN0Qm9keShyZXF1ZXN0LmJvZHkpLFxuICAgICAgaWQ6IHJlcXVlc3QuaWQsXG4gICAgICBzaWduYXR1cmU6IGJ5dGVzVG9CYXNlNjQyKHJlcXVlc3Quc2lnbmF0dXJlLnRvVWludDhBcnJheSgpKSxcbiAgICAgIHRpbWVzdGFtcDogcmVxdWVzdC50aW1lc3RhbXBcbiAgICB9KSxcbiAgICBoZWFkZXJzOiB7IEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgbWV0aG9kOiBcInBvc3RcIlxuICB9KTtcbiAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCBjcmVhdGluZyB0aGUgd2FsbGV0IHJlcXVlc3RcIik7XG4gIH1cbn1cblxuLy8gc3JjL3RlbGVncmFtL2dldENsaWVudElkZW50aXR5S2V5LnRzXG5pbXBvcnQgeyBFZDI1NTE5UHJpdmF0ZUtleSB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbnZhciBpZGVudGl0eUtleVN0b3JhZ2VLZXkgPSBcIkBhcHRvcy1jb25uZWN0L2NsaWVudC1pZGVudGl0eS1rZXlcIjtcbmZ1bmN0aW9uIGdldENsaWVudElkZW50aXR5S2V5KCkge1xuICBjb25zdCBzZXJpYWxpemVkID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKGlkZW50aXR5S2V5U3RvcmFnZUtleSk7XG4gIGlmIChzZXJpYWxpemVkKSB7XG4gICAgcmV0dXJuIG5ldyBFZDI1NTE5UHJpdmF0ZUtleShzZXJpYWxpemVkKTtcbiAgfVxuICBjb25zdCBpZGVudGl0eUtleSA9IEVkMjU1MTlQcml2YXRlS2V5LmdlbmVyYXRlKCk7XG4gIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShpZGVudGl0eUtleVN0b3JhZ2VLZXksIGlkZW50aXR5S2V5LnRvU3RyaW5nKCkpO1xuICByZXR1cm4gaWRlbnRpdHlLZXk7XG59XG5cbi8vIHNyYy90ZWxlZ3JhbS9nZXRXYWxsZXRSZXNwb25zZS50c1xuaW1wb3J0IHsgYmFzZTY0VG9CeXRlcyBhcyBiYXNlNjRUb0J5dGVzMiwgYnl0ZXNUb0Jhc2U2NHVybCBhcyBieXRlc1RvQmFzZTY0dXJsMiB9IGZyb20gXCJAYXB0b3MtY29ubmVjdC93YWxsZXQtYXBpXCI7XG5cbi8vIHNyYy90ZWxlZ3JhbS9zbWFydFBvbGxpbmcudHNcbnZhciBPTl9SRVNVTUVfREVMQVkgPSAzMDA7XG52YXIgRkdfUkVTUE9OU0VfUE9MTElOR19JTlRFUlZBTCA9IDJlMztcbnZhciBCR19SRVNQT05TRV9QT0xMSU5HX0lOVEVSVkFMID0gM2UzO1xudmFyIFBPTExJTkdfVElNRU9VVCA9IDUgKiA2ZTQ7XG5mdW5jdGlvbiB3YWl0Rm9yKG1pbGxpc2Vjb25kcykge1xuICBsZXQgdGltZW91dElkO1xuICBsZXQgY2FuY2VsID0gKCkgPT4ge1xuICB9O1xuICBjb25zdCB0aW1lciA9IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7XG4gICAgdGltZW91dElkID0gc2V0VGltZW91dChyZXNvbHZlLCBtaWxsaXNlY29uZHMpO1xuICAgIGNhbmNlbCA9ICgpID0+IHtcbiAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgcmVzb2x2ZSgpO1xuICAgIH07XG4gIH0pO1xuICB0aW1lci5jYW5jZWwgPSBjYW5jZWw7XG4gIHJldHVybiB0aW1lcjtcbn1cbmFzeW5jIGZ1bmN0aW9uIHNtYXJ0UG9sbGluZyhjYWxsYmFjaykge1xuICBsZXQgdGltZXI7XG4gIGxldCBqdXN0UmVzdW1lZCA9IGZhbHNlO1xuICBsZXQgcG9sbGluZ0ludGVydmFsID0gQkdfUkVTUE9OU0VfUE9MTElOR19JTlRFUlZBTDtcbiAgY29uc3Qgb25XaW5kb3dGb2N1cyA9ICgpID0+IHtcbiAgICBqdXN0UmVzdW1lZCA9IHRydWU7XG4gICAgcG9sbGluZ0ludGVydmFsID0gRkdfUkVTUE9OU0VfUE9MTElOR19JTlRFUlZBTDtcbiAgICB0aW1lcj8uY2FuY2VsKCk7XG4gIH07XG4gIGNvbnN0IG9uV2luZG93Qmx1ciA9ICgpID0+IHtcbiAgICBwb2xsaW5nSW50ZXJ2YWwgPSBCR19SRVNQT05TRV9QT0xMSU5HX0lOVEVSVkFMO1xuICB9O1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImZvY3VzXCIsIG9uV2luZG93Rm9jdXMpO1xuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImJsdXJcIiwgb25XaW5kb3dCbHVyKTtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xuICAgIHdoaWxlIChEYXRlLm5vdygpIC0gc3RhcnRUaW1lIDwgUE9MTElOR19USU1FT1VUKSB7XG4gICAgICB0aW1lciA9IHdhaXRGb3IocG9sbGluZ0ludGVydmFsKTtcbiAgICAgIGF3YWl0IHRpbWVyO1xuICAgICAgaWYgKGp1c3RSZXN1bWVkKSB7XG4gICAgICAgIHRpbWVyID0gd2FpdEZvcihPTl9SRVNVTUVfREVMQVkpO1xuICAgICAgICBhd2FpdCB0aW1lcjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgY2FsbGJhY2soKTtcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkge1xuICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgICB9XG4gICAgICBqdXN0UmVzdW1lZCA9IGZhbHNlO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJUaW1lb3V0XCIpO1xuICB9IGZpbmFsbHkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgb25XaW5kb3dGb2N1cyk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIG9uV2luZG93Rm9jdXMpO1xuICB9XG59XG5cbi8vIHNyYy90ZWxlZ3JhbS9nZXRXYWxsZXRSZXNwb25zZS50c1xuYXN5bmMgZnVuY3Rpb24gZ2V0V2FsbGV0UmVzcG9uc2UoYmFzZVVybCwgY2xpZW50SWRlbnRpdHlLZXksIHJlcXVlc3RJZCkge1xuICBjb25zdCBlbmNvZGVkQ2xpZW50SWRlbnRpdHlLZXkgPSBieXRlc1RvQmFzZTY0dXJsMihjbGllbnRJZGVudGl0eUtleS50b1VpbnQ4QXJyYXkoKSk7XG4gIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7YmFzZVVybH0vdjEvZGFwcC9jbGllbnRzLyR7ZW5jb2RlZENsaWVudElkZW50aXR5S2V5fS9yZXF1ZXN0cy8ke3JlcXVlc3RJZH0vcmVzcG9uc2UvYCk7XG4gIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgc21hcnRQb2xsaW5nKFxuICAgICgpID0+IGZldGNoKHVybCwge1xuICAgICAgaGVhZGVyczogeyBBY2NlcHQ6IFwiYXBwbGljYXRpb24vanNvblwiIH0sXG4gICAgICBtZXRob2Q6IFwiZ2V0XCJcbiAgICB9KVxuICApO1xuICBjb25zdCByZXNwb25zZUJvZHkgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gIGNvbnN0IGRhdGEgPSBiYXNlNjRUb0J5dGVzMihyZXNwb25zZUJvZHkuZGF0YS5ib2R5KTtcbiAgcmV0dXJuIHsgZGF0YSB9O1xufVxuXG4vLyBzcmMvdGVsZWdyYW0vb3BlblRlbGVncmFtUHJvbXB0LnRzXG5hc3luYyBmdW5jdGlvbiBvcGVuVGVsZWdyYW1Qcm9tcHQoYmFzZVVybCwgcmVxdWVzdCkge1xuICBjb25zdCBpZGVudGl0eUtleSA9IGdldENsaWVudElkZW50aXR5S2V5KCk7XG4gIGNvbnN0IGNsaWVudElkZW50aXR5S2V5ID0gaWRlbnRpdHlLZXkucHVibGljS2V5KCk7XG4gIGNvbnN0IHJlcXVlc3RJZCA9IHJhbmRvbVVVSUQoKTtcbiAgY29uc3QgdGltZXN0YW1wID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgY2hhbGxlbmdlID0gbWFrZVBvcHVwV2FsbGV0UmVxdWVzdENoYWxsZW5nZSh7IGJvZHk6IHJlcXVlc3QsIGlkOiByZXF1ZXN0SWQsIHRpbWVzdGFtcCB9KTtcbiAgY29uc3Qgc2lnbmF0dXJlID0gaWRlbnRpdHlLZXkuc2lnbihjaGFsbGVuZ2UpO1xuICBjb25zdCBzaWduZWRXYWxsZXRSZXF1ZXN0ID0ge1xuICAgIGJvZHk6IHJlcXVlc3QsXG4gICAgY2xpZW50SWRlbnRpdHlLZXksXG4gICAgaWQ6IHJlcXVlc3RJZCxcbiAgICBzaWduYXR1cmUsXG4gICAgdGltZXN0YW1wXG4gIH07XG4gIGxldCBlbmNvZGVkUmVxdWVzdCA9IGVuY29kZVBvcHVwV2FsbGV0UmVxdWVzdChzaWduZWRXYWxsZXRSZXF1ZXN0KTtcbiAgaWYgKGVuY29kZWRSZXF1ZXN0Lmxlbmd0aCA+IDEwMjQpIHtcbiAgICB2b2lkIGNyZWF0ZVdhbGxldFJlcXVlc3QoYmFzZVVybCwgc2lnbmVkV2FsbGV0UmVxdWVzdCk7XG4gICAgZW5jb2RlZFJlcXVlc3QgPSBlbmNvZGVQb3B1cFdhbGxldFJlcXVlc3Qoe1xuICAgICAgY2xpZW50SWRlbnRpdHlLZXksXG4gICAgICBpZDogcmVxdWVzdElkLFxuICAgICAgc2lnbmF0dXJlLFxuICAgICAgdGltZXN0YW1wXG4gICAgfSk7XG4gIH1cbiAgcG9zdFRlbGVncmFtRXZlbnQoXCJ3ZWJfYXBwX29wZW5fdGdfbGlua1wiLCB7XG4gICAgcGF0aF9mdWxsOiBgL0FwdG9zQ29ubmVjdEJvdC9BcHRvc0Nvbm5lY3Q/c3RhcnRhcHA9JHtlbmNvZGVkUmVxdWVzdH1gXG4gIH0pO1xuICByZXR1cm4gZ2V0V2FsbGV0UmVzcG9uc2UoYmFzZVVybCwgY2xpZW50SWRlbnRpdHlLZXksIHJlcXVlc3RJZCk7XG59XG5cbi8vIHNyYy90ZWxlZ3JhbS9pbmRleC50c1xuZnVuY3Rpb24gaXNUZWxlZ3JhbU1pbmlBcHAoKSB7XG4gIHJldHVybiB3aW5kb3cuVGVsZWdyYW1XZWJ2aWV3UHJveHkgIT09IHZvaWQgMDtcbn1cblxuLy8gc3JjL2luZGV4LnRzXG52YXIgV2ViV2FsbGV0VHJhbnNwb3J0ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3RvcihiYXNlVXJsKSB7XG4gICAgdGhpcy5iYXNlVXJsID0gYmFzZVVybDtcbiAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xuICB9XG4gIGFzeW5jIHNlbmRQcm9tcHRSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgICBpZiAoaXNUZWxlZ3JhbU1pbmlBcHAoKSkge1xuICAgICAgcmV0dXJuIG9wZW5UZWxlZ3JhbVByb21wdCh0aGlzLmJhc2VVcmwsIHJlcXVlc3QpO1xuICAgIH1cbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGAke3RoaXMuYmFzZVVybH0vcHJvbXB0L2ApO1xuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwicmVxdWVzdFwiLCB1cmxFbmNvZGVXYWxsZXRSZXF1ZXN0KHJlcXVlc3QpKTtcbiAgICBjb25zdCBwcm9tcHQgPSBvcGVuUHJvbXB0KHVybCk7XG4gICAgcmV0dXJuIHdhaXRGb3JQcm9tcHRSZXNwb25zZSh0aGlzLmJhc2VVcmwsIHByb21wdCk7XG4gIH1cbiAgYXN5bmMgc2VuZFJlcXVlc3QocmVxdWVzdCkge1xuICAgIHN3aXRjaCAocmVxdWVzdC5uYW1lKSB7XG4gICAgICBjYXNlIElzQ29ubmVjdGVkUmVxdWVzdC5uYW1lOiB7XG4gICAgICAgIGNvbnN0IGNvbm5lY3RlZEFjY291bnRzID0gZ2V0Q29ubmVjdGVkQWNjb3VudHMoKTtcbiAgICAgICAgcmV0dXJuIElzQ29ubmVjdGVkUmVzcG9uc2Uuc2VyaWFsaXplKGNvbm5lY3RlZEFjY291bnRzLmxlbmd0aCA+IDApO1xuICAgICAgfVxuICAgICAgY2FzZSBHZXRDb25uZWN0ZWRBY2NvdW50c1JlcXVlc3QubmFtZToge1xuICAgICAgICBjb25zdCBjb25uZWN0ZWRBY2NvdW50cyA9IGdldENvbm5lY3RlZEFjY291bnRzKCk7XG4gICAgICAgIHJldHVybiBHZXRDb25uZWN0ZWRBY2NvdW50c1Jlc3BvbnNlLnNlcmlhbGl6ZShjb25uZWN0ZWRBY2NvdW50cyk7XG4gICAgICB9XG4gICAgICBjYXNlIENvbm5lY3RSZXF1ZXN0Lm5hbWU6IHtcbiAgICAgICAgY29uc3Qgc2VyaWFsaXplZFJlc3BvbnNlID0gYXdhaXQgdGhpcy5zZW5kUHJvbXB0UmVxdWVzdChyZXF1ZXN0KTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBDb25uZWN0UmVzcG9uc2UyLmRlc2VyaWFsaXplKHNlcmlhbGl6ZWRSZXNwb25zZSk7XG4gICAgICAgIGlmIChyZXNwb25zZS5hcmdzLnN0YXR1cyA9PT0gXCJhcHByb3ZlZFwiKSB7XG4gICAgICAgICAgY29uc3QgeyBhY2NvdW50LCBwYWlyaW5nIH0gPSByZXNwb25zZS5hcmdzLmFyZ3M7XG4gICAgICAgICAgaWYgKHBhaXJpbmcgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgYWRkQ29ubmVjdGVkQWNjb3VudChhY2NvdW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlcmlhbGl6ZWRSZXNwb25zZTtcbiAgICAgIH1cbiAgICAgIGNhc2UgRGlzY29ubmVjdFJlcXVlc3QubmFtZToge1xuICAgICAgICBjb25zdCBbYWN0aXZlQWNjb3VudF0gPSBnZXRDb25uZWN0ZWRBY2NvdW50cygpO1xuICAgICAgICBpZiAoYWN0aXZlQWNjb3VudCkge1xuICAgICAgICAgIHJlbW92ZUNvbm5lY3RlZEFjY291bnQoYWN0aXZlQWNjb3VudC5hZGRyZXNzKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRGlzY29ubmVjdFJlc3BvbnNlLnNlcmlhbGl6ZSh7fSk7XG4gICAgICB9XG4gICAgICBjYXNlIFNpZ25NZXNzYWdlUmVxdWVzdC5uYW1lOlxuICAgICAgY2FzZSBTaWduVHJhbnNhY3Rpb25SZXF1ZXN0Lm5hbWU6XG4gICAgICBjYXNlIFNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3QubmFtZToge1xuICAgICAgICByZXR1cm4gdGhpcy5zZW5kUHJvbXB0UmVxdWVzdChyZXF1ZXN0KTtcbiAgICAgIH1cbiAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVW5leHBlY3RlZCByZXF1ZXN0XCIpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufTtcbmV4cG9ydCB7XG4gIFdlYldhbGxldFRyYW5zcG9ydFxufTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/node_modules/@aptos-connect/web-transport/dist/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/node_modules/@identity-connect/wallet-api/dist/index.mjs":
/*!************************************************************************************************************************************************************!*\
  !*** ./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/node_modules/@identity-connect/wallet-api/dist/index.mjs ***!
  \************************************************************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   bcsDeserialize: () => (/* binding */ bcsDeserialize),\n/* harmony export */   bcsSerialize: () => (/* binding */ bcsSerialize),\n/* harmony export */   deserializeJsonTransactionPayload: () => (/* binding */ deserializeJsonTransactionPayload),\n/* harmony export */   deserializeRawTransaction: () => (/* binding */ deserializeRawTransaction),\n/* harmony export */   deserializeSignAndSubmitTransactionRequestArgs: () => (/* binding */ deserializeSignAndSubmitTransactionRequestArgs),\n/* harmony export */   deserializeSignTransactionRequestArgs: () => (/* binding */ deserializeSignTransactionRequestArgs),\n/* harmony export */   deserializeSignTransactionResponseArgs: () => (/* binding */ deserializeSignTransactionResponseArgs),\n/* harmony export */   isBcsSerializable: () => (/* binding */ isBcsSerializable),\n/* harmony export */   makeFullMessage: () => (/* binding */ makeFullMessage),\n/* harmony export */   serializeJsonTransactionPayload: () => (/* binding */ serializeJsonTransactionPayload),\n/* harmony export */   serializeRawTransaction: () => (/* binding */ serializeRawTransaction),\n/* harmony export */   serializeSignAndSubmitTransactionRequestArgs: () => (/* binding */ serializeSignAndSubmitTransactionRequestArgs),\n/* harmony export */   serializeSignTransactionRequestArgs: () => (/* binding */ serializeSignTransactionRequestArgs),\n/* harmony export */   serializeSignTransactionResponseArgs: () => (/* binding */ serializeSignTransactionResponseArgs)\n/* harmony export */ });\n/* harmony import */ var _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @aptos-labs/ts-sdk */ \"(ssr)/./node_modules/@aptos-labs/ts-sdk/dist/esm/index.mjs\");\n/* harmony import */ var aptos__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! aptos */ \"(ssr)/./node_modules/aptos/dist/index.mjs\");\n// src/serialization/bcsSerialization.ts\n\n\nfunction isBcsSerializableV1(value) {\n  return value?.serialize !== void 0;\n}\nfunction isBcsSerializableV2(value) {\n  return value?.serialize !== void 0 && value?.bcsToBytes !== void 0 && value?.bcsToHex !== void 0;\n}\nfunction isBcsSerializable(value) {\n  return isBcsSerializableV1(value) || isBcsSerializableV2(value);\n}\nfunction bcsSerialize(serializable) {\n  if (isBcsSerializableV2(serializable)) {\n    return serializable.bcsToHex().toString();\n  }\n  const serializedValueBytes = aptos__WEBPACK_IMPORTED_MODULE_1__.BCS.bcsToBytes(serializable);\n  return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(serializedValueBytes).toString();\n}\nfunction bcsDeserialize(deserializableClass, serializedValue) {\n  const serializedValueBytes = _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexString(serializedValue).toUint8Array();\n  const deserializer = new _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Deserializer(serializedValueBytes);\n  return deserializableClass.deserialize(deserializer);\n}\n\n// src/serialization/jsonPayload.ts\n\n\n// src/serialization/error.ts\nvar UnexpectedValueError = class _UnexpectedValueError extends Error {\n  constructor(message) {\n    super(message);\n    this.name = \"UnexpectedValueError\";\n    Object.setPrototypeOf(this, _UnexpectedValueError.prototype);\n  }\n};\n\n// src/serialization/jsonPayload.ts\nfunction isSerializedUint8Array(arg) {\n  return arg?.type === \"Uint8Array\" && typeof arg?.value === \"string\";\n}\nfunction serializeEntryFunctionArg(arg) {\n  if (arg instanceof Uint8Array) {\n    return {\n      type: \"Uint8Array\",\n      value: _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(arg).toString()\n    };\n  }\n  if (Array.isArray(arg)) {\n    return arg.map(serializeEntryFunctionArg);\n  }\n  return arg;\n}\nfunction deserializeEntryFunctionArg(arg) {\n  if (isSerializedUint8Array(arg)) {\n    return _aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.Hex.fromHexInput(arg.value).toUint8Array();\n  }\n  if (Array.isArray(arg)) {\n    return arg.map(deserializeEntryFunctionArg);\n  }\n  return arg;\n}\nfunction serializeEntryFunctionPayload(payload) {\n  const normalizedArgs = payload.arguments.map(serializeEntryFunctionArg);\n  return {\n    ...payload,\n    arguments: normalizedArgs,\n    type: \"entry_function_payload\"\n  };\n}\nfunction deserializeEntryFunctionPayload(payload) {\n  const deserializedArgs = payload.arguments.map(deserializeEntryFunctionArg);\n  return {\n    ...payload,\n    arguments: deserializedArgs,\n    type: \"entry_function_payload\"\n  };\n}\nfunction serializeJsonTransactionPayload(payload) {\n  if (payload.type === \"entry_function_payload\" || payload.type === void 0) {\n    return serializeEntryFunctionPayload(payload);\n  }\n  if (payload.type === \"multisig_payload\") {\n    const innerPayload = payload.transaction_payload !== void 0 ? serializeEntryFunctionPayload(payload.transaction_payload) : void 0;\n    return { ...payload, transaction_payload: innerPayload };\n  }\n  throw new UnexpectedValueError();\n}\nfunction deserializeJsonTransactionPayload(payload) {\n  if (payload.type === \"entry_function_payload\" || payload.type === void 0) {\n    return deserializeEntryFunctionPayload(payload);\n  }\n  if (payload.type === \"multisig_payload\") {\n    const innerPayload = payload.transaction_payload !== void 0 ? deserializeEntryFunctionPayload(payload.transaction_payload) : void 0;\n    return { ...payload, transaction_payload: innerPayload };\n  }\n  throw new UnexpectedValueError();\n}\n\n// src/serialization/rawTxn.ts\n\nfunction serializeRawTransaction(rawTxn) {\n  const value = bcsSerialize(rawTxn);\n  if (\"fee_payer_address\" in rawTxn) {\n    return { type: \"fee_payer_raw_txn\", value };\n  }\n  if (\"secondary_signer_addresses\" in rawTxn) {\n    return { type: \"multi_agent_raw_txn\", value };\n  }\n  if (\"chain_id\" in rawTxn) {\n    return { type: \"raw_txn\", value };\n  }\n  throw new UnexpectedValueError(\"Invalid raw transaction type\");\n}\nfunction deserializeRawTransaction(serialized) {\n  switch (serialized.type) {\n    case \"raw_txn\":\n      return bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransaction, serialized.value);\n    case \"fee_payer_raw_txn\":\n      return bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransactionWithData, serialized.value);\n    case \"multi_agent_raw_txn\":\n      return bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransactionWithData, serialized.value);\n    default:\n      throw new UnexpectedValueError(\"Invalid raw transaction type\");\n  }\n}\n\n// src/serialization/signAndSubmitTransactionRequestArgs.ts\n\nfunction serializeSignAndSubmitTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const serializedPayload = isBcsSerializable(args.payload) ? bcsSerialize(args.payload) : serializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload: serializedPayload };\n  }\n  if (\"feePayerAuthenticator\" in args) {\n    return {\n      feePayerAuthenticator: bcsSerialize(args.feePayerAuthenticator),\n      rawTxn: serializeRawTransaction(args.rawTxn)\n    };\n  }\n  if (\"rawTxn\" in args) {\n    return { rawTxn: serializeRawTransaction(args.rawTxn) };\n  }\n  throw new UnexpectedValueError();\n}\nfunction deserializeSignAndSubmitTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const payload = typeof args.payload === \"string\" ? bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload, args.payload) : deserializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload };\n  }\n  if (\"feePayerAuthenticator\" in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    const feePayerAuthenticator = bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator, args.feePayerAuthenticator);\n    return { feePayerAuthenticator, rawTxn: deserializedRawTxn };\n  }\n  if (\"rawTxn\" in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    return { rawTxn: deserializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\n\n// src/serialization/signTransactionRequestArgs.ts\n\nfunction serializeSignTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const serializedPayload = isBcsSerializable(args.payload) ? bcsSerialize(args.payload) : serializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload: serializedPayload };\n  }\n  if (\"rawTxn\" in args) {\n    const serializedRawTxn = serializeRawTransaction(args.rawTxn);\n    return { rawTxn: serializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\nfunction deserializeSignTransactionRequestArgs(args) {\n  if (\"payload\" in args) {\n    const payload = typeof args.payload === \"string\" ? bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.TransactionPayload, args.payload) : deserializeJsonTransactionPayload(args.payload);\n    return { options: args.options, payload };\n  }\n  if (\"rawTxn\" in args) {\n    const deserializedRawTxn = deserializeRawTransaction(args.rawTxn);\n    return { rawTxn: deserializedRawTxn };\n  }\n  throw new UnexpectedValueError();\n}\n\n// src/serialization/signTransactionResponseArgs.ts\n\nfunction serializeSignTransactionResponseArgs(args) {\n  const accountAuthenticator = bcsSerialize(args.accountAuthenticator);\n  if (\"rawTxn\" in args) {\n    const rawTxn = bcsSerialize(args.rawTxn);\n    return { accountAuthenticator, rawTxn };\n  }\n  return { accountAuthenticator };\n}\nfunction deserializeSignTransactionResponseArgs(args) {\n  const accountAuthenticator = bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.AccountAuthenticator, args.accountAuthenticator);\n  if (\"rawTxn\" in args) {\n    const rawTxn = bcsDeserialize(_aptos_labs_ts_sdk__WEBPACK_IMPORTED_MODULE_0__.RawTransaction, args.rawTxn);\n    return { accountAuthenticator, rawTxn };\n  }\n  return { accountAuthenticator };\n}\n\n// src/utils/makeFullMessage.ts\nvar prefix = \"APTOS\";\nfunction makeFullMessage(params, flags) {\n  let fullMessage = prefix;\n  if (flags.address) {\n    fullMessage += `\naddress: ${params.address}`;\n  }\n  if (flags.application) {\n    fullMessage += `\napplication: ${params.application}`;\n  }\n  if (flags.chainId) {\n    fullMessage += `\nchainId: ${params.chainId}`;\n  }\n  fullMessage += `\nmessage: ${params.message}`;\n  fullMessage += `\nnonce: ${params.nonce}`;\n  return {\n    fullMessage,\n    prefix\n  };\n}\n\n//# sourceMappingURL=index.mjs.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvQGFwdG9zLWNvbm5lY3Qvd2FsbGV0LWFkYXB0ZXItcGx1Z2luL25vZGVfbW9kdWxlcy9AaWRlbnRpdHktY29ubmVjdC9kYXBwLXNkay9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3Qvd2FsbGV0LWFwaS9kaXN0L2luZGV4Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDdUQ7QUFDM0I7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0Isc0NBQUc7QUFDbEMsU0FBUyxtREFBRztBQUNaO0FBQ0E7QUFDQSwrQkFBK0IsbURBQUc7QUFDbEMsMkJBQTJCLDREQUFZO0FBQ3ZDO0FBQ0E7O0FBRUE7QUFDaUQ7O0FBRWpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsbURBQUk7QUFDakI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyxtREFBSTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7O0FBRUE7QUFJNEI7QUFDNUI7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsOERBQWM7QUFDMUM7QUFDQSw0QkFBNEIsc0VBQXNCO0FBQ2xEO0FBQ0EsNEJBQTRCLHNFQUFzQjtBQUNsRDtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUM4RTtBQUM5RTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLGtFQUFrQjtBQUN4RixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsaURBQWlELG9FQUFvQjtBQUNyRSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTs7QUFFQTtBQUMrRTtBQUMvRTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRUFBc0Usa0VBQW1CO0FBQ3pGLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBOztBQUVBO0FBQ3NIO0FBQ3RIO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQSw4Q0FBOEMsb0VBQXFCO0FBQ25FO0FBQ0Esa0NBQWtDLDhEQUFlO0FBQ2pELGFBQWE7QUFDYjtBQUNBLFdBQVc7QUFDWDs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLGVBQWU7QUFDMUI7QUFDQTtBQUNBO0FBQ0EsZUFBZSxtQkFBbUI7QUFDbEM7QUFDQTtBQUNBO0FBQ0EsV0FBVyxlQUFlO0FBQzFCO0FBQ0E7QUFDQSxXQUFXLGVBQWU7QUFDMUI7QUFDQSxTQUFTLGFBQWE7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWdCRTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbmV4dGpzLWJvaWxlcnBsYXRlLXRlbXBsYXRlLy4vbm9kZV9tb2R1bGVzL0BhcHRvcy1jb25uZWN0L3dhbGxldC1hZGFwdGVyLXBsdWdpbi9ub2RlX21vZHVsZXMvQGlkZW50aXR5LWNvbm5lY3QvZGFwcC1zZGsvbm9kZV9tb2R1bGVzL0BpZGVudGl0eS1jb25uZWN0L3dhbGxldC1hcGkvZGlzdC9pbmRleC5tanM/OTVlNSJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBzcmMvc2VyaWFsaXphdGlvbi9iY3NTZXJpYWxpemF0aW9uLnRzXG5pbXBvcnQgeyBEZXNlcmlhbGl6ZXIsIEhleCB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcbmltcG9ydCB7IEJDUyB9IGZyb20gXCJhcHRvc1wiO1xuZnVuY3Rpb24gaXNCY3NTZXJpYWxpemFibGVWMSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWU/LnNlcmlhbGl6ZSAhPT0gdm9pZCAwO1xufVxuZnVuY3Rpb24gaXNCY3NTZXJpYWxpemFibGVWMih2YWx1ZSkge1xuICByZXR1cm4gdmFsdWU/LnNlcmlhbGl6ZSAhPT0gdm9pZCAwICYmIHZhbHVlPy5iY3NUb0J5dGVzICE9PSB2b2lkIDAgJiYgdmFsdWU/LmJjc1RvSGV4ICE9PSB2b2lkIDA7XG59XG5mdW5jdGlvbiBpc0Jjc1NlcmlhbGl6YWJsZSh2YWx1ZSkge1xuICByZXR1cm4gaXNCY3NTZXJpYWxpemFibGVWMSh2YWx1ZSkgfHwgaXNCY3NTZXJpYWxpemFibGVWMih2YWx1ZSk7XG59XG5mdW5jdGlvbiBiY3NTZXJpYWxpemUoc2VyaWFsaXphYmxlKSB7XG4gIGlmIChpc0Jjc1NlcmlhbGl6YWJsZVYyKHNlcmlhbGl6YWJsZSkpIHtcbiAgICByZXR1cm4gc2VyaWFsaXphYmxlLmJjc1RvSGV4KCkudG9TdHJpbmcoKTtcbiAgfVxuICBjb25zdCBzZXJpYWxpemVkVmFsdWVCeXRlcyA9IEJDUy5iY3NUb0J5dGVzKHNlcmlhbGl6YWJsZSk7XG4gIHJldHVybiBIZXguZnJvbUhleElucHV0KHNlcmlhbGl6ZWRWYWx1ZUJ5dGVzKS50b1N0cmluZygpO1xufVxuZnVuY3Rpb24gYmNzRGVzZXJpYWxpemUoZGVzZXJpYWxpemFibGVDbGFzcywgc2VyaWFsaXplZFZhbHVlKSB7XG4gIGNvbnN0IHNlcmlhbGl6ZWRWYWx1ZUJ5dGVzID0gSGV4LmZyb21IZXhTdHJpbmcoc2VyaWFsaXplZFZhbHVlKS50b1VpbnQ4QXJyYXkoKTtcbiAgY29uc3QgZGVzZXJpYWxpemVyID0gbmV3IERlc2VyaWFsaXplcihzZXJpYWxpemVkVmFsdWVCeXRlcyk7XG4gIHJldHVybiBkZXNlcmlhbGl6YWJsZUNsYXNzLmRlc2VyaWFsaXplKGRlc2VyaWFsaXplcik7XG59XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uL2pzb25QYXlsb2FkLnRzXG5pbXBvcnQgeyBIZXggYXMgSGV4MiB9IGZyb20gXCJAYXB0b3MtbGFicy90cy1zZGtcIjtcblxuLy8gc3JjL3NlcmlhbGl6YXRpb24vZXJyb3IudHNcbnZhciBVbmV4cGVjdGVkVmFsdWVFcnJvciA9IGNsYXNzIF9VbmV4cGVjdGVkVmFsdWVFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9IFwiVW5leHBlY3RlZFZhbHVlRXJyb3JcIjtcbiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgX1VuZXhwZWN0ZWRWYWx1ZUVycm9yLnByb3RvdHlwZSk7XG4gIH1cbn07XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uL2pzb25QYXlsb2FkLnRzXG5mdW5jdGlvbiBpc1NlcmlhbGl6ZWRVaW50OEFycmF5KGFyZykge1xuICByZXR1cm4gYXJnPy50eXBlID09PSBcIlVpbnQ4QXJyYXlcIiAmJiB0eXBlb2YgYXJnPy52YWx1ZSA9PT0gXCJzdHJpbmdcIjtcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25BcmcoYXJnKSB7XG4gIGlmIChhcmcgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6IFwiVWludDhBcnJheVwiLFxuICAgICAgdmFsdWU6IEhleDIuZnJvbUhleElucHV0KGFyZykudG9TdHJpbmcoKVxuICAgIH07XG4gIH1cbiAgaWYgKEFycmF5LmlzQXJyYXkoYXJnKSkge1xuICAgIHJldHVybiBhcmcubWFwKHNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25BcmcpO1xuICB9XG4gIHJldHVybiBhcmc7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUVudHJ5RnVuY3Rpb25BcmcoYXJnKSB7XG4gIGlmIChpc1NlcmlhbGl6ZWRVaW50OEFycmF5KGFyZykpIHtcbiAgICByZXR1cm4gSGV4Mi5mcm9tSGV4SW5wdXQoYXJnLnZhbHVlKS50b1VpbnQ4QXJyYXkoKTtcbiAgfVxuICBpZiAoQXJyYXkuaXNBcnJheShhcmcpKSB7XG4gICAgcmV0dXJuIGFyZy5tYXAoZGVzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJnKTtcbiAgfVxuICByZXR1cm4gYXJnO1xufVxuZnVuY3Rpb24gc2VyaWFsaXplRW50cnlGdW5jdGlvblBheWxvYWQocGF5bG9hZCkge1xuICBjb25zdCBub3JtYWxpemVkQXJncyA9IHBheWxvYWQuYXJndW1lbnRzLm1hcChzZXJpYWxpemVFbnRyeUZ1bmN0aW9uQXJnKTtcbiAgcmV0dXJuIHtcbiAgICAuLi5wYXlsb2FkLFxuICAgIGFyZ3VtZW50czogbm9ybWFsaXplZEFyZ3MsXG4gICAgdHlwZTogXCJlbnRyeV9mdW5jdGlvbl9wYXlsb2FkXCJcbiAgfTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplRW50cnlGdW5jdGlvblBheWxvYWQocGF5bG9hZCkge1xuICBjb25zdCBkZXNlcmlhbGl6ZWRBcmdzID0gcGF5bG9hZC5hcmd1bWVudHMubWFwKGRlc2VyaWFsaXplRW50cnlGdW5jdGlvbkFyZyk7XG4gIHJldHVybiB7XG4gICAgLi4ucGF5bG9hZCxcbiAgICBhcmd1bWVudHM6IGRlc2VyaWFsaXplZEFyZ3MsXG4gICAgdHlwZTogXCJlbnRyeV9mdW5jdGlvbl9wYXlsb2FkXCJcbiAgfTtcbn1cbmZ1bmN0aW9uIHNlcmlhbGl6ZUpzb25UcmFuc2FjdGlvblBheWxvYWQocGF5bG9hZCkge1xuICBpZiAocGF5bG9hZC50eXBlID09PSBcImVudHJ5X2Z1bmN0aW9uX3BheWxvYWRcIiB8fCBwYXlsb2FkLnR5cGUgPT09IHZvaWQgMCkge1xuICAgIHJldHVybiBzZXJpYWxpemVFbnRyeUZ1bmN0aW9uUGF5bG9hZChwYXlsb2FkKTtcbiAgfVxuICBpZiAocGF5bG9hZC50eXBlID09PSBcIm11bHRpc2lnX3BheWxvYWRcIikge1xuICAgIGNvbnN0IGlubmVyUGF5bG9hZCA9IHBheWxvYWQudHJhbnNhY3Rpb25fcGF5bG9hZCAhPT0gdm9pZCAwID8gc2VyaWFsaXplRW50cnlGdW5jdGlvblBheWxvYWQocGF5bG9hZC50cmFuc2FjdGlvbl9wYXlsb2FkKSA6IHZvaWQgMDtcbiAgICByZXR1cm4geyAuLi5wYXlsb2FkLCB0cmFuc2FjdGlvbl9wYXlsb2FkOiBpbm5lclBheWxvYWQgfTtcbiAgfVxuICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoKTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZChwYXlsb2FkKSB7XG4gIGlmIChwYXlsb2FkLnR5cGUgPT09IFwiZW50cnlfZnVuY3Rpb25fcGF5bG9hZFwiIHx8IHBheWxvYWQudHlwZSA9PT0gdm9pZCAwKSB7XG4gICAgcmV0dXJuIGRlc2VyaWFsaXplRW50cnlGdW5jdGlvblBheWxvYWQocGF5bG9hZCk7XG4gIH1cbiAgaWYgKHBheWxvYWQudHlwZSA9PT0gXCJtdWx0aXNpZ19wYXlsb2FkXCIpIHtcbiAgICBjb25zdCBpbm5lclBheWxvYWQgPSBwYXlsb2FkLnRyYW5zYWN0aW9uX3BheWxvYWQgIT09IHZvaWQgMCA/IGRlc2VyaWFsaXplRW50cnlGdW5jdGlvblBheWxvYWQocGF5bG9hZC50cmFuc2FjdGlvbl9wYXlsb2FkKSA6IHZvaWQgMDtcbiAgICByZXR1cm4geyAuLi5wYXlsb2FkLCB0cmFuc2FjdGlvbl9wYXlsb2FkOiBpbm5lclBheWxvYWQgfTtcbiAgfVxuICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoKTtcbn1cblxuLy8gc3JjL3NlcmlhbGl6YXRpb24vcmF3VHhuLnRzXG5pbXBvcnQge1xuICBSYXdUcmFuc2FjdGlvbixcbiAgUmF3VHJhbnNhY3Rpb25XaXRoRGF0YVxufSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5mdW5jdGlvbiBzZXJpYWxpemVSYXdUcmFuc2FjdGlvbihyYXdUeG4pIHtcbiAgY29uc3QgdmFsdWUgPSBiY3NTZXJpYWxpemUocmF3VHhuKTtcbiAgaWYgKFwiZmVlX3BheWVyX2FkZHJlc3NcIiBpbiByYXdUeG4pIHtcbiAgICByZXR1cm4geyB0eXBlOiBcImZlZV9wYXllcl9yYXdfdHhuXCIsIHZhbHVlIH07XG4gIH1cbiAgaWYgKFwic2Vjb25kYXJ5X3NpZ25lcl9hZGRyZXNzZXNcIiBpbiByYXdUeG4pIHtcbiAgICByZXR1cm4geyB0eXBlOiBcIm11bHRpX2FnZW50X3Jhd190eG5cIiwgdmFsdWUgfTtcbiAgfVxuICBpZiAoXCJjaGFpbl9pZFwiIGluIHJhd1R4bikge1xuICAgIHJldHVybiB7IHR5cGU6IFwicmF3X3R4blwiLCB2YWx1ZSB9O1xuICB9XG4gIHRocm93IG5ldyBVbmV4cGVjdGVkVmFsdWVFcnJvcihcIkludmFsaWQgcmF3IHRyYW5zYWN0aW9uIHR5cGVcIik7XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKHNlcmlhbGl6ZWQpIHtcbiAgc3dpdGNoIChzZXJpYWxpemVkLnR5cGUpIHtcbiAgICBjYXNlIFwicmF3X3R4blwiOlxuICAgICAgcmV0dXJuIGJjc0Rlc2VyaWFsaXplKFJhd1RyYW5zYWN0aW9uLCBzZXJpYWxpemVkLnZhbHVlKTtcbiAgICBjYXNlIFwiZmVlX3BheWVyX3Jhd190eG5cIjpcbiAgICAgIHJldHVybiBiY3NEZXNlcmlhbGl6ZShSYXdUcmFuc2FjdGlvbldpdGhEYXRhLCBzZXJpYWxpemVkLnZhbHVlKTtcbiAgICBjYXNlIFwibXVsdGlfYWdlbnRfcmF3X3R4blwiOlxuICAgICAgcmV0dXJuIGJjc0Rlc2VyaWFsaXplKFJhd1RyYW5zYWN0aW9uV2l0aERhdGEsIHNlcmlhbGl6ZWQudmFsdWUpO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoXCJJbnZhbGlkIHJhdyB0cmFuc2FjdGlvbiB0eXBlXCIpO1xuICB9XG59XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uL3NpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzLnRzXG5pbXBvcnQgeyBBY2NvdW50QXV0aGVudGljYXRvciwgVHJhbnNhY3Rpb25QYXlsb2FkIH0gZnJvbSBcIkBhcHRvcy1sYWJzL3RzLXNka1wiO1xuZnVuY3Rpb24gc2VyaWFsaXplU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MoYXJncykge1xuICBpZiAoXCJwYXlsb2FkXCIgaW4gYXJncykge1xuICAgIGNvbnN0IHNlcmlhbGl6ZWRQYXlsb2FkID0gaXNCY3NTZXJpYWxpemFibGUoYXJncy5wYXlsb2FkKSA/IGJjc1NlcmlhbGl6ZShhcmdzLnBheWxvYWQpIDogc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZChhcmdzLnBheWxvYWQpO1xuICAgIHJldHVybiB7IG9wdGlvbnM6IGFyZ3Mub3B0aW9ucywgcGF5bG9hZDogc2VyaWFsaXplZFBheWxvYWQgfTtcbiAgfVxuICBpZiAoXCJmZWVQYXllckF1dGhlbnRpY2F0b3JcIiBpbiBhcmdzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGZlZVBheWVyQXV0aGVudGljYXRvcjogYmNzU2VyaWFsaXplKGFyZ3MuZmVlUGF5ZXJBdXRoZW50aWNhdG9yKSxcbiAgICAgIHJhd1R4bjogc2VyaWFsaXplUmF3VHJhbnNhY3Rpb24oYXJncy5yYXdUeG4pXG4gICAgfTtcbiAgfVxuICBpZiAoXCJyYXdUeG5cIiBpbiBhcmdzKSB7XG4gICAgcmV0dXJuIHsgcmF3VHhuOiBzZXJpYWxpemVSYXdUcmFuc2FjdGlvbihhcmdzLnJhd1R4bikgfTtcbiAgfVxuICB0aHJvdyBuZXcgVW5leHBlY3RlZFZhbHVlRXJyb3IoKTtcbn1cbmZ1bmN0aW9uIGRlc2VyaWFsaXplU2lnbkFuZFN1Ym1pdFRyYW5zYWN0aW9uUmVxdWVzdEFyZ3MoYXJncykge1xuICBpZiAoXCJwYXlsb2FkXCIgaW4gYXJncykge1xuICAgIGNvbnN0IHBheWxvYWQgPSB0eXBlb2YgYXJncy5wYXlsb2FkID09PSBcInN0cmluZ1wiID8gYmNzRGVzZXJpYWxpemUoVHJhbnNhY3Rpb25QYXlsb2FkLCBhcmdzLnBheWxvYWQpIDogZGVzZXJpYWxpemVKc29uVHJhbnNhY3Rpb25QYXlsb2FkKGFyZ3MucGF5bG9hZCk7XG4gICAgcmV0dXJuIHsgb3B0aW9uczogYXJncy5vcHRpb25zLCBwYXlsb2FkIH07XG4gIH1cbiAgaWYgKFwiZmVlUGF5ZXJBdXRoZW50aWNhdG9yXCIgaW4gYXJncykge1xuICAgIGNvbnN0IGRlc2VyaWFsaXplZFJhd1R4biA9IGRlc2VyaWFsaXplUmF3VHJhbnNhY3Rpb24oYXJncy5yYXdUeG4pO1xuICAgIGNvbnN0IGZlZVBheWVyQXV0aGVudGljYXRvciA9IGJjc0Rlc2VyaWFsaXplKEFjY291bnRBdXRoZW50aWNhdG9yLCBhcmdzLmZlZVBheWVyQXV0aGVudGljYXRvcik7XG4gICAgcmV0dXJuIHsgZmVlUGF5ZXJBdXRoZW50aWNhdG9yLCByYXdUeG46IGRlc2VyaWFsaXplZFJhd1R4biB9O1xuICB9XG4gIGlmIChcInJhd1R4blwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBkZXNlcmlhbGl6ZWRSYXdUeG4gPSBkZXNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uKGFyZ3MucmF3VHhuKTtcbiAgICByZXR1cm4geyByYXdUeG46IGRlc2VyaWFsaXplZFJhd1R4biB9O1xuICB9XG4gIHRocm93IG5ldyBVbmV4cGVjdGVkVmFsdWVFcnJvcigpO1xufVxuXG4vLyBzcmMvc2VyaWFsaXphdGlvbi9zaWduVHJhbnNhY3Rpb25SZXF1ZXN0QXJncy50c1xuaW1wb3J0IHsgVHJhbnNhY3Rpb25QYXlsb2FkIGFzIFRyYW5zYWN0aW9uUGF5bG9hZDIgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5mdW5jdGlvbiBzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXF1ZXN0QXJncyhhcmdzKSB7XG4gIGlmIChcInBheWxvYWRcIiBpbiBhcmdzKSB7XG4gICAgY29uc3Qgc2VyaWFsaXplZFBheWxvYWQgPSBpc0Jjc1NlcmlhbGl6YWJsZShhcmdzLnBheWxvYWQpID8gYmNzU2VyaWFsaXplKGFyZ3MucGF5bG9hZCkgOiBzZXJpYWxpemVKc29uVHJhbnNhY3Rpb25QYXlsb2FkKGFyZ3MucGF5bG9hZCk7XG4gICAgcmV0dXJuIHsgb3B0aW9uczogYXJncy5vcHRpb25zLCBwYXlsb2FkOiBzZXJpYWxpemVkUGF5bG9hZCB9O1xuICB9XG4gIGlmIChcInJhd1R4blwiIGluIGFyZ3MpIHtcbiAgICBjb25zdCBzZXJpYWxpemVkUmF3VHhuID0gc2VyaWFsaXplUmF3VHJhbnNhY3Rpb24oYXJncy5yYXdUeG4pO1xuICAgIHJldHVybiB7IHJhd1R4bjogc2VyaWFsaXplZFJhd1R4biB9O1xuICB9XG4gIHRocm93IG5ldyBVbmV4cGVjdGVkVmFsdWVFcnJvcigpO1xufVxuZnVuY3Rpb24gZGVzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXF1ZXN0QXJncyhhcmdzKSB7XG4gIGlmIChcInBheWxvYWRcIiBpbiBhcmdzKSB7XG4gICAgY29uc3QgcGF5bG9hZCA9IHR5cGVvZiBhcmdzLnBheWxvYWQgPT09IFwic3RyaW5nXCIgPyBiY3NEZXNlcmlhbGl6ZShUcmFuc2FjdGlvblBheWxvYWQyLCBhcmdzLnBheWxvYWQpIDogZGVzZXJpYWxpemVKc29uVHJhbnNhY3Rpb25QYXlsb2FkKGFyZ3MucGF5bG9hZCk7XG4gICAgcmV0dXJuIHsgb3B0aW9uczogYXJncy5vcHRpb25zLCBwYXlsb2FkIH07XG4gIH1cbiAgaWYgKFwicmF3VHhuXCIgaW4gYXJncykge1xuICAgIGNvbnN0IGRlc2VyaWFsaXplZFJhd1R4biA9IGRlc2VyaWFsaXplUmF3VHJhbnNhY3Rpb24oYXJncy5yYXdUeG4pO1xuICAgIHJldHVybiB7IHJhd1R4bjogZGVzZXJpYWxpemVkUmF3VHhuIH07XG4gIH1cbiAgdGhyb3cgbmV3IFVuZXhwZWN0ZWRWYWx1ZUVycm9yKCk7XG59XG5cbi8vIHNyYy9zZXJpYWxpemF0aW9uL3NpZ25UcmFuc2FjdGlvblJlc3BvbnNlQXJncy50c1xuaW1wb3J0IHsgQWNjb3VudEF1dGhlbnRpY2F0b3IgYXMgQWNjb3VudEF1dGhlbnRpY2F0b3IyLCBSYXdUcmFuc2FjdGlvbiBhcyBSYXdUcmFuc2FjdGlvbjIgfSBmcm9tIFwiQGFwdG9zLWxhYnMvdHMtc2RrXCI7XG5mdW5jdGlvbiBzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXNwb25zZUFyZ3MoYXJncykge1xuICBjb25zdCBhY2NvdW50QXV0aGVudGljYXRvciA9IGJjc1NlcmlhbGl6ZShhcmdzLmFjY291bnRBdXRoZW50aWNhdG9yKTtcbiAgaWYgKFwicmF3VHhuXCIgaW4gYXJncykge1xuICAgIGNvbnN0IHJhd1R4biA9IGJjc1NlcmlhbGl6ZShhcmdzLnJhd1R4bik7XG4gICAgcmV0dXJuIHsgYWNjb3VudEF1dGhlbnRpY2F0b3IsIHJhd1R4biB9O1xuICB9XG4gIHJldHVybiB7IGFjY291bnRBdXRoZW50aWNhdG9yIH07XG59XG5mdW5jdGlvbiBkZXNlcmlhbGl6ZVNpZ25UcmFuc2FjdGlvblJlc3BvbnNlQXJncyhhcmdzKSB7XG4gIGNvbnN0IGFjY291bnRBdXRoZW50aWNhdG9yID0gYmNzRGVzZXJpYWxpemUoQWNjb3VudEF1dGhlbnRpY2F0b3IyLCBhcmdzLmFjY291bnRBdXRoZW50aWNhdG9yKTtcbiAgaWYgKFwicmF3VHhuXCIgaW4gYXJncykge1xuICAgIGNvbnN0IHJhd1R4biA9IGJjc0Rlc2VyaWFsaXplKFJhd1RyYW5zYWN0aW9uMiwgYXJncy5yYXdUeG4pO1xuICAgIHJldHVybiB7IGFjY291bnRBdXRoZW50aWNhdG9yLCByYXdUeG4gfTtcbiAgfVxuICByZXR1cm4geyBhY2NvdW50QXV0aGVudGljYXRvciB9O1xufVxuXG4vLyBzcmMvdXRpbHMvbWFrZUZ1bGxNZXNzYWdlLnRzXG52YXIgcHJlZml4ID0gXCJBUFRPU1wiO1xuZnVuY3Rpb24gbWFrZUZ1bGxNZXNzYWdlKHBhcmFtcywgZmxhZ3MpIHtcbiAgbGV0IGZ1bGxNZXNzYWdlID0gcHJlZml4O1xuICBpZiAoZmxhZ3MuYWRkcmVzcykge1xuICAgIGZ1bGxNZXNzYWdlICs9IGBcbmFkZHJlc3M6ICR7cGFyYW1zLmFkZHJlc3N9YDtcbiAgfVxuICBpZiAoZmxhZ3MuYXBwbGljYXRpb24pIHtcbiAgICBmdWxsTWVzc2FnZSArPSBgXG5hcHBsaWNhdGlvbjogJHtwYXJhbXMuYXBwbGljYXRpb259YDtcbiAgfVxuICBpZiAoZmxhZ3MuY2hhaW5JZCkge1xuICAgIGZ1bGxNZXNzYWdlICs9IGBcbmNoYWluSWQ6ICR7cGFyYW1zLmNoYWluSWR9YDtcbiAgfVxuICBmdWxsTWVzc2FnZSArPSBgXG5tZXNzYWdlOiAke3BhcmFtcy5tZXNzYWdlfWA7XG4gIGZ1bGxNZXNzYWdlICs9IGBcbm5vbmNlOiAke3BhcmFtcy5ub25jZX1gO1xuICByZXR1cm4ge1xuICAgIGZ1bGxNZXNzYWdlLFxuICAgIHByZWZpeFxuICB9O1xufVxuZXhwb3J0IHtcbiAgYmNzRGVzZXJpYWxpemUsXG4gIGJjc1NlcmlhbGl6ZSxcbiAgZGVzZXJpYWxpemVKc29uVHJhbnNhY3Rpb25QYXlsb2FkLFxuICBkZXNlcmlhbGl6ZVJhd1RyYW5zYWN0aW9uLFxuICBkZXNlcmlhbGl6ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzLFxuICBkZXNlcmlhbGl6ZVNpZ25UcmFuc2FjdGlvblJlcXVlc3RBcmdzLFxuICBkZXNlcmlhbGl6ZVNpZ25UcmFuc2FjdGlvblJlc3BvbnNlQXJncyxcbiAgaXNCY3NTZXJpYWxpemFibGUsXG4gIG1ha2VGdWxsTWVzc2FnZSxcbiAgc2VyaWFsaXplSnNvblRyYW5zYWN0aW9uUGF5bG9hZCxcbiAgc2VyaWFsaXplUmF3VHJhbnNhY3Rpb24sXG4gIHNlcmlhbGl6ZVNpZ25BbmRTdWJtaXRUcmFuc2FjdGlvblJlcXVlc3RBcmdzLFxuICBzZXJpYWxpemVTaWduVHJhbnNhY3Rpb25SZXF1ZXN0QXJncyxcbiAgc2VyaWFsaXplU2lnblRyYW5zYWN0aW9uUmVzcG9uc2VBcmdzXG59O1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXgubWpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/@aptos-connect/wallet-adapter-plugin/node_modules/@identity-connect/dapp-sdk/node_modules/@identity-connect/wallet-api/dist/index.mjs\n");

/***/ })

};
;